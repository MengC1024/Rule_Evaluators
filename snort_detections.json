[
    {
        "description": "FILE-IDENTIFY RealNetworks Realplayer .ram playlist file download request",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"FILE-IDENTIFY RealNetworks Realplayer .ram playlist file download request\"; flow:to_server,established; content:\".ra\"; fast_pattern:only; http_uri; pcre:\"/\\x2eram?([\\?\\x5c\\x2f]|$)/smiU\"; flowbits:set,file.realplayer.playlist; flowbits:noalert; metadata:policy max-detect-ips alert, ruleset community, service http; reference:url,en.wikipedia.org/wiki/.ram; classtype:misc-activity; sid:2419; rev:30;)"
    },
    {
        "description": "FILE-IDENTIFY RealNetworks Realplayer .rmp playlist file download request",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"FILE-IDENTIFY RealNetworks Realplayer .rmp playlist file download request\"; flow:to_server,established; content:\".rmp\"; fast_pattern:only; http_uri; pcre:\"/\\x2ermp([\\?\\x5c\\x2f]|$)/smiU\"; flowbits:set,file.rmp; flowbits:set,file.realplayer.playlist; flowbits:noalert; metadata:policy balanced-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service http; reference:url,en.wikipedia.org/wiki/.ram; classtype:misc-activity; sid:2420; rev:33;)"
    },
    {
        "description": "FILE-IDENTIFY RealNetworks Realplayer .rt playlist file download request",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"FILE-IDENTIFY RealNetworks Realplayer .rt playlist file download request\"; flow:to_server,established; content:\".rt\"; fast_pattern:only; http_uri; pcre:\"/\\x2ert([\\?\\x5c\\x2f]|$)/smiU\"; flowbits:set,file.realplayer.playlist; flowbits:noalert; metadata:policy max-detect-ips alert, ruleset community, service http; reference:url,en.wikipedia.org/wiki/.ram; classtype:misc-activity; sid:2422; rev:31;)"
    },
    {
        "description": "FILE-IDENTIFY RealNetworks Realplayer .rp playlist file download request",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"FILE-IDENTIFY RealNetworks Realplayer .rp playlist file download request\"; flow:to_server,established; content:\".rp\"; fast_pattern:only; http_uri; pcre:\"/\\x2erp([\\?\\x5c\\x2f]|$)/smiU\"; flowbits:set,file.realplayer.playlist; flowbits:noalert; metadata:policy max-detect-ips alert, ruleset community, service http; reference:url,en.wikipedia.org/wiki/.ram; classtype:misc-activity; sid:2423; rev:30;)"
    },
    {
        "description": "FILE-IDENTIFY Microsoft Windows Audio wmf file download request",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"FILE-IDENTIFY Microsoft Windows Audio wmf file download request\"; flow:to_server,established; content:\".wmf\"; fast_pattern:only; http_uri; pcre:\"/\\x2ewmf([\\?\\x5c\\x2f]|$)/smiU\"; flowbits:set,file.wmf; flowbits:noalert; metadata:policy max-detect-ips alert, ruleset community, service http; reference:url,en.wikipedia.org/wiki/.wmf; classtype:misc-activity; sid:2436; rev:31;)"
    },
    {
        "description": "MALWARE-BACKDOOR Y3KRAT 1.5 Connect",
        "rule": "alert tcp $HOME_NET 5880 -> $EXTERNAL_NET any (msg:\"MALWARE-BACKDOOR Y3KRAT 1.5 Connect\"; flow:to_client,established; content:\"connected\"; depth:9; flowbits:set,backdoor.y3krat_15.connect; flowbits:noalert; metadata:ruleset community; classtype:misc-activity; sid:3081; rev:13;)"
    },
    {
        "description": "MALWARE-BACKDOOR Y3KRAT 1.5 Connect Client Response",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET 5880 (msg:\"MALWARE-BACKDOOR Y3KRAT 1.5 Connect Client Response\"; flow:to_server,established; flowbits:isset,backdoor.y3krat_15.connect; content:\"getclient\"; depth:9; flowbits:set,backdoor.y3krat_15.client.response; flowbits:noalert; metadata:ruleset community; classtype:misc-activity; sid:3082; rev:13;)"
    },
    {
        "description": "NETBIOS SMB Trans2 QUERY_FILE_INFO attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:\"NETBIOS SMB Trans2 QUERY_FILE_INFO attempt\"; flow:established,to_server; content:\"|00|\"; depth:1; content:\"|FF|SMB2\"; within:5; distance:3; pcre:\"/^.{27}/R\"; content:\"|07 00|\"; within:2; distance:29; flowbits:set,smb.trans2; flowbits:noalert; metadata:policy max-detect-ips alert, ruleset community, service netbios-ssn; classtype:protocol-command-decode; sid:3135; rev:11;)"
    },
    {
        "description": "NETBIOS SMB Trans2 QUERY_FILE_INFO andx attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:\"NETBIOS SMB Trans2 QUERY_FILE_INFO andx attempt\"; flow:established,to_server; content:\"|00|\"; depth:1; content:\"|FF|SMB\"; within:4; distance:3; pcre:\"/^(\\x75|\\x2d|\\x2f|\\x73|\\xa2|\\x2e|\\x24|\\x74)/sR\"; content:\"2\"; depth:1; offset:39; byte_jump:2,0,little,relative; content:\"|07 00|\"; within:2; distance:29; flowbits:set,smb.trans2; flowbits:noalert; metadata:policy max-detect-ips alert, ruleset community, service netbios-ssn; classtype:protocol-command-decode; sid:3136; rev:11;)"
    },
    {
        "description": "NETBIOS SMB-DS Trans2 QUERY_FILE_INFO attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:\"NETBIOS SMB-DS Trans2 QUERY_FILE_INFO attempt\"; flow:established,to_server; content:\"|00|\"; depth:1; content:\"|FF|SMB2\"; within:5; distance:3; pcre:\"/^.{27}/R\"; content:\"|07 00|\"; within:2; distance:29; flowbits:set,smb.trans2; flowbits:noalert; metadata:policy max-detect-ips alert, ruleset community, service netbios-ssn; classtype:protocol-command-decode; sid:3137; rev:11;)"
    },
    {
        "description": "NETBIOS SMB-DS Trans2 QUERY_FILE_INFO andx attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:\"NETBIOS SMB-DS Trans2 QUERY_FILE_INFO andx attempt\"; flow:established,to_server; content:\"|00|\"; depth:1; content:\"|FF|SMB\"; within:4; distance:3; pcre:\"/^(\\x75|\\x2d|\\x2f|\\x73|\\xa2|\\x2e|\\x24|\\x74)/sR\"; content:\"2\"; depth:1; offset:39; byte_jump:2,0,little,relative; content:\"|07 00|\"; within:2; distance:29; flowbits:set,smb.trans2; flowbits:noalert; metadata:policy max-detect-ips alert, ruleset community, service netbios-ssn; classtype:protocol-command-decode; sid:3138; rev:11;)"
    },
    {
        "description": "NETBIOS SMB Trans2 FIND_FIRST2 attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:\"NETBIOS SMB Trans2 FIND_FIRST2 attempt\"; flow:established,to_server; content:\"|00|\"; depth:1; content:\"|FF|SMB2\"; within:5; distance:3; pcre:\"/^.{27}/R\"; content:\"|01 00|\"; within:2; distance:29; flowbits:set,smb.trans2; flowbits:noalert; metadata:policy max-detect-ips alert, ruleset community, service netbios-ssn; classtype:protocol-command-decode; sid:3139; rev:11;)"
    },
    {
        "description": "NETBIOS SMB Trans2 FIND_FIRST2 andx attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:\"NETBIOS SMB Trans2 FIND_FIRST2 andx attempt\"; flow:established,to_server; content:\"|00|\"; depth:1; content:\"|FF|SMB\"; within:4; distance:3; pcre:\"/^(\\x75|\\x2d|\\x2f|\\x73|\\xa2|\\x2e|\\x24|\\x74)/sR\"; content:\"2\"; depth:1; offset:39; byte_jump:2,0,little,relative; content:\"|01 00|\"; within:2; distance:29; flowbits:set,smb.trans2; flowbits:noalert; metadata:policy max-detect-ips alert, ruleset community, service netbios-ssn; classtype:protocol-command-decode; sid:3140; rev:11;)"
    },
    {
        "description": "NETBIOS SMB-DS Trans2 FIND_FIRST2 attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:\"NETBIOS SMB-DS Trans2 FIND_FIRST2 attempt\"; flow:established,to_server; content:\"|00|\"; depth:1; content:\"|FF|SMB2\"; within:5; distance:3; pcre:\"/^.{27}/R\"; content:\"|01 00|\"; within:2; distance:29; flowbits:set,smb.trans2; flowbits:noalert; metadata:policy max-detect-ips alert, ruleset community, service netbios-ssn; classtype:protocol-command-decode; sid:3141; rev:11;)"
    },
    {
        "description": "NETBIOS SMB-DS Trans2 FIND_FIRST2 andx attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:\"NETBIOS SMB-DS Trans2 FIND_FIRST2 andx attempt\"; flow:established,to_server; content:\"|00|\"; depth:1; content:\"|FF|SMB\"; within:4; distance:3; pcre:\"/^(\\x75|\\x2d|\\x2f|\\x73|\\xa2|\\x2e|\\x24|\\x74)/sR\"; content:\"2\"; depth:1; offset:39; byte_jump:2,0,little,relative; content:\"|01 00|\"; within:2; distance:29; flowbits:set,smb.trans2; flowbits:noalert; metadata:policy max-detect-ips alert, ruleset community, service netbios-ssn; classtype:protocol-command-decode; sid:3142; rev:11;)"
    },
    {
        "description": "PROTOCOL-TELNET login buffer overflow attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $TELNET_SERVERS 23 (msg:\"PROTOCOL-TELNET login buffer overflow attempt\"; flow:to_server,established; content:\"|FF FA|'|00 00|TTYPROMPT|01|\"; fast_pattern:only; rawbytes; flowbits:set,ttyprompt; metadata:policy max-detect-ips drop, ruleset community, service telnet; reference:bugtraq,3681; reference:cve,2001-0797; reference:nessus,10827; classtype:attempted-admin; sid:3147; rev:15;)"
    },
    {
        "description": "PROTOCOL-TELNET login buffer non-evasive overflow attempt ",
        "rule": "alert tcp $EXTERNAL_NET any -> $TELNET_SERVERS 23 (msg:\"PROTOCOL-TELNET login buffer non-evasive overflow attempt \"; flow:to_server,established; content:\"|FF FA|'|00 00|\"; rawbytes; pcre:\"/T.*?T.*?Y.*?P.*?R.*?O.*?M.*?P.*?T/RBi\"; flowbits:set,ttyprompt; metadata:policy max-detect-ips drop, ruleset community, service telnet; reference:bugtraq,3681; reference:cve,2001-0797; reference:nessus,10827; classtype:attempted-admin; sid:3274; rev:15;)"
    },
    {
        "description": "FILE-OFFICE Microsoft Windows RTF file with embedded object package download attempt",
        "rule": "alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:\"FILE-OFFICE Microsoft Windows RTF file with embedded object package download attempt\"; flow:to_client,established; file_data; content:\"{|5C|rt\"; nocase; content:\"{|5C|object|5C|objemb{|5C|*|5C|objclass Package}\"; distance:0; nocase; flowbits:set,file.rtf.embed; metadata:policy max-detect-ips alert, policy security-ips alert, ruleset community, service ftp-data, service http, service imap, service pop3; reference:cve,2006-4692; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-065; classtype:misc-activity; sid:8445; rev:17;)"
    },
    {
        "description": "FILE-IDENTIFY RTF file download request",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"FILE-IDENTIFY RTF file download request\"; flow:to_server,established; content:\".rtf\"; fast_pattern:only; http_uri; pcre:\"/\\x2ertf([\\?\\x5c\\x2f]|$)/smiU\"; flowbits:set,file.rtf; flowbits:noalert; metadata:policy balanced-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service http; reference:url,en.wikipedia.org/wiki/Rich_Text_Format; classtype:misc-activity; sid:13801; rev:26;)"
    },
    {
        "description": "FILE-IDENTIFY PDF file download request",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"FILE-IDENTIFY PDF file download request\"; flow:to_server,established; content:\".pdf\"; fast_pattern:only; http_uri; pcre:\"/\\x2epdf([\\?\\x5c\\x2f]|$)/smiU\"; flowbits:set,file.pdf; flowbits:noalert; metadata:policy balanced-ips alert, policy connectivity-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service http; reference:url,en.wikipedia.org/wiki/Pdf; classtype:misc-activity; sid:15013; rev:23;)"
    },
    {
        "description": "FILE-IDENTIFY Microsoft Office Word file download request",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"FILE-IDENTIFY Microsoft Office Word file download request\"; flow:to_server,established; content:\".doc\"; fast_pattern:only; http_uri; pcre:\"/\\x2edoc([\\?\\x5c\\x2f]|$)/smiU\"; flowbits:set,file.doc; flowbits:set,file.rtf; flowbits:noalert; metadata:policy balanced-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service http; reference:url,en.wikipedia.org/wiki/Microsoft_word; classtype:misc-activity; sid:15587; rev:25;)"
    },
    {
        "description": "FILE-IDENTIFY BMP file download request",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"FILE-IDENTIFY BMP file download request\"; flow:to_server,established; content:\".bmp\"; fast_pattern:only; http_uri; pcre:\"/\\x2ebmp([\\?\\x5c\\x2f]|$)/smiU\"; flowbits:set,file.bmp; flowbits:noalert; metadata:policy balanced-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service http; reference:url,en.wikipedia.org/wiki/BMP_file_format; classtype:misc-activity; sid:16205; rev:23;)"
    },
    {
        "description": "FILE-IDENTIFY JPEG file download request",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"FILE-IDENTIFY JPEG file download request\"; flow:to_server,established; content:\".jpg\"; fast_pattern:only; http_uri; pcre:\"/\\x2ejpg([\\?\\x5c\\x2f]|$)/smiU\"; flowbits:set,file.jpeg; flowbits:noalert; metadata:policy balanced-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service http; reference:url,en.wikipedia.org/wiki/Jpg; classtype:misc-activity; sid:16406; rev:20;)"
    },
    {
        "description": "FILE-IDENTIFY JPEG file download request",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"FILE-IDENTIFY JPEG file download request\"; flow:to_server,established; content:\".jpeg\"; fast_pattern:only; http_uri; pcre:\"/\\x2ejpeg([\\?\\x5c\\x2f]|$)/smiU\"; flowbits:set,file.jpeg; flowbits:noalert; metadata:policy balanced-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service http; reference:url,en.wikipedia.org/wiki/Jpg; classtype:misc-activity; sid:16407; rev:20;)"
    },
    {
        "description": "FILE-IDENTIFY Portable Executable binary file download request",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"FILE-IDENTIFY Portable Executable binary file download request\"; flow:to_server,established; content:\".exe\"; fast_pattern:only; http_uri; pcre:\"/\\x2eexe([\\?\\x5c\\x2f]|$)/smiU\"; flowbits:set,file.exe; flowbits:noalert; metadata:policy max-detect-ips alert, ruleset community, service http; reference:url,en.wikipedia.org/wiki/.exe; classtype:misc-activity; sid:16425; rev:24;)"
    },
    {
        "description": "FILE-IDENTIFY Microsoft Compound File Binary v3 file magic detected",
        "rule": "alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:\"FILE-IDENTIFY Microsoft Compound File Binary v3 file magic detected\"; flow:to_client,established; file_data; content:\"|D0 CF 11 E0 A1 B1 1A E1|\"; content:\">|00 03 00|\"; within:4; distance:16; flowbits:set,file.ole; flowbits:noalert; metadata:policy balanced-ips alert, policy connectivity-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service ftp-data, service http, service imap, service pop3; classtype:misc-activity; sid:16474; rev:27;)"
    },
    {
        "description": "FILE-IDENTIFY Microsoft Compound File Binary v4 file magic detected",
        "rule": "alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:\"FILE-IDENTIFY Microsoft Compound File Binary v4 file magic detected\"; flow:to_client,established; file_data; content:\"|D0 CF 11 E0 A1 B1 1A E1|\"; content:\">|00 04 00|\"; within:4; distance:16; flowbits:set,file.oless.v4; flowbits:noalert; metadata:policy max-detect-ips alert, ruleset community, service ftp-data, service http, service imap, service pop3; classtype:misc-activity; sid:16475; rev:18;)"
    },
    {
        "description": "FILE-IDENTIFY JPEG file download request",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"FILE-IDENTIFY JPEG file download request\"; flow:to_server,established; content:\".pjpeg\"; fast_pattern:only; http_uri; pcre:\"/\\x2epjpeg([\\?\\x5c\\x2f]|$)/smiU\"; flowbits:set,file.jpeg; flowbits:noalert; metadata:policy balanced-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service http; reference:url,en.wikipedia.org/wiki/Jpg; classtype:misc-activity; sid:16529; rev:20;)"
    },
    {
        "description": "FILE-IDENTIFY OLE document file magic detected",
        "rule": "alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:\"FILE-IDENTIFY OLE document file magic detected\"; flow:to_client,established; file_data; content:\"|D0 CF 11 E0 A1 B1 1A E1|\"; depth:8; flowbits:set,file.ole; flowbits:set,file.fpx; flowbits:noalert; metadata:policy balanced-ips alert, policy connectivity-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service ftp-data, service http, service imap, service pop3; classtype:misc-activity; sid:17314; rev:27;)"
    },
    {
        "description": "FILE-IDENTIFY PNG file download request",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"FILE-IDENTIFY PNG file download request\"; flow:to_server,established; content:\".png\"; fast_pattern:only; http_uri; pcre:\"/\\x2epng([\\?\\x5c\\x2f]|$)/smiU\"; flowbits:set,file.png; flowbits:noalert; metadata:policy balanced-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service http; classtype:misc-activity; sid:17380; rev:23;)"
    },
    {
        "description": "FILE-IDENTIFY XML file download request",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"FILE-IDENTIFY XML file download request\"; flow:to_server,established; content:\".xml\"; fast_pattern:only; http_uri; pcre:\"/\\x2exml([\\?\\x5c\\x2f]|$)/smiU\"; flowbits:set,file.xml; flowbits:noalert; metadata:policy max-detect-ips alert, policy security-ips alert, ruleset community, service http; classtype:misc-activity; sid:17733; rev:18;)"
    },
    {
        "description": "NETBIOS SMB TRANS2 Find_First2 request attempt",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET 445 (msg:\"NETBIOS SMB TRANS2 Find_First2 request attempt\"; flow:to_server,established; content:\"|FF|SMB2|00 00 00 00|\"; depth:9; offset:4; content:\"|00 00|\"; within:2; distance:13; content:\"|00|\"; within:1; distance:18; content:\"|00 00|\"; within:2; distance:6; content:\"|01 00|\"; within:2; distance:10; flowbits:set,smb.trans2.findfirst2; flowbits:noalert; metadata:policy max-detect-ips alert, ruleset community, service netbios-ssn; classtype:protocol-command-decode; sid:17745; rev:10;)"
    },
    {
        "description": "NETBIOS SMB-DS Trans2 Distributed File System GET_DFS_REFERRAL request",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET 445 (msg:\"NETBIOS SMB-DS Trans2 Distributed File System GET_DFS_REFERRAL request\"; flow:established,to_server; content:\"|00|\"; offset:1; content:\"|FF|SMB2\"; depth:5; offset:4; content:\"|00 00 00 00|\"; within:4; content:\"|10 00|\"; depth:2; offset:65; flowbits:set,smb.trans2.get_dfs_referral; flowbits:noalert; metadata:policy max-detect-ips alert, ruleset community, service netbios-ssn; classtype:protocol-command-decode; sid:19190; rev:9;)"
    },
    {
        "description": "FILE-IDENTIFY ZIP archive file download request",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"FILE-IDENTIFY ZIP archive file download request\"; flow:to_server,established; content:\".zip\"; fast_pattern:only; http_uri; pcre:\"/\\x2ezip([\\?\\x5c\\x2f]|$)/smiU\"; flowbits:set,file.zip; flowbits:noalert; metadata:policy balanced-ips alert, policy connectivity-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service http; classtype:misc-activity; sid:19211; rev:23;)"
    },
    {
        "description": "FILE-IDENTIFY SMI file download request",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"FILE-IDENTIFY SMI file download request\"; flow:to_server,established; content:\".smi\"; fast_pattern:only; http_uri; pcre:\"/\\x2esmi([\\?\\x5c\\x2f]|$)/smiU\"; flowbits:set,file.realplayer.playlist; flowbits:set,file.smi; flowbits:set,file.dmg; flowbits:noalert; metadata:policy max-detect-ips alert, ruleset community, service http; reference:bugtraq,49149; reference:url,en.wikipedia.org/wiki/SAMI; classtype:misc-activity; sid:20223; rev:24;)"
    },
    {
        "description": "FILE-IDENTIFY Microsoft Client Agent Helper JAR file download request",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"FILE-IDENTIFY Microsoft Client Agent Helper JAR file download request\"; flow:to_server,established; content:\"_helper.jar\"; fast_pattern:only; pcre:\"/agent_(win|lin|mac)_helper\\.jar$/siU\"; flowbits:set,file.jar.agent_helper; flowbits:noalert; metadata:policy max-detect-ips alert, ruleset community, service http; reference:cve,2011-1969; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-079; classtype:misc-activity; sid:20260; rev:19;)"
    },
    {
        "description": "FILE-IDENTIFY JAR/ZIP file magic detected",
        "rule": "alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:\"FILE-IDENTIFY JAR/ZIP file magic detected\"; flow:to_client,established; file_data; content:\"PK|03 04|\"; content:!\"|14 00 06 00|\"; within:4; flowbits:set,file.zip; flowbits:set,file.jar; flowbits:noalert; metadata:policy balanced-ips alert, policy connectivity-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service ftp-data, service http, service imap, service pop3; classtype:misc-activity; sid:20463; rev:26;)"
    },
    {
        "description": "FILE-IDENTIFY JAR/ZIP file magic detected",
        "rule": "alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:\"FILE-IDENTIFY JAR/ZIP file magic detected\"; flow:to_client,established; file_data; content:\"PK00PK|03 04|\"; flowbits:set,file.zip; flowbits:set,file.jar; flowbits:noalert; metadata:policy balanced-ips alert, policy connectivity-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service ftp-data, service http, service imap, service pop3; classtype:misc-activity; sid:20464; rev:25;)"
    },
    {
        "description": "FILE-IDENTIFY JAR/ZIP file magic detected",
        "rule": "alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:\"FILE-IDENTIFY JAR/ZIP file magic detected\"; flow:to_client,established; file_data; content:\"PK|01 02|\"; flowbits:set,file.zip; flowbits:set,file.jar; flowbits:noalert; metadata:policy balanced-ips alert, policy connectivity-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service ftp-data, service http, service imap, service pop3; classtype:misc-activity; sid:20465; rev:25;)"
    },
    {
        "description": "FILE-IDENTIFY JAR/ZIP file magic detected",
        "rule": "alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:\"FILE-IDENTIFY JAR/ZIP file magic detected\"; flow:to_client,established; file_data; content:\"PK|05 06|\"; flowbits:set,file.zip; flowbits:set,file.jar; flowbits:noalert; metadata:policy balanced-ips alert, policy connectivity-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service ftp-data, service http, service imap, service pop3; classtype:misc-activity; sid:20466; rev:25;)"
    },
    {
        "description": "FILE-IDENTIFY JAR/ZIP file magic detected",
        "rule": "alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:\"FILE-IDENTIFY JAR/ZIP file magic detected\"; flow:to_client,established; file_data; content:\"PK|06 08|\"; flowbits:set,file.zip; flowbits:set,file.jar; flowbits:noalert; metadata:policy balanced-ips alert, policy connectivity-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service ftp-data, service http, service imap, service pop3; classtype:misc-activity; sid:20467; rev:25;)"
    },
    {
        "description": "FILE-IDENTIFY JAR/ZIP file magic detected",
        "rule": "alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:\"FILE-IDENTIFY JAR/ZIP file magic detected\"; flow:to_client,established; file_data; content:\"PK|06 07|\"; flowbits:set,file.zip; flowbits:set,file.jar; flowbits:noalert; metadata:policy balanced-ips alert, policy connectivity-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service ftp-data, service http, service imap, service pop3; classtype:misc-activity; sid:20468; rev:25;)"
    },
    {
        "description": "FILE-IDENTIFY JAR/ZIP file magic detected",
        "rule": "alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:\"FILE-IDENTIFY JAR/ZIP file magic detected\"; flow:to_client,established; file_data; content:\"PK|06 06|\"; flowbits:set,file.zip; flowbits:set,file.jar; flowbits:noalert; metadata:policy balanced-ips alert, policy connectivity-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service ftp-data, service http, service imap, service pop3; classtype:misc-activity; sid:20469; rev:25;)"
    },
    {
        "description": "FILE-IDENTIFY PNG file magic detected",
        "rule": "alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:\"FILE-IDENTIFY PNG file magic detected\"; flow:to_client,established; file_data; content:\"|89|PNG|0D 0A 1A 0A|\"; depth:8; flowbits:set,file.png; flowbits:noalert; metadata:policy balanced-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service ftp-data, service http, service imap, service pop3; classtype:misc-activity; sid:20478; rev:22;)"
    },
    {
        "description": "FILE-IDENTIFY JPEG file magic detection",
        "rule": "alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:\"FILE-IDENTIFY JPEG file magic detection\"; flow:to_client,established; file_data; content:\"|FF D8 FF|\"; depth:3; flowbits:set,file.jpeg; flowbits:noalert; metadata:policy balanced-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service ftp-data, service http, service imap, service pop3; classtype:misc-activity; sid:20480; rev:21;)"
    },
    {
        "description": "FILE-IDENTIFY JPEG file magic detected",
        "rule": "alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:\"FILE-IDENTIFY JPEG file magic detected\"; flow:to_client,established; file_data; content:\"|FF D8 FF E0|\"; depth:4; flowbits:set,file.jpeg; flowbits:noalert; metadata:policy balanced-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service ftp-data, service http, service imap, service pop3; classtype:misc-activity; sid:20483; rev:22;)"
    },
    {
        "description": "FILE-IDENTIFY RTF file magic detected",
        "rule": "alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:\"FILE-IDENTIFY RTF file magic detected\"; flow:to_client,established; file_data; content:\"{|5C|rt\"; fast_pattern:only; flowbits:set,file.rtf; flowbits:noalert; metadata:policy balanced-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service ftp-data, service http, service imap, service pop3; classtype:misc-activity; sid:20486; rev:23;)"
    },
    {
        "description": "FILE-IDENTIFY PDF file magic detected",
        "rule": "alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:\"FILE-IDENTIFY PDF file magic detected\"; flow:to_client,established; file_data; content:\"%PDF-\"; nocase; flowbits:set,file.pdf; flowbits:noalert; metadata:policy balanced-ips alert, policy connectivity-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service ftp-data, service http, service imap, service pop3; classtype:misc-activity; sid:20494; rev:19;)"
    },
    {
        "description": "FILE-IDENTIFY JAR file download request",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"FILE-IDENTIFY JAR file download request\"; flow:to_server,established; content:\".jar\"; fast_pattern:only; http_uri; pcre:\"/\\x2ejar([\\?\\x5c\\x2f]|$)/smiU\"; flowbits:set,file.jar; flowbits:noalert; metadata:policy balanced-ips alert, policy connectivity-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service http; classtype:misc-activity; sid:20621; rev:18;)"
    },
    {
        "description": "FILE-IDENTIFY Microsoft Windows EMF metafile file attachment detected",
        "rule": "alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:\"FILE-IDENTIFY Microsoft Windows EMF metafile file attachment detected\"; flow:to_client,established; content:\".emf\"; fast_pattern:only; content:\"Content-Disposition: attachment|3B|\"; content:\"filename=\"; nocase; pcre:\"/filename=[^\\n]*\\x2eemf/i\"; flowbits:set,file.emf; flowbits:noalert; metadata:policy max-detect-ips alert, ruleset community, service imap, service pop3; classtype:misc-activity; sid:20850; rev:17;)"
    },
    {
        "description": "FILE-IDENTIFY Microsoft Windows EMF metafile file attachment detected",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"FILE-IDENTIFY Microsoft Windows EMF metafile file attachment detected\"; flow:to_server,established; content:\".emf\"; fast_pattern:only; content:\"Content-Disposition: attachment|3B|\"; content:\"filename=\"; nocase; pcre:\"/filename=[^\\n]*\\x2eemf/i\"; flowbits:set,file.emf; flowbits:noalert; metadata:policy max-detect-ips alert, ruleset community, service smtp; classtype:misc-activity; sid:20851; rev:18;)"
    },
    {
        "description": "FILE-IDENTIFY DIB file download request",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"FILE-IDENTIFY DIB file download request\"; flow:to_server,established; content:\".dib\"; fast_pattern:only; http_uri; pcre:\"/\\x2edib([\\?\\x5c\\x2f]|$)/smiU\"; flowbits:set,file.bmp; flowbits:noalert; metadata:policy balanced-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service http; reference:url,en.wikipedia.org/wiki/BMP_file_format; classtype:misc-activity; sid:20963; rev:16;)"
    },
    {
        "description": "FILE-IDENTIFY SAMI file download request",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"FILE-IDENTIFY SAMI file download request\"; flow:to_server,established; content:\".sami\"; fast_pattern:only; http_uri; pcre:\"/\\x2esami([\\?\\x5c\\x2f]|$)/smiU\"; flowbits:set,file.realplayer.playlist; flowbits:set,file.smi; flowbits:noalert; metadata:policy max-detect-ips alert, ruleset community, service http; reference:url,en.wikipedia.org/wiki/SAMI; classtype:misc-activity; sid:20964; rev:15;)"
    },
    {
        "description": "FILE-IDENTIFY JPEG file download request",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"FILE-IDENTIFY JPEG file download request\"; flow:to_server,established; content:\".jpe\"; fast_pattern:only; http_uri; pcre:\"/\\x2ejpe([\\?\\x5c\\x2f]|$)/smiU\"; flowbits:set,file.jpeg; flowbits:noalert; metadata:policy balanced-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service http; reference:url,en.wikipedia.org/wiki/Jpg; classtype:misc-activity; sid:20965; rev:14;)"
    },
    {
        "description": "FILE-IDENTIFY JPEG file download request",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"FILE-IDENTIFY JPEG file download request\"; flow:to_server,established; content:\".jif\"; fast_pattern:only; http_uri; pcre:\"/\\x2ejif([\\?\\x5c\\x2f]|$)/smiU\"; flowbits:set,file.jpeg; flowbits:noalert; metadata:policy balanced-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service http; reference:url,en.wikipedia.org/wiki/Jpg; classtype:misc-activity; sid:20966; rev:14;)"
    },
    {
        "description": "FILE-IDENTIFY JPEG file download request",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"FILE-IDENTIFY JPEG file download request\"; flow:to_server,established; content:\".jfi\"; fast_pattern:only; http_uri; pcre:\"/\\x2ejfif?([\\?\\x5c\\x2f]|$)/smiU\"; flowbits:set,file.jpeg; flowbits:noalert; metadata:policy balanced-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service http; reference:url,en.wikipedia.org/wiki/Jpg; classtype:misc-activity; sid:20967; rev:14;)"
    },
    {
        "description": "FILE-IDENTIFY PDF file attachment detected",
        "rule": "alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:\"FILE-IDENTIFY PDF file attachment detected\"; flow:to_client,established; content:\".pdf\"; fast_pattern:only; content:\"Content-Disposition: attachment|3B|\"; content:\"filename=\"; nocase; pcre:\"/filename=[^\\n]*\\x2epdf/i\"; flowbits:set,file.pdf; flowbits:noalert; metadata:policy balanced-ips alert, policy connectivity-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service imap, service pop3; classtype:misc-activity; sid:21035; rev:17;)"
    },
    {
        "description": "FILE-IDENTIFY PDF file attachment detected",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"FILE-IDENTIFY PDF file attachment detected\"; flow:to_server,established; content:\".pdf\"; fast_pattern:only; content:\"Content-Disposition: attachment|3B|\"; content:\"filename=\"; nocase; pcre:\"/filename=[^\\n]*\\x2epdf/i\"; flowbits:set,file.pdf; flowbits:noalert; metadata:policy balanced-ips alert, policy connectivity-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service smtp; classtype:misc-activity; sid:21036; rev:18;)"
    },
    {
        "description": "MALWARE-OTHER known malicious FTP login banner - 0wns j0",
        "rule": "alert tcp $EXTERNAL_NET 21 -> $HOME_NET any (msg:\"MALWARE-OTHER known malicious FTP login banner - 0wns j0\"; flow:established,to_client; content:\"220|20|\"; depth:4; content:\"0wns j0\"; distance:0; nocase; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ftp; reference:url,seclists.org/fulldisclosure/2004/Sep/895; reference:url,www.cyber-ta.org/releases/malware-analysis/public/SOURCES/CLUSTERS-NEW/behavior-summary.html; classtype:trojan-activity; sid:21255; rev:6;)"
    },
    {
        "description": "MALWARE-OTHER known malicious FTP quit banner - Goodbye happy r00ting",
        "rule": "alert tcp $EXTERNAL_NET 21 -> $HOME_NET any (msg:\"MALWARE-OTHER known malicious FTP quit banner - Goodbye happy r00ting\"; flow:established,to_client; content:\"221 Goodbye happy r00ting\"; fast_pattern:only; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ftp; reference:url,taosecurity.blogspot.com/2006/01/nepenthes-discoveries-earlier-today-i.html; classtype:trojan-activity; sid:21256; rev:7;)"
    },
    {
        "description": "FILE-IDENTIFY XSL file download request",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"FILE-IDENTIFY XSL file download request\"; flow:to_server,established; content:\".xsl\"; fast_pattern:only; http_uri; pcre:\"/\\x2exsl([\\?\\x5c\\x2f]|$)/smiU\"; flowbits:set,file.xml; flowbits:noalert; metadata:policy max-detect-ips alert, policy security-ips alert, ruleset community, service http; reference:url,attack.mitre.org/techniques/T1220; classtype:misc-activity; sid:21282; rev:12;)"
    },
    {
        "description": "FILE-IDENTIFY XSL file attachment detected",
        "rule": "alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:\"FILE-IDENTIFY XSL file attachment detected\"; flow:to_client,established; content:\".xsl\"; fast_pattern:only; content:\"Content-Disposition: attachment|3B|\"; content:\"filename=\"; nocase; pcre:\"/filename=[^\\n]*\\x2exsl/i\"; flowbits:set,file.xml; flowbits:noalert; metadata:policy max-detect-ips alert, policy security-ips alert, ruleset community, service imap, service pop3; reference:url,attack.mitre.org/techniques/T1220; classtype:misc-activity; sid:21283; rev:13;)"
    },
    {
        "description": "FILE-IDENTIFY XSL file attachment detected",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"FILE-IDENTIFY XSL file attachment detected\"; flow:to_server,established; content:\".xsl\"; fast_pattern:only; content:\"Content-Disposition: attachment|3B|\"; content:\"filename=\"; nocase; pcre:\"/filename=[^\\n]*\\x2exsl/i\"; flowbits:set,file.xml; flowbits:noalert; metadata:policy max-detect-ips alert, policy security-ips alert, ruleset community, service smtp; reference:url,attack.mitre.org/techniques/T1220; classtype:misc-activity; sid:21284; rev:14;)"
    },
    {
        "description": "FILE-IDENTIFY XSLT file download request",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"FILE-IDENTIFY XSLT file download request\"; flow:to_server,established; content:\".xslt\"; fast_pattern:only; http_uri; pcre:\"/\\x2exslt([\\?\\x5c\\x2f]|$)/smiU\"; flowbits:set,file.xml; flowbits:noalert; metadata:policy max-detect-ips alert, policy security-ips alert, ruleset community, service http; reference:url,attack.mitre.org/techniques/T1220; classtype:misc-activity; sid:21285; rev:12;)"
    },
    {
        "description": "FILE-IDENTIFY XSLT file attachment detected",
        "rule": "alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:\"FILE-IDENTIFY XSLT file attachment detected\"; flow:to_client,established; content:\".xslt\"; fast_pattern:only; content:\"Content-Disposition: attachment|3B|\"; content:\"filename=\"; nocase; pcre:\"/filename=[^\\n]*\\x2exslt/i\"; flowbits:set,file.xml; flowbits:noalert; metadata:policy max-detect-ips alert, policy security-ips alert, ruleset community, service imap, service pop3; reference:url,attack.mitre.org/techniques/T1220; classtype:misc-activity; sid:21286; rev:13;)"
    },
    {
        "description": "FILE-IDENTIFY XSLT file attachment detected",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"FILE-IDENTIFY XSLT file attachment detected\"; flow:to_server,established; content:\".xslt\"; fast_pattern:only; content:\"Content-Disposition: attachment|3B|\"; content:\"filename=\"; nocase; pcre:\"/filename=[^\\n]*\\x2exslt/i\"; flowbits:set,file.xml; flowbits:noalert; metadata:policy max-detect-ips alert, policy security-ips alert, ruleset community, service smtp; reference:url,attack.mitre.org/techniques/T1220; classtype:misc-activity; sid:21287; rev:14;)"
    },
    {
        "description": "FILE-IDENTIFY XML download detected",
        "rule": "alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:\"FILE-IDENTIFY XML download detected\"; flow:to_client,established; content:\"Content-Type|3A|\"; nocase; http_header; content:\"text/xml\"; within:20; fast_pattern; nocase; http_header; flowbits:set,file.xml; flowbits:noalert; metadata:policy max-detect-ips alert, policy security-ips alert, ruleset community, service http; classtype:misc-activity; sid:21288; rev:14;)"
    },
    {
        "description": "FILE-IDENTIFY paq8o file download request",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"FILE-IDENTIFY paq8o file download request\"; flow:to_server,established; content:\".paq8o\"; fast_pattern:only; http_uri; pcre:\"/\\x2epaq8o([\\?\\x5c\\x2f]|$)/smiU\"; flowbits:set,file.zip; flowbits:noalert; metadata:policy balanced-ips alert, policy connectivity-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service http; classtype:misc-activity; sid:21410; rev:15;)"
    },
    {
        "description": "FILE-IDENTIFY paq8o file attachment detected",
        "rule": "alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:\"FILE-IDENTIFY paq8o file attachment detected\"; flow:to_client,established; content:\".paq8o\"; fast_pattern:only; content:\"Content-Disposition: attachment|3B|\"; content:\"filename=\"; nocase; pcre:\"/filename=[^\\n]*\\x2epaq8o/i\"; flowbits:set,file.zip; flowbits:noalert; metadata:policy balanced-ips alert, policy connectivity-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service imap, service pop3; classtype:misc-activity; sid:21411; rev:16;)"
    },
    {
        "description": "FILE-IDENTIFY paq8o file attachment detected",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"FILE-IDENTIFY paq8o file attachment detected\"; flow:to_server,established; content:\".paq8o\"; fast_pattern:only; content:\"Content-Disposition: attachment|3B|\"; content:\"filename=\"; nocase; pcre:\"/filename=[^\\n]*\\x2epaq8o/i\"; flowbits:set,file.zip; flowbits:noalert; metadata:policy balanced-ips alert, policy connectivity-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service smtp; classtype:misc-activity; sid:21412; rev:17;)"
    },
    {
        "description": "FILE-IDENTIFY XML file magic detected",
        "rule": "alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:\"FILE-IDENTIFY XML file magic detected\"; flow:to_client,established; file_data; content:\"<xml>\"; depth:50; nocase; flowbits:set,file.xml; flowbits:set,file.xul; flowbits:noalert; metadata:policy max-detect-ips alert, policy security-ips alert, ruleset community, service ftp-data, service http, service imap, service pop3; classtype:misc-activity; sid:21480; rev:16;)"
    },
    {
        "description": "FILE-IDENTIFY XML file magic detected",
        "rule": "alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:\"FILE-IDENTIFY XML file magic detected\"; flow:to_client,established; file_data; content:\"<?xml\"; depth:50; nocase; flowbits:set,file.xml; flowbits:set,file.xul; flowbits:noalert; metadata:policy max-detect-ips alert, policy security-ips alert, ruleset community, service ftp-data, service http, service imap, service pop3; classtype:misc-activity; sid:21498; rev:16;)"
    },
    {
        "description": "FILE-IDENTIFY XML file attachment detected",
        "rule": "alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:\"FILE-IDENTIFY XML file attachment detected\"; flow:to_client,established; content:\".xml\"; fast_pattern:only; content:\"Content-Disposition: attachment|3B|\"; content:\"filename=\"; nocase; pcre:\"/filename=[^\\n]*\\x2exml/i\"; flowbits:set,file.xml; flowbits:noalert; metadata:policy max-detect-ips alert, policy security-ips alert, ruleset community, service imap, service pop3; classtype:misc-activity; sid:21499; rev:11;)"
    },
    {
        "description": "FILE-IDENTIFY XML file attachment detected",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"FILE-IDENTIFY XML file attachment detected\"; flow:to_server,established; content:\".xml\"; fast_pattern:only; content:\"Content-Disposition: attachment|3B|\"; content:\"filename=\"; nocase; pcre:\"/filename=[^\\n]*\\x2exml/i\"; flowbits:set,file.xml; flowbits:noalert; metadata:policy max-detect-ips alert, policy security-ips alert, ruleset community, service smtp; classtype:misc-activity; sid:21500; rev:12;)"
    },
    {
        "description": "FILE-IDENTIFY PNG file attachment detected",
        "rule": "alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:\"FILE-IDENTIFY PNG file attachment detected\"; flow:to_client,established; content:\".png\"; fast_pattern:only; content:\"Content-Disposition: attachment|3B|\"; content:\"filename=\"; nocase; pcre:\"/filename=[^\\n]*\\x2epng/i\"; flowbits:set,file.png; flowbits:noalert; metadata:policy balanced-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service imap, service pop3; classtype:misc-activity; sid:21613; rev:16;)"
    },
    {
        "description": "FILE-IDENTIFY PNG file attachment detected",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"FILE-IDENTIFY PNG file attachment detected\"; flow:to_server,established; content:\".png\"; fast_pattern:only; content:\"Content-Disposition: attachment|3B|\"; content:\"filename=\"; nocase; pcre:\"/filename=[^\\n]*\\x2epng/i\"; flowbits:set,file.png; flowbits:noalert; metadata:policy balanced-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service smtp; classtype:misc-activity; sid:21614; rev:17;)"
    },
    {
        "description": "FILE-IDENTIFY SMI file attachment detected",
        "rule": "alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:\"FILE-IDENTIFY SMI file attachment detected\"; flow:to_client,established; content:\".smi\"; fast_pattern:only; content:\"Content-Disposition: attachment|3B|\"; content:\"filename=\"; nocase; pcre:\"/filename=[^\\n]*\\x2esmi/i\"; flowbits:set,file.realplayer.playlist; flowbits:set,file.dmg; flowbits:set,file.smi; flowbits:noalert; metadata:policy max-detect-ips alert, ruleset community, service imap, service pop3; classtype:misc-activity; sid:21695; rev:12;)"
    },
    {
        "description": "FILE-IDENTIFY SMI file attachment detected",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"FILE-IDENTIFY SMI file attachment detected\"; flow:to_server,established; content:\".smi\"; fast_pattern:only; content:\"Content-Disposition: attachment|3B|\"; content:\"filename=\"; nocase; pcre:\"/filename=[^\\n]*\\x2esmi/i\"; flowbits:set,file.realplayer.playlist; flowbits:set,file.dmg; flowbits:set,file.smi; flowbits:noalert; metadata:policy max-detect-ips alert, ruleset community, service smtp; classtype:misc-activity; sid:21696; rev:13;)"
    },
    {
        "description": "FILE-IDENTIFY SAMI file attachment detected",
        "rule": "alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:\"FILE-IDENTIFY SAMI file attachment detected\"; flow:to_client,established; content:\".sami\"; fast_pattern:only; content:\"Content-Disposition: attachment|3B|\"; content:\"filename=\"; nocase; pcre:\"/filename=[^\\n]*\\x2esami/i\"; flowbits:set,file.realplayer.playlist; flowbits:set,file.smi; flowbits:noalert; metadata:policy max-detect-ips alert, ruleset community, service imap, service pop3; classtype:misc-activity; sid:21697; rev:12;)"
    },
    {
        "description": "FILE-IDENTIFY SAMI file attachment detected",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"FILE-IDENTIFY SAMI file attachment detected\"; flow:to_server,established; content:\".sami\"; fast_pattern:only; content:\"Content-Disposition: attachment|3B|\"; content:\"filename=\"; nocase; pcre:\"/filename=[^\\n]*\\x2esami/i\"; flowbits:set,file.realplayer.playlist; flowbits:set,file.smi; flowbits:noalert; metadata:policy max-detect-ips alert, ruleset community, service smtp; classtype:misc-activity; sid:21698; rev:13;)"
    },
    {
        "description": "FILE-IDENTIFY ANI file download request",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"FILE-IDENTIFY ANI file download request\"; flow:to_server,established; content:\".ani\"; fast_pattern:only; http_uri; pcre:\"/\\x2eani([\\?\\x5c\\x2f]|$)/smiU\"; flowbits:set,file.ani; flowbits:noalert; metadata:policy max-detect-ips alert, ruleset community, service http; classtype:misc-activity; sid:21724; rev:12;)"
    },
    {
        "description": "FILE-IDENTIFY ANI file attachment detected",
        "rule": "alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:\"FILE-IDENTIFY ANI file attachment detected\"; flow:to_client,established; content:\".ani\"; fast_pattern:only; content:\"Content-Disposition: attachment|3B|\"; content:\"filename=\"; nocase; pcre:\"/filename=[^\\n]*\\x2eani/i\"; flowbits:set,file.ani; flowbits:noalert; metadata:policy max-detect-ips alert, ruleset community, service imap, service pop3; classtype:misc-activity; sid:21725; rev:12;)"
    },
    {
        "description": "FILE-IDENTIFY ANI file attachment detected",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"FILE-IDENTIFY ANI file attachment detected\"; flow:to_server,established; content:\".ani\"; fast_pattern:only; content:\"Content-Disposition: attachment|3B|\"; content:\"filename=\"; nocase; pcre:\"/filename=[^\\n]*\\x2eani/i\"; flowbits:set,file.ani; flowbits:noalert; metadata:policy max-detect-ips alert, ruleset community, service smtp; classtype:misc-activity; sid:21726; rev:13;)"
    },
    {
        "description": "FILE-IDENTIFY ANI file magic detection",
        "rule": "alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:\"FILE-IDENTIFY ANI file magic detection\"; flow:to_client,established; file_data; content:\"RIFF\"; depth:4; content:\"ACON\"; within:4; distance:4; flowbits:set,file.ani; flowbits:noalert; metadata:policy max-detect-ips alert, ruleset community, service ftp-data, service http, service imap, service pop3; classtype:misc-activity; sid:21727; rev:12;)"
    },
    {
        "description": "FILE-IDENTIFY JPG file attachment detected",
        "rule": "alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:\"FILE-IDENTIFY JPG file attachment detected\"; flow:to_client,established; content:\".jpg\"; fast_pattern:only; content:\"Content-Disposition: attachment|3B|\"; content:\"filename=\"; nocase; pcre:\"/filename=[^\\n]*\\x2ejpg/i\"; flowbits:set,file.jpeg; flowbits:noalert; metadata:policy balanced-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service imap, service pop3; classtype:misc-activity; sid:21728; rev:12;)"
    },
    {
        "description": "FILE-IDENTIFY JPG file attachment detected",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"FILE-IDENTIFY JPG file attachment detected\"; flow:to_server,established; content:\".jpg\"; fast_pattern:only; content:\"Content-Disposition: attachment|3B|\"; content:\"filename=\"; nocase; pcre:\"/filename=[^\\n]*\\x2ejpg/i\"; flowbits:set,file.jpeg; flowbits:noalert; metadata:policy balanced-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service smtp; classtype:misc-activity; sid:21729; rev:13;)"
    },
    {
        "description": "FILE-IDENTIFY JPG file attachment detected",
        "rule": "alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:\"FILE-IDENTIFY JPG file attachment detected\"; flow:to_client,established; content:\".jpeg\"; fast_pattern:only; content:\"Content-Disposition: attachment|3B|\"; content:\"filename=\"; nocase; pcre:\"/filename=[^\\n]*\\x2ejpeg/i\"; flowbits:set,file.jpeg; flowbits:noalert; metadata:policy balanced-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service imap, service pop3; classtype:misc-activity; sid:21730; rev:12;)"
    },
    {
        "description": "FILE-IDENTIFY JPG file attachment detected",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"FILE-IDENTIFY JPG file attachment detected\"; flow:to_server,established; content:\".jpeg\"; fast_pattern:only; content:\"Content-Disposition: attachment|3B|\"; content:\"filename=\"; nocase; pcre:\"/filename=[^\\n]*\\x2ejpeg/i\"; flowbits:set,file.jpeg; flowbits:noalert; metadata:policy balanced-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service smtp; classtype:misc-activity; sid:21731; rev:13;)"
    },
    {
        "description": "FILE-IDENTIFY JPG file attachment detected",
        "rule": "alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:\"FILE-IDENTIFY JPG file attachment detected\"; flow:to_client,established; content:\".pjpeg\"; fast_pattern:only; content:\"Content-Disposition: attachment|3B|\"; content:\"filename=\"; nocase; pcre:\"/filename=[^\\n]*\\x2epjpeg/i\"; flowbits:set,file.jpeg; flowbits:noalert; metadata:policy balanced-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service imap, service pop3; classtype:misc-activity; sid:21732; rev:12;)"
    },
    {
        "description": "FILE-IDENTIFY JPG file attachment detected",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"FILE-IDENTIFY JPG file attachment detected\"; flow:to_server,established; content:\".pjpeg\"; fast_pattern:only; content:\"Content-Disposition: attachment|3B|\"; content:\"filename=\"; nocase; pcre:\"/filename=[^\\n]*\\x2epjpeg/i\"; flowbits:set,file.jpeg; flowbits:noalert; metadata:policy balanced-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service smtp; classtype:misc-activity; sid:21733; rev:13;)"
    },
    {
        "description": "FILE-IDENTIFY JPG file attachment detected",
        "rule": "alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:\"FILE-IDENTIFY JPG file attachment detected\"; flow:to_client,established; content:\".jpe\"; fast_pattern:only; content:\"Content-Disposition: attachment|3B|\"; content:\"filename=\"; nocase; pcre:\"/filename=[^\\n]*\\x2ejpe/i\"; flowbits:set,file.jpeg; flowbits:noalert; metadata:policy balanced-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service imap, service pop3; classtype:misc-activity; sid:21734; rev:12;)"
    },
    {
        "description": "FILE-IDENTIFY JPG file attachment detected",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"FILE-IDENTIFY JPG file attachment detected\"; flow:to_server,established; content:\".jpe\"; fast_pattern:only; content:\"Content-Disposition: attachment|3B|\"; content:\"filename=\"; nocase; pcre:\"/filename=[^\\n]*\\x2ejpe/i\"; flowbits:set,file.jpeg; flowbits:noalert; metadata:policy balanced-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service smtp; classtype:misc-activity; sid:21735; rev:13;)"
    },
    {
        "description": "FILE-IDENTIFY JPG file attachment detected",
        "rule": "alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:\"FILE-IDENTIFY JPG file attachment detected\"; flow:to_client,established; content:\".jif\"; fast_pattern:only; content:\"Content-Disposition: attachment|3B|\"; content:\"filename=\"; nocase; pcre:\"/filename=[^\\n]*\\x2ejif/i\"; flowbits:set,file.jpeg; flowbits:noalert; metadata:policy balanced-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service imap, service pop3; classtype:misc-activity; sid:21736; rev:12;)"
    },
    {
        "description": "FILE-IDENTIFY JPG file attachment detected",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"FILE-IDENTIFY JPG file attachment detected\"; flow:to_server,established; content:\".jif\"; fast_pattern:only; content:\"Content-Disposition: attachment|3B|\"; content:\"filename=\"; nocase; pcre:\"/filename=[^\\n]*\\x2ejif/i\"; flowbits:set,file.jpeg; flowbits:noalert; metadata:policy balanced-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service smtp; classtype:misc-activity; sid:21737; rev:13;)"
    },
    {
        "description": "FILE-IDENTIFY JPG file attachment detected",
        "rule": "alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:\"FILE-IDENTIFY JPG file attachment detected\"; flow:to_client,established; content:\".jfi\"; fast_pattern:only; content:\"Content-Disposition: attachment|3B|\"; content:\"filename=\"; nocase; pcre:\"/filename=[^\\n]*\\x2ejfi/i\"; flowbits:set,file.jpeg; flowbits:noalert; metadata:policy balanced-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service imap, service pop3; classtype:misc-activity; sid:21738; rev:13;)"
    },
    {
        "description": "FILE-IDENTIFY JPG file attachment detected",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"FILE-IDENTIFY JPG file attachment detected\"; flow:to_server,established; content:\".jfi\"; fast_pattern:only; content:\"Content-Disposition: attachment|3B|\"; content:\"filename=\"; nocase; pcre:\"/filename=[^\\n]*\\x2ejfi/i\"; flowbits:set,file.jpeg; flowbits:noalert; metadata:policy balanced-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service smtp; classtype:misc-activity; sid:21739; rev:14;)"
    },
    {
        "description": "FILE-IDENTIFY RTF file attachment detected",
        "rule": "alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:\"FILE-IDENTIFY RTF file attachment detected\"; flow:to_client,established; content:\".rtf\"; fast_pattern:only; content:\"Content-Disposition: attachment|3B|\"; content:\"filename=\"; nocase; pcre:\"/filename=[^\\n]*\\x2ertf/i\"; flowbits:set,file.rtf; flowbits:noalert; metadata:policy balanced-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service imap, service pop3; classtype:misc-activity; sid:21746; rev:12;)"
    },
    {
        "description": "FILE-IDENTIFY RTF file attachment detected",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"FILE-IDENTIFY RTF file attachment detected\"; flow:to_server,established; content:\".rtf\"; fast_pattern:only; content:\"Content-Disposition: attachment|3B|\"; content:\"filename=\"; nocase; pcre:\"/filename=[^\\n]*\\x2ertf/i\"; flowbits:set,file.rtf; flowbits:noalert; metadata:policy balanced-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service smtp; classtype:misc-activity; sid:21747; rev:13;)"
    },
    {
        "description": "FILE-IDENTIFY ZIP file attachment detected",
        "rule": "alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:\"FILE-IDENTIFY ZIP file attachment detected\"; flow:to_client,established; content:\".zip\"; fast_pattern:only; content:\"Content-Disposition: attachment|3B|\"; content:\"filename=\"; nocase; pcre:\"/filename=[^\\n]*\\x2ezip/i\"; flowbits:set,file.zip; flowbits:noalert; metadata:policy balanced-ips alert, policy connectivity-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service imap, service pop3; classtype:misc-activity; sid:21856; rev:13;)"
    },
    {
        "description": "FILE-IDENTIFY ZIP file attachment detected",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"FILE-IDENTIFY ZIP file attachment detected\"; flow:to_server,established; content:\".zip\"; fast_pattern:only; content:\"Content-Disposition: attachment|3B|\"; content:\"filename=\"; nocase; pcre:\"/filename=[^\\n]*\\x2ezip/i\"; flowbits:set,file.zip; flowbits:noalert; metadata:policy balanced-ips alert, policy connectivity-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service smtp; classtype:misc-activity; sid:21857; rev:14;)"
    },
    {
        "description": "FILE-IDENTIFY Portable Executable file attachment detected",
        "rule": "alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:\"FILE-IDENTIFY Portable Executable file attachment detected\"; flow:to_client,established; content:\".exe\"; fast_pattern:only; content:\"Content-Disposition: attachment|3B|\"; content:\"filename=\"; nocase; pcre:\"/filename=[^\\n]*\\x2eexe/i\"; flowbits:set,file.exe; flowbits:noalert; metadata:policy max-detect-ips alert, ruleset community, service imap, service pop3; classtype:misc-activity; sid:21908; rev:11;)"
    },
    {
        "description": "FILE-IDENTIFY Portable Executable file attachment detected",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"FILE-IDENTIFY Portable Executable file attachment detected\"; flow:to_server,established; content:\".exe\"; fast_pattern:only; content:\"Content-Disposition: attachment|3B|\"; content:\"filename=\"; nocase; pcre:\"/filename=[^\\n]*\\x2eexe/i\"; flowbits:set,file.exe; flowbits:noalert; metadata:policy max-detect-ips alert, ruleset community, service smtp; classtype:misc-activity; sid:21909; rev:12;)"
    },
    {
        "description": "FILE-IDENTIFY EMF file magic detected",
        "rule": "alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:\"FILE-IDENTIFY EMF file magic detected\"; flow:to_client,established; file_data; content:\"|01 00 00 00|\"; depth:4; content:\"|20|EMF\"; within:4; distance:36; fast_pattern; flowbits:set,file.emf; flowbits:noalert; metadata:policy max-detect-ips alert, ruleset community, service ftp-data, service http, service imap, service pop3; classtype:misc-activity; sid:21940; rev:13;)"
    },
    {
        "description": "FILE-IDENTIFY XM file download request",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"FILE-IDENTIFY XM file download request\"; flow:to_server,established; content:\".xm\"; fast_pattern:only; http_uri; pcre:\"/\\x2exm([\\?\\x5c\\x2f]|$)/smiU\"; flowbits:set,file.xm; flowbits:noalert; metadata:policy max-detect-ips alert, ruleset community, service http; classtype:misc-activity; sid:22043; rev:8;)"
    },
    {
        "description": "FILE-IDENTIFY XM file attachment detected",
        "rule": "alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:\"FILE-IDENTIFY XM file attachment detected\"; flow:to_client,established; content:\".xm\"; fast_pattern:only; content:\"Content-Disposition: attachment|3B|\"; content:\"filename=\"; nocase; pcre:\"/filename=[^\\n]*\\x2exm/i\"; flowbits:set,file.xm; flowbits:noalert; metadata:policy max-detect-ips alert, ruleset community, service imap, service pop3; classtype:misc-activity; sid:22044; rev:9;)"
    },
    {
        "description": "FILE-IDENTIFY XM file attachment detected",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"FILE-IDENTIFY XM file attachment detected\"; flow:to_server,established; content:\".xm\"; fast_pattern:only; content:\"Content-Disposition: attachment|3B|\"; content:\"filename=\"; nocase; pcre:\"/filename=[^\\n]*\\x2exm/i\"; flowbits:set,file.xm; flowbits:noalert; metadata:policy max-detect-ips alert, ruleset community, service smtp; classtype:misc-activity; sid:22045; rev:10;)"
    },
    {
        "description": "FILE-IDENTIFY XM file magic detected",
        "rule": "alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:\"FILE-IDENTIFY XM file magic detected\"; flow:to_client,established; file_data; content:\"Extended Module:\"; fast_pattern:only; flowbits:set,file.xm; flowbits:noalert; metadata:policy max-detect-ips alert, ruleset community, service ftp-data, service http, service imap, service pop3; classtype:misc-activity; sid:22046; rev:9;)"
    },
    {
        "description": "MALWARE-OTHER Alureon - Malicious IFRAME load attempt",
        "rule": "alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:\"MALWARE-OTHER Alureon - Malicious IFRAME load attempt\"; flow:to_client,established; file_data; content:\"name=|5C 22|Twitter|5C 22| scrolling=|5C 22|auto|5C 22| frameborder=|5C 22|no|5C 22| align=|5C 22|center|5C 22| height = |5C 22|1px|5C 22| width = |5C 22|1px|5C 22|>\"; fast_pattern:only; metadata:policy balanced-ips alert, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,attack.mitre.org/techniques/T1102; classtype:trojan-activity; sid:22061; rev:8;)"
    },
    {
        "description": "FILE-IDENTIFY JAR/ZIP file magic detected",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"FILE-IDENTIFY JAR/ZIP file magic detected\"; flow:to_server,established; file_data; content:\"PK|03 04|\"; depth:4; content:!\"|14 00 06 00|\"; within:4; flowbits:set,file.zip; flowbits:set,file.jar; flowbits:noalert; metadata:policy balanced-ips alert, policy connectivity-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service smtp; classtype:misc-activity; sid:23651; rev:15;)"
    },
    {
        "description": "FILE-IDENTIFY JAR/ZIP file magic detected",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"FILE-IDENTIFY JAR/ZIP file magic detected\"; flow:to_server,established; file_data; content:\"PK00PK|03 04|\"; depth:8; flowbits:set,file.zip; flowbits:set,file.jar; flowbits:noalert; metadata:policy balanced-ips alert, policy connectivity-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service smtp; classtype:misc-activity; sid:23652; rev:16;)"
    },
    {
        "description": "FILE-IDENTIFY JAR/ZIP file magic detected",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"FILE-IDENTIFY JAR/ZIP file magic detected\"; flow:to_server,established; file_data; content:\"PK|01 02|\"; depth:4; flowbits:set,file.zip; flowbits:set,file.jar; flowbits:noalert; metadata:policy balanced-ips alert, policy connectivity-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service smtp; classtype:misc-activity; sid:23653; rev:16;)"
    },
    {
        "description": "FILE-IDENTIFY JAR/ZIP file magic detected",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"FILE-IDENTIFY JAR/ZIP file magic detected\"; flow:to_server,established; file_data; content:\"PK|05 06|\"; depth:4; flowbits:set,file.zip; flowbits:set,file.jar; flowbits:noalert; metadata:policy balanced-ips alert, policy connectivity-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service smtp; classtype:misc-activity; sid:23654; rev:16;)"
    },
    {
        "description": "FILE-IDENTIFY JAR/ZIP file magic detected",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"FILE-IDENTIFY JAR/ZIP file magic detected\"; flow:to_server,established; file_data; content:\"PK|06 08|\"; depth:4; flowbits:set,file.zip; flowbits:set,file.jar; flowbits:noalert; metadata:policy balanced-ips alert, policy connectivity-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service smtp; classtype:misc-activity; sid:23655; rev:16;)"
    },
    {
        "description": "FILE-IDENTIFY JAR/ZIP file magic detected",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"FILE-IDENTIFY JAR/ZIP file magic detected\"; flow:to_server,established; file_data; content:\"PK|06 07|\"; depth:4; flowbits:set,file.zip; flowbits:set,file.jar; flowbits:noalert; metadata:policy balanced-ips alert, policy connectivity-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service smtp; classtype:misc-activity; sid:23656; rev:16;)"
    },
    {
        "description": "FILE-IDENTIFY JAR/ZIP file magic detected",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"FILE-IDENTIFY JAR/ZIP file magic detected\"; flow:to_server,established; file_data; content:\"PK|06 06|\"; depth:4; flowbits:set,file.zip; flowbits:set,file.jar; flowbits:noalert; metadata:policy balanced-ips alert, policy connectivity-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service smtp; classtype:misc-activity; sid:23657; rev:16;)"
    },
    {
        "description": "FILE-IDENTIFY PNG file magic detected",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"FILE-IDENTIFY PNG file magic detected\"; flow:to_server,established; file_data; content:\"|89|PNG|0D 0A 1A 0A|\"; depth:8; flowbits:set,file.png; flowbits:noalert; metadata:policy balanced-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service smtp; classtype:misc-activity; sid:23664; rev:17;)"
    },
    {
        "description": "FILE-IDENTIFY JPEG file magic detected",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"FILE-IDENTIFY JPEG file magic detected\"; flow:to_server,established; file_data; content:\"|FF D8 FF E0|\"; depth:4; flowbits:set,file.jpeg; flowbits:noalert; metadata:policy balanced-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service smtp; classtype:misc-activity; sid:23667; rev:14;)"
    },
    {
        "description": "FILE-IDENTIFY RTF file magic detected",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"FILE-IDENTIFY RTF file magic detected\"; flow:to_server,established; file_data; content:\"{|5C|rt\"; fast_pattern:only; flowbits:set,file.rtf; flowbits:noalert; metadata:policy balanced-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service smtp; classtype:misc-activity; sid:23670; rev:14;)"
    },
    {
        "description": "FILE-IDENTIFY PDF file magic detected",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"FILE-IDENTIFY PDF file magic detected\"; flow:to_server,established; file_data; content:\"%PDF-\"; nocase; flowbits:set,file.pdf; flowbits:noalert; metadata:policy balanced-ips alert, policy connectivity-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service smtp; classtype:misc-activity; sid:23678; rev:14;)"
    },
    {
        "description": "FILE-IDENTIFY Microsoft Compound File Binary v3 file magic detected",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"FILE-IDENTIFY Microsoft Compound File Binary v3 file magic detected\"; flow:to_server,established; file_data; content:\"|D0 CF 11 E0 A1 B1 1A E1|\"; content:\">|00 03 00|\"; within:4; distance:16; flowbits:set,file.ole; flowbits:noalert; metadata:policy balanced-ips alert, policy connectivity-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service smtp; classtype:misc-activity; sid:23707; rev:16;)"
    },
    {
        "description": "FILE-IDENTIFY Microsoft Compound File Binary v4 file magic detected",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"FILE-IDENTIFY Microsoft Compound File Binary v4 file magic detected\"; flow:to_server,established; file_data; content:\"|D0 CF 11 E0 A1 B1 1A E1|\"; content:\">|00 04 00|\"; within:4; distance:16; flowbits:set,file.oless.v4; flowbits:noalert; metadata:policy max-detect-ips alert, ruleset community, service smtp; classtype:misc-activity; sid:23708; rev:7;)"
    },
    {
        "description": "FILE-IDENTIFY OLE Document file magic detected",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"FILE-IDENTIFY OLE Document file magic detected\"; flow:to_server,established; file_data; content:\"|D0 CF 11 E0 A1 B1 1A E1|\"; depth:8; flowbits:set,file.ole; flowbits:set,file.fpx; flowbits:noalert; metadata:policy balanced-ips alert, policy connectivity-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service smtp; classtype:misc-activity; sid:23711; rev:14;)"
    },
    {
        "description": "FILE-IDENTIFY Portable Executable binary file magic detected",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"FILE-IDENTIFY Portable Executable binary file magic detected\"; flow:to_server,established; file_data; content:\"MZ\"; byte_jump:4,58,relative,little; content:\"PE|00 00|\"; within:4; distance:-64; flowbits:set,file.exe; flowbits:noalert; metadata:policy balanced-ips alert, policy connectivity-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service smtp; classtype:misc-activity; sid:23725; rev:12;)"
    },
    {
        "description": "FILE-IDENTIFY XML file magic detected",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"FILE-IDENTIFY XML file magic detected\"; flow:to_server,established; file_data; content:\"<xml>\"; depth:50; nocase; flowbits:set,file.xml; flowbits:noalert; metadata:policy max-detect-ips alert, policy security-ips alert, ruleset community, service smtp; classtype:misc-activity; sid:23758; rev:10;)"
    },
    {
        "description": "FILE-IDENTIFY XML file magic detected",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"FILE-IDENTIFY XML file magic detected\"; flow:to_server,established; file_data; content:\"<?xml\"; depth:50; nocase; flowbits:set,file.xml; flowbits:noalert; metadata:policy max-detect-ips alert, policy security-ips alert, ruleset community, service smtp; classtype:misc-activity; sid:23759; rev:10;)"
    },
    {
        "description": "FILE-IDENTIFY EMF file magic detected",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"FILE-IDENTIFY EMF file magic detected\"; flow:to_server,established; file_data; content:\"|01 00 00 00|\"; depth:4; content:\"|20|EMF\"; within:4; distance:36; fast_pattern; flowbits:set,file.emf; flowbits:noalert; metadata:policy max-detect-ips alert, ruleset community, service smtp; classtype:misc-activity; sid:23766; rev:12;)"
    },
    {
        "description": "FILE-IDENTIFY XM file magic detected",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"FILE-IDENTIFY XM file magic detected\"; flow:to_server,established; file_data; content:\"Extended Module:\"; fast_pattern:only; flowbits:set,file.xm; flowbits:noalert; metadata:policy max-detect-ips alert, ruleset community, service smtp; classtype:misc-activity; sid:23773; rev:9;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Magania variant outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"MALWARE-CNC Win.Trojan.Magania variant outbound connection\"; flow:to_server,established; content:\"User-Agent: Google page|0D 0A|\"; fast_pattern:only; content:\".asp?\"; content:\"mac=\"; within:4; content:\"&ver=\"; distance:0; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.seculert.com/blog/2013/06/adversary-arsenal-exposed-part-i-pinkstats.html; reference:url,www.virustotal.com/file/6a813f96bb65367a8b5c5ba2937c773785a0a0299032a6c77b9b0862be8bdb71/analysis/; classtype:trojan-activity; sid:24015; rev:8;)"
    },
    {
        "description": "MALWARE-OTHER Possible malicious redirect - rebots.php",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-OTHER Possible malicious redirect - rebots.php\"; flow:to_server,established; content:\"/rebots.php\"; fast_pattern:only; http_uri; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,blog.sucuri.net/2012/08/rebots-php-javascript-malware-being-actively-injected.html; reference:url,labs.sucuri.net/db/malware/mwjs-include-rebots; classtype:misc-activity; sid:24017; rev:5;)"
    },
    {
        "description": "MALWARE-OTHER malicious redirection attempt",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-OTHER malicious redirection attempt\"; flow:to_server,established; content:\"a=YWZmaWQ9MDUyODg\"; fast_pattern:only; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,blog.sucuri.net/2012/09/compromised-websites-hosting-calls-to-java-exploit.html; classtype:bad-unknown; sid:24225; rev:3;)"
    },
    {
        "description": "MALWARE-OTHER Malicious UA detected on non-standard port",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET 84 (msg:\"MALWARE-OTHER Malicious UA detected on non-standard port\"; flow:to_server,established,no_stream; content:\"User-Agent|3A| Mozilla/5.0 |28|Windows|3B| U|3B| MSIE 9.0|3B| Windows NT 9.0|3B| en-US|29|\"; detection_filter:track by_src, count 1, seconds 120; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community; reference:url,anubis.iseclab.org/?action=result&task_id=1691c3b8835221fa4692960681f39c736&format=html; classtype:trojan-activity; sid:24265; rev:6;)"
    },
    {
        "description": "OS-WINDOWS Microsoft Windows SMB NTLM NULL session attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:\"OS-WINDOWS Microsoft Windows SMB NTLM NULL session attempt\"; flow:to_server,established; content:\"|FF|SMB|73 00 00 00 00|\"; depth:9; offset:4; content:\"|00 00|\"; within:2; distance:13; content:\"|FF|\"; within:1; distance:9; content:\"NTLMSSP|00 03 00 00 00|\"; within:100; content:\"|00 00 00 00 48 00 00 00|\"; within:8; distance:24; fast_pattern; flowbits:set,smb.null_session; flowbits:noalert; metadata:policy max-detect-ips alert, policy security-ips alert, ruleset community, service netbios-ssn; reference:bugtraq,1163; reference:cve,2000-0347; classtype:attempted-recon; sid:24359; rev:9;)"
    },
    {
        "description": "FILE-IDENTIFY JPEG file magic detected",
        "rule": "alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:\"FILE-IDENTIFY JPEG file magic detected\"; flow:to_client,established; file_data; content:\"|FF D8 FF E1|\"; depth:4; flowbits:set,file.jpeg; flowbits:noalert; metadata:policy balanced-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service ftp-data, service http, service imap, service pop3; classtype:misc-activity; sid:24455; rev:12;)"
    },
    {
        "description": "FILE-IDENTIFY JPEG file magic detected",
        "rule": "alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:\"FILE-IDENTIFY JPEG file magic detected\"; flow:to_client,established; file_data; content:\"|FF D8 FF EE|\"; depth:4; flowbits:set,file.jpeg; flowbits:noalert; metadata:policy balanced-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service ftp-data, service http, service imap, service pop3; classtype:misc-activity; sid:24456; rev:12;)"
    },
    {
        "description": "FILE-IDENTIFY JPEG file magic detected",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"FILE-IDENTIFY JPEG file magic detected\"; flow:to_server,established; file_data; content:\"|FF D8 FF E1|\"; depth:4; flowbits:set,file.jpeg; flowbits:noalert; metadata:policy balanced-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service smtp; classtype:misc-activity; sid:24457; rev:11;)"
    },
    {
        "description": "FILE-IDENTIFY JPEG file magic detected",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"FILE-IDENTIFY JPEG file magic detected\"; flow:to_server,established; file_data; content:\"|FF D8 FF EE|\"; depth:4; flowbits:set,file.jpeg; flowbits:noalert; metadata:policy balanced-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service smtp; classtype:misc-activity; sid:24458; rev:11;)"
    },
    {
        "description": "NETBIOS SMB Trans2 FIND_FIRST2 find file and directory info request",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:\"NETBIOS SMB Trans2 FIND_FIRST2 find file and directory info request\"; flow:to_server,established; content:\"|FF|SMB2|00 00 00 00|\"; depth:9; offset:4; byte_test:1,!&,0x80,0,relative; content:\"|01 00|\"; within:2; distance:52; byte_jump:2,-10,relative,little,from_beginning,post_offset 10; content:\"|04 01|\"; within:2; flowbits:set,smb.trans2.fileinfo; flowbits:noalert; metadata:policy max-detect-ips alert, ruleset community, service netbios-ssn; classtype:protocol-command-decode; sid:24972; rev:6;)"
    },
    {
        "description": "MALWARE-OTHER Request for a non-legit postal receipt",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-OTHER Request for a non-legit postal receipt\"; flow:to_server,established; content:\".php?php=receipt\"; fast_pattern:only; http_uri; pcre:\"/\\x2f[a-z0-9]+\\.php\\?php\\x3dreceipt$/Ui\"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,urlquery.net/search.php?q=.php%3Fphp%3Dreceipt&type=string; classtype:misc-activity; sid:25277; rev:3;)"
    },
    {
        "description": "FILE-IDENTIFY Portable Executable download detected",
        "rule": "alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:\"FILE-IDENTIFY Portable Executable download detected\"; flow:to_client,established; content:\"application/octet-stream\"; fast_pattern:only; http_header; pcre:\"/^Content-Type\\x3a[\\x20\\x09]+application\\/octet-stream/smiH\"; file_data; content:\"MZ\"; within:2; flowbits:set,file.exe; flowbits:noalert; metadata:policy max-detect-ips alert, ruleset community, service ftp-data, service http, service imap, service pop3; classtype:misc-activity; sid:25513; rev:12;)"
    },
    {
        "description": "FILE-IDENTIFY Portable Executable download detected",
        "rule": "alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:\"FILE-IDENTIFY Portable Executable download detected\"; flow:to_client,established; content:\"application/x-msdos-program\"; fast_pattern:only; http_header; pcre:\"/^Content-Type\\x3a[\\x20\\x09]+application\\/x-msdos-program/smiH\"; file_data; content:\"MZ\"; within:2; flowbits:set,file.exe; flowbits:noalert; metadata:policy max-detect-ips alert, ruleset community, service ftp-data, service http, service imap, service pop3; classtype:misc-activity; sid:25514; rev:12;)"
    },
    {
        "description": "FILE-IDENTIFY Portable Executable binary file magic detected",
        "rule": "alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:\"FILE-IDENTIFY Portable Executable binary file magic detected\"; flow:to_client,established; file_data; content:\"MZ\"; byte_jump:4,58,relative,little; content:\"PE|00 00|\"; within:4; distance:-64; flowbits:set,file.exe; flowbits:noalert; metadata:policy max-detect-ips alert, ruleset community, service ftp-data, service http, service imap, service pop3; classtype:misc-activity; sid:25515; rev:11;)"
    },
    {
        "description": "MALWARE-OTHER Fake postal receipt HTTP Response phishing attack",
        "rule": "alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:\"MALWARE-OTHER Fake postal receipt HTTP Response phishing attack\"; flow:to_client,established; content:\"|3B 20|filename=PostalReceipt.zip|0D 0A|\"; fast_pattern:only; http_header; file_data; content:\"PostalReceipt.exe\"; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,attack.mitre.org/techniques/T1192; reference:url,www.urlquery.net/search.php?q=receipt&type=string&start=2013-01-03&end=2013-01-18&max=50; classtype:trojan-activity; sid:25578; rev:4;)"
    },
    {
        "description": "MALWARE-OTHER Fake bookinginfo HTTP Response phishing attack",
        "rule": "alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:\"MALWARE-OTHER Fake bookinginfo HTTP Response phishing attack\"; flow:to_client,established; content:\"|3B 20|filename=BookingInfo.zip|0D 0A|\"; fast_pattern:only; http_header; file_data; content:\"BookingInfo.exe\"; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,attack.mitre.org/techniques/T1192; reference:url,www.urlquery.net/search.php?q=receipt&type=string&start=2013-01-03&end=2013-01-18&max=50; classtype:trojan-activity; sid:25579; rev:4;)"
    },
    {
        "description": "MALWARE-OTHER Fake bookingdetails HTTP Response phishing attack",
        "rule": "alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:\"MALWARE-OTHER Fake bookingdetails HTTP Response phishing attack\"; flow:to_client,established; content:\"|3B 20|filename=BookingDetails.zip|0D 0A|\"; fast_pattern:only; http_header; file_data; content:\"BookingDetails.exe\"; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,attack.mitre.org/techniques/T1192; reference:url,www.urlquery.net/search.php?q=receipt&type=string&start=2013-01-03&end=2013-01-18&max=50; classtype:trojan-activity; sid:25580; rev:4;)"
    },
    {
        "description": "EXPLOIT-KIT redirection to driveby download",
        "rule": "alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:\"EXPLOIT-KIT redirection to driveby download\"; flow:to_client,established; file_data; content:\"/Home/index.php|22| width=1 height=1 scrolling=no></iframe>\"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; classtype:trojan-activity; sid:25948; rev:4;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Zebrocy outbound data connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.Zebrocy outbound data connection\"; flow:to_server,established; content:\"POST\"; http_method; content:\".php\"; http_uri; content:\"User|2D|Agent|3A 20|Mozilla|2F|3.0|20 28|compatible|3B 20|Indy Library|29 0D 0A|\"; http_header; content:\"form-data|3B| name=|22|userfile|22 3B| filename=\"; fast_pattern:only; http_client_body; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/#/file/979c14f993a1cd91f1b890f93a59ab5b14e059e056b9cf069222f529e50a4d5f/; reference:url,www.virustotal.com/#/file/ac9aea57da03206b1df12b5c012537c899bf5d67a5eb8113b4a4d99e0a0eb893/; reference:url,www.virustotal.com/en/file/04edf40eaf652dfab4e8dc2ca21fbf2e99d361746995767071789cc3fa24d2cc/analysis/1361822708/; classtype:trojan-activity; sid:25949; rev:3;)"
    },
    {
        "description": "EXPLOIT-KIT Sibhost exploit kit",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"EXPLOIT-KIT Sibhost exploit kit\"; flow:to_server,established; content:\"yoO4TAbn2tpl5DltCfASJIZ2spEJPLSn\"; fast_pattern:only; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.malwaresigs.com/2013/02/26/sport-cd-am-sibhost; classtype:trojan-activity; sid:26020; rev:4;)"
    },
    {
        "description": "FILE-IDENTIFY ZIP file download detected",
        "rule": "alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:\"FILE-IDENTIFY ZIP file download detected\"; flow:to_client,established; file_data; content:\"PK|03 04 14 00 06 00|\"; depth:8; flowbits:set,file.zip; flowbits:noalert; metadata:policy balanced-ips alert, policy connectivity-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service ftp-data, service http, service imap, service pop3; classtype:misc-activity; sid:26057; rev:13;)"
    },
    {
        "description": "FILE-IDENTIFY ZIP file attachment detected",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"FILE-IDENTIFY ZIP file attachment detected\"; flow:to_server,established; file_data; content:\"PK|03 04 14 00 06 00|\"; depth:8; flowbits:set,file.zip; flowbits:noalert; metadata:policy balanced-ips alert, policy connectivity-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service smtp; classtype:misc-activity; sid:26058; rev:12;)"
    },
    {
        "description": "FILE-IDENTIFY JPEG file magic detected",
        "rule": "alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:\"FILE-IDENTIFY JPEG file magic detected\"; flow:to_client,established; file_data; content:\"|00 10|JFIF\"; flowbits:set,file.jpeg; flowbits:noalert; metadata:policy balanced-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service ftp-data, service http, service imap, service pop3; classtype:misc-activity; sid:26251; rev:12;)"
    },
    {
        "description": "MALWARE-OTHER Fake postal receipt HTTP Response phishing attack",
        "rule": "alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:\"MALWARE-OTHER Fake postal receipt HTTP Response phishing attack\"; flow:to_client,established; content:\"|3B 20|filename=Postal-Receipt.zip|0D 0A|\"; fast_pattern:only; http_header; file_data; content:\"Postal-Receipt.exe\"; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,attack.mitre.org/techniques/T1192; reference:url,www.urlquery.net/search.php?q=receipt&type=string&start=2013-01-03&end=2013-01-18&max=50; classtype:trojan-activity; sid:26261; rev:3;)"
    },
    {
        "description": "MALWARE-CNC Dapato banking Trojan variant outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Dapato banking Trojan variant outbound connection\"; flow:to_server,established; urilen:21; content:\"/pics/_vti_cnf/00.inf\"; fast_pattern:only; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/en/file/ebcff32473d032041bd69e9599fbff4ad295128003f76d1f452ba7cb6e2d20d4/analysis/1364314446/; classtype:trojan-activity; sid:26264; rev:6;)"
    },
    {
        "description": "SERVER-WEBAPP DD-WRT httpd cgi-bin remote command execution attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-WEBAPP DD-WRT httpd cgi-bin remote command execution attempt\"; flow:to_server,established; content:\"/cgi-bin/\"; depth:10; nocase; http_uri; content:\"${IFS}\"; fast_pattern:only; http_uri; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:bugtraq,35742; reference:bugtraq,94819; reference:cve,2009-2765; reference:cve,2016-6277; classtype:attempted-admin; sid:26275; rev:5;)"
    },
    {
        "description": "MALWARE-OTHER Win.Trojan.Zeus Spam 2013 dated zip/exe HTTP Response - potential malware download",
        "rule": "alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:\"MALWARE-OTHER Win.Trojan.Zeus Spam 2013 dated zip/exe HTTP Response - potential malware download\"; flow:to_client,established; content:\"-2013.zip|0D 0A|\"; fast_pattern:only; content:\"-2013.zip|0D 0A|\"; http_header; content:\"-\"; within:1; distance:-14; http_header; file_data; content:\"-2013.exe\"; content:\"-\"; within:1; distance:-14; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/en/file/2eff3ee6ac7f5bf85e4ebcbe51974d0708cef666581ef1385c628233614b22c0/analysis/; classtype:trojan-activity; sid:26470; rev:2;)"
    },
    {
        "description": "EXPLOIT-KIT Portable Executable downloaded with bad DOS stub",
        "rule": "alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:\"EXPLOIT-KIT Portable Executable downloaded with bad DOS stub\"; flow:to_client,established; file_data; content:\"MZ\"; depth:2; content:\"|2F 2A 14 20|\"; distance:0; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ftp-data, service http, service imap, service pop3; reference:cve,2013-2423; reference:url,www.invincea.com/2013/04/k-i-a-java-cve-2013-2423-via-new-and-improved-cool-ek/; classtype:trojan-activity; sid:26526; rev:6;)"
    },
    {
        "description": "EXPLOIT-KIT Stamp exploit kit portable executable download",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"EXPLOIT-KIT Stamp exploit kit portable executable download\"; flow:to_server,established; content:\"/elections.php?\"; fast_pattern:only; http_uri; content:\" Java/1.\"; http_header; pcre:\"/\\/elections\\.php\\?([a-z0-9]+\\x3d\\d{1,3}\\&){9}[a-z0-9]+\\x3d\\d{1,3}$/U\"; flowbits:set,file.exploit_kit.pe; metadata:ruleset community, service http; reference:cve,2013-0431; classtype:trojan-activity; sid:26534; rev:7;)"
    },
    {
        "description": "MALWARE-BACKDOOR Win.Backdoor.PCRat data upload",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"MALWARE-BACKDOOR Win.Backdoor.PCRat data upload\"; flow:to_server,established; content:\"PCRatd\"; depth:6; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/en/file/669DF9DED24D56997D7B1EA6249BB704226DADA09230DC285AE66CA0C9B7247B/analysis/; classtype:misc-activity; sid:26655; rev:2;)"
    },
    {
        "description": "MALWARE-OTHER Fake delivery information phishing attack",
        "rule": "alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:\"MALWARE-OTHER Fake delivery information phishing attack\"; flow:to_client,established; content:\"|3B| filename=\"; http_header; content:\"Delivery_Information_ID-\"; fast_pattern:only; http_header; file_data; content:\"Delivery_Information_ID-\"; content:\".exe\"; within:50; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,attack.mitre.org/techniques/T1192; classtype:trojan-activity; sid:26660; rev:3;)"
    },
    {
        "description": "MALWARE-OTHER Compromised Website response - leads to Exploit Kit",
        "rule": "alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:\"MALWARE-OTHER Compromised Website response - leads to Exploit Kit\"; flow:to_client,established; file_data; content:\"<!--ded509-->\"; content:\"<!--/ded509-->\"; distance:0; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.jsunpack.jeek.org/?report=c94ca7cda909cf93ae95db22a27bb5d711c2ae8f; classtype:trojan-activity; sid:26698; rev:2;)"
    },
    {
        "description": "EXPLOIT-KIT Sweet Orange exploit kit landing page in.php base64 uri",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"EXPLOIT-KIT Sweet Orange exploit kit landing page in.php base64 uri\"; flow:to_server,established; urilen:<75; content:\"/in.php\"; http_uri; content:\"&q=\"; distance:0; http_uri; content:\"==\"; distance:0; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2010-0188; reference:cve,2012-0422; reference:cve,2012-0431; reference:cve,2012-0607; reference:cve,2012-1723; reference:cve,2012-4681; reference:cve,2012-5076; reference:cve,2013-2423; classtype:trojan-activity; sid:26834; rev:5;)"
    },
    {
        "description": "MALWARE-BACKDOOR Win.Backdoor.Boda Malware Checkin",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-BACKDOOR Win.Backdoor.Boda Malware Checkin\"; flow:to_server,established; content:\"macName=\"; depth:60; http_client_body; content:\"&macOS=\"; within:100; http_client_body; content:\"&macMac=\"; within:200; http_client_body; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; classtype:trojan-activity; sid:26842; rev:2;)"
    },
    {
        "description": "EXPLOIT-KIT DotkaChef/Rmayana/DotCache exploit kit landing page",
        "rule": "alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:\"EXPLOIT-KIT DotkaChef/Rmayana/DotCache exploit kit landing page\"; flow:to_client,established; file_data; content:\"<applet width=\"; content:\"0\"; within:1; distance:1; content:\" height=\"; within:8; distance:1; content:\"0\"; within:1; distance:1; content:\" code=\"; within:6; distance:1; content:\"site.avi\"; within:8; distance:1; nocase; content:\" archive=\"; within:9; distance:1; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.basemont.com/new_exploit_kit_june_2013; classtype:trojan-activity; sid:26949; rev:4;)"
    },
    {
        "description": "EXPLOIT-KIT DotkaChef/Rmayana/DotCache exploit kit Malvertising Campaign URI request",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"EXPLOIT-KIT DotkaChef/Rmayana/DotCache exploit kit Malvertising Campaign URI request\"; flow:to_server,established; content:\"/.cache/?f=\"; fast_pattern; http_uri; content:\".jar\"; http_uri; pcre:\"/[^&]+&[a-z]=[a-f0-9]{16}&[a-z]=[a-f0-9]{16}$/U\"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,research.zscaler.com/2013/06/openxadvertisingcom-mass-malvertising.html; classtype:trojan-activity; sid:26951; rev:5;)"
    },
    {
        "description": "EXPLOIT-KIT Rawin exploit kit outbound java retrieval",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"EXPLOIT-KIT Rawin exploit kit outbound java retrieval\"; flow:to_server,established; content:\"rawin.php?b=\"; http_uri; content:\"&v=1.\"; distance:0; http_uri; pcre:\"/\\.php\\?b=[A-F0-9]+&v=1\\./U\"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; classtype:trojan-activity; sid:26985; rev:3;)"
    },
    {
        "description": "EXPLOIT-KIT Styx exploit kit plugin detection connection jorg",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"EXPLOIT-KIT Styx exploit kit plugin detection connection jorg\"; flow:to_server,established; content:\"/jorg.html\"; fast_pattern:only; http_uri; pcre:\"/\\/jorg\\.html$/U\"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2007-5659; reference:cve,2008-0655; reference:cve,2011-3544; reference:cve,2012-0507; reference:cve,2012-1723; reference:cve,2012-4681; reference:cve,2012-4969; reference:cve,2013-0422; reference:cve,2013-2423; classtype:trojan-activity; sid:27040; rev:4;)"
    },
    {
        "description": "EXPLOIT-KIT Styx exploit kit plugin detection connection jlnp",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"EXPLOIT-KIT Styx exploit kit plugin detection connection jlnp\"; flow:to_server,established; content:\"/jlnp.html\"; fast_pattern:only; http_uri; pcre:\"/\\/jlnp\\.html$/U\"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2007-5659; reference:cve,2008-0655; reference:cve,2011-3544; reference:cve,2012-0507; reference:cve,2012-1723; reference:cve,2012-4681; reference:cve,2012-4969; reference:cve,2013-0422; reference:cve,2013-2423; classtype:trojan-activity; sid:27041; rev:4;)"
    },
    {
        "description": "EXPLOIT-KIT Styx exploit kit plugin detection connection jovf",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"EXPLOIT-KIT Styx exploit kit plugin detection connection jovf\"; flow:to_server,established; content:\"/jovf.html\"; fast_pattern:only; http_uri; pcre:\"/\\/jovf\\.html$/U\"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2007-5659; reference:cve,2008-0655; reference:cve,2011-3544; reference:cve,2012-0507; reference:cve,2012-1723; reference:cve,2012-4681; reference:cve,2012-4969; reference:cve,2013-0422; reference:cve,2013-2423; classtype:trojan-activity; sid:27042; rev:5;)"
    },
    {
        "description": "EXPLOIT-KIT Unknown Malvertising exploit kit Hostile Jar pipe.class",
        "rule": "alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:\"EXPLOIT-KIT Unknown Malvertising exploit kit Hostile Jar pipe.class\"; flow:to_client,established; flowbits:isset,file.jar; file_data; content:\"PK\"; content:\"|00|pipe.class\"; distance:0; content:\"|00|inc.class\"; distance:0; content:\"|00|fdp.class\"; distance:0; fast_pattern; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; classtype:trojan-activity; sid:27085; rev:3;)"
    },
    {
        "description": "EXPLOIT-KIT Unknown Malvertising exploit kit stage-1 redirect",
        "rule": "alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:\"EXPLOIT-KIT Unknown Malvertising exploit kit stage-1 redirect\"; flow:to_client,established; content:\"<html><body><script>|0A|var \"; fast_pattern; content:\"document.createElement(\"; within:80; content:\".setAttribute(|22|archive|22|, \"; within:65; content:\".setAttribute(|22|codebase|22|, \"; within:65; content:\".setAttribute(|22|id|22|, \"; within:65; content:\".setAttribute(|22|code|22|, \"; within:65; content:\"|22|)|3B 0A|document.body.appendChild(\"; within:65; content:\"</script>|0A|</body>|0A|</html>|0A 0A|\"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; classtype:trojan-activity; sid:27086; rev:3;)"
    },
    {
        "description": "EXPLOIT-KIT Blackholev2/Cool exploit kit outbound portable executable request",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"EXPLOIT-KIT Blackholev2/Cool exploit kit outbound portable executable request\"; flow:to_server,established; content:\"php?sf=\"; http_uri; content:\"&Ze=\"; distance:0; http_uri; content:\"&m=\"; distance:0; http_uri; pcre:\"/php\\?sf=\\d+\\&Ze=\\d+\\&m=\\d+/U\"; flowbits:set,file.exploit_kit.pe; metadata:policy balanced-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service http; classtype:trojan-activity; sid:27110; rev:7;)"
    },
    {
        "description": "EXPLOIT-KIT DotkaChef/Rmayana/DotCache exploit kit Zeroaccess download attempt",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"EXPLOIT-KIT DotkaChef/Rmayana/DotCache exploit kit Zeroaccess download attempt\"; flow:to_server,established; content:\"/?f=a\"; http_uri; content:\"&k=\"; distance:0; http_uri; pcre:\"/\\&k=\\d+($|\\&h=)/U\"; flowbits:set,file.exploit_kit.jar; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2013-1493; reference:cve,2013-2423; reference:url,www.basemont.com/new_exploit_kit_june_2013; reference:url,www.malwaresigs.com/2013/06/14/dotcachef/; classtype:trojan-activity; sid:27113; rev:5;)"
    },
    {
        "description": "EXPLOIT-KIT Private exploit kit outbound traffic",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"EXPLOIT-KIT Private exploit kit outbound traffic\"; flow:to_server,established; content:\".php?\"; http_uri; content:\"content-type: application/\"; http_header; content:\" Java/1\"; http_header; pcre:\"/\\x2ephp\\x3f[a-z]+=[a-fA-Z0-9]+&[a-z]+=[0-9]+$/iU\"; metadata:policy balanced-ips alert, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2006-0003; reference:cve,2010-0188; reference:cve,2011-3544; reference:cve,2013-1347; reference:cve,2013-1493; reference:cve,2013-2423; reference:url,malwageddon.blogspot.com/2013/07/unknown-ek-well-hey-hey-i-wanna-be.html; reference:url,malware.dontneedcoffee.com/2013/07/pep-new-bep.html; reference:url,www.malwaresigs.com/2013/07/03/another-unknown-ek; classtype:trojan-activity; sid:27144; rev:3;)"
    },
    {
        "description": "MALWARE-OTHER Mac OSX FBI ransomware",
        "rule": "alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:\"MALWARE-OTHER Mac OSX FBI ransomware\"; flow:to_client,established; file_data; content:\"<iframe src=|22|YOUR|25|20BROWSER|25|20HAS|25|20BEEN|25|20LOCKED\"; fast_pattern:only; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,blog.malwarebytes.org/intelligence/2013/07/fbi-ransomware-now-targeting-apples-mac-os-x-users/; classtype:trojan-activity; sid:27246; rev:2;)"
    },
    {
        "description": "MALWARE-OTHER HideMeBetter spam injection variant",
        "rule": "alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:\"MALWARE-OTHER HideMeBetter spam injection variant\"; flow:to_client,established; file_data; content:\"<div id=|22|HideMeBetter|22|>\"; fast_pattern:only; content:\"if(document|2E|getElementById(|22|HideMeBetter|22|)|20 21 3D 20|null)\"; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,blog.sucuri.net/2013/07/hidemebetter-spam-injection-variant.html; classtype:trojan-activity; sid:27565; rev:2;)"
    },
    {
        "description": "EXPLOIT-KIT Blackholev2/Darkleech exploit kit landing page request",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"EXPLOIT-KIT Blackholev2/Darkleech exploit kit landing page request\"; flow:to_server,established; urilen:>32; content:\".php\"; fast_pattern:only; http_uri; content:\"GET\"; http_method; pcre:\"/^\\/[a-f0-9]{32}\\/[a-z]{1,15}-[a-z]{1,15}\\.php/U\"; content:!\"PacketShaper\"; http_header; content:!\"siteadvisor.com\"; http_header; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2012-1889; reference:cve,2012-4681; classtype:trojan-activity; sid:27865; rev:7;)"
    },
    {
        "description": "EXPLOIT-KIT Blackholev2/Darkleech exploit kit landing page",
        "rule": "alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:\"EXPLOIT-KIT Blackholev2/Darkleech exploit kit landing page\"; flow:to_client,established; file_data; content:\"<body><b></b><style>div{overflow|3A|hidden|3B|width|3A|1px|3B|height|3A|1px}</style><div>\"; fast_pattern:only; flowbits:set,file.exploit_kit.jar; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; classtype:trojan-activity; sid:27866; rev:2;)"
    },
    {
        "description": "MALWARE-CNC Win.Backdoor.Chopper web shell connection",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Backdoor.Chopper web shell connection\"; flow:to_server,established; content:\"X-Forwarded-For\"; nocase; http_header; content:\"=Response\"; nocase; http_client_body; content:\"FromBase64String\"; nocase; http_client_body; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,attack.mitre.org/techniques/T1100; reference:url,informationonsecurity.blogspot.com/2012/11/china-chopper-webshell.html; reference:url,www.virustotal.com/en/file/BE24561427D754C0C150272CAB5017D5A2DA64D41BEC74416B8AE363FB07FD77/analysis/; classtype:trojan-activity; sid:27966; rev:7;)"
    },
    {
        "description": "MALWARE-CNC Win.Backdoor.Chopper web shell connection",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Backdoor.Chopper web shell connection\"; flow:to_server,established; content:\"X-Forwarded-For\"; nocase; http_header; content:\"caidao=\"; fast_pattern:only; http_client_body; pcre:\"/caidao\\s?=\\s?(Response|Write|Execute)/Pmi\"; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,attack.mitre.org/techniques/T1100; reference:url,informationonsecurity.blogspot.com/2012/11/china-chopper-webshell.html; reference:url,www.virustotal.com/en/file/BE24561427D754C0C150272CAB5017D5A2DA64D41BEC74416B8AE363FB07FD77/analysis/; classtype:trojan-activity; sid:27967; rev:6;)"
    },
    {
        "description": "MALWARE-CNC Win.Backdoor.Chopper web shell connection",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Backdoor.Chopper web shell connection\"; flow:to_server,established; content:\"X-Forwarded-For\"; nocase; http_header; content:\"=Execute\"; nocase; http_client_body; content:\"On+Error+Resume+Next:\"; fast_pattern:only; http_client_body; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,attack.mitre.org/techniques/T1100; reference:url,informationonsecurity.blogspot.com/2012/11/china-chopper-webshell.html; reference:url,www.virustotal.com/en/file/BE24561427D754C0C150272CAB5017D5A2DA64D41BEC74416B8AE363FB07FD77/analysis/; classtype:trojan-activity; sid:27968; rev:7;)"
    },
    {
        "description": "MALWARE-CNC Win.Backdoor.Chopper web shell connection",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Backdoor.Chopper web shell connection\"; flow:to_server,established; content:\"X-Forwarded-For\"; nocase; http_header; content:\"FromBase64String\"; http_client_body; content:\"z\"; within:200; nocase; http_client_body; pcre:\"/z\\d{1,3}/Pi\"; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,attack.mitre.org/techniques/T1100; reference:url,informationonsecurity.blogspot.com/2012/11/china-chopper-webshell.html; reference:url,www.virustotal.com/en/file/BE24561427D754C0C150272CAB5017D5A2DA64D41BEC74416B8AE363FB07FD77/analysis/; classtype:trojan-activity; sid:28323; rev:8;)"
    },
    {
        "description": "PUA-ADWARE FakeAV runtime detection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"PUA-ADWARE FakeAV runtime detection\"; flow:to_server,established; content:\"&affid=\"; fast_pattern:only; http_uri; content:\"/api/\"; nocase; http_uri; content:\"?ts=\"; nocase; http_uri; content:\"&token=\"; nocase; http_uri; content:\"&group=\"; nocase; http_uri; content:\"&nid=\"; nocase; http_uri; content:\"&lid=\"; nocase; http_uri; content:\"&ver=\"; nocase; http_uri; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; classtype:trojan-activity; sid:28324; rev:3;)"
    },
    {
        "description": "INDICATOR-OBFUSCATION Javascript obfuscation - split - seen in IFRAMEr Tool attack",
        "rule": "alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:\"INDICATOR-OBFUSCATION Javascript obfuscation - split - seen in IFRAMEr Tool attack\"; flow:to_client,established; file_data; content:\"ps=|22|split|22 3B|asd=function()\"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,attack.mitre.org/techniques/T1027; reference:url,attack.mitre.org/techniques/T1140; classtype:trojan-activity; sid:28345; rev:3;)"
    },
    {
        "description": "INDICATOR-OBFUSCATION Javascript obfuscation - seen in IFRAMEr Tool attack",
        "rule": "alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:\"INDICATOR-OBFUSCATION Javascript obfuscation - seen in IFRAMEr Tool attack\"; flow:to_client,established; file_data; content:\"aq=|22|0x|22 3B|ff=String|3B|\"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,attack.mitre.org/techniques/T1027; reference:url,attack.mitre.org/techniques/T1140; classtype:trojan-activity; sid:28346; rev:3;)"
    },
    {
        "description": "INDICATOR-OBFUSCATION Javascript obfuscation - createElement - seen in IFRAMEr Tool attack",
        "rule": "alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:\"INDICATOR-OBFUSCATION Javascript obfuscation - createElement - seen in IFRAMEr Tool attack\"; flow:to_client,established; file_data; content:\"|22|c|22|+|22|r|22 3A|2+|22|e|22|+|22|a|22|+|22|t|22|+|22|e|22|+|22|E|22|+|22|l|22|+|22|e|22|+|22|m|22|+((f)?|22|e|22|+|22|n|22|+|22|t|22 3A 22 22|\"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,attack.mitre.org/techniques/T1027; reference:url,attack.mitre.org/techniques/T1140; classtype:trojan-activity; sid:28420; rev:3;)"
    },
    {
        "description": "INDICATOR-OBFUSCATION Javascript obfuscation - fromCharCode - seen in IFRAMEr Tool attack",
        "rule": "alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:\"INDICATOR-OBFUSCATION Javascript obfuscation - fromCharCode - seen in IFRAMEr Tool attack\"; flow:to_client,established; file_data; content:\"|22|fr|22|+|22|omCh|22|+|22|arCo|22|+|22|de|22|\"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,attack.mitre.org/techniques/T1027; reference:url,attack.mitre.org/techniques/T1140; classtype:trojan-activity; sid:28421; rev:3;)"
    },
    {
        "description": "EXPLOIT-KIT Glazunov exploit kit landing page",
        "rule": "alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:\"EXPLOIT-KIT Glazunov exploit kit landing page\"; flow:to_client,established; file_data; content:\"= |22|applet|22 3B 20|\"; content:\"= |22|object|22 3B 20|\"; within:50; content:\"=|27|param|27 3B 20|\"; within:50; content:\".zip|27 3B| </script>\"; distance:0; pcre:\"/\\/\\d+\\/\\d\\.zip\\x27\\x3b/\"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2013-2471; reference:url,nakedsecurity.sophos.com/2013/07/02/the-four-seasons-of-glazunov-digging-further-into-sibhost-and-flimkit/; classtype:trojan-activity; sid:28428; rev:3;)"
    },
    {
        "description": "EXPLOIT-KIT Glazunov exploit kit outbound jnlp download attempt",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"EXPLOIT-KIT Glazunov exploit kit outbound jnlp download attempt\"; flow:to_server,established; urilen:15; content:\".jnlp\"; fast_pattern; http_uri; content:\" Java/1.\"; http_header; pcre:\"/\\/[a-z0-9]{9}\\.jnlp$/U\"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2013-2471; reference:url,nakedsecurity.sophos.com/2013/07/02/the-four-seasons-of-glazunov-digging-further-into-sibhost-and-flimkit/; classtype:trojan-activity; sid:28429; rev:3;)"
    },
    {
        "description": "EXPLOIT-KIT Glazunov exploit kit zip file download",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"EXPLOIT-KIT Glazunov exploit kit zip file download\"; flow:to_server,established; content:\".zip\"; fast_pattern; http_uri; content:\" Java/1.\"; http_header; pcre:\"/^\\/\\d+\\/\\d\\.zip$/U\"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2013-2471; reference:url,nakedsecurity.sophos.com/2013/07/02/the-four-seasons-of-glazunov-digging-further-into-sibhost-and-flimkit/; classtype:trojan-activity; sid:28430; rev:4;)"
    },
    {
        "description": "EXPLOIT-KIT Sakura exploit kit exploit payload retrieve attempt",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"EXPLOIT-KIT Sakura exploit kit exploit payload retrieve attempt\"; flow:to_server,established; urilen:<25; content:\".ld\"; fast_pattern:only; http_uri; content:\" Java/1.\"; http_header; pcre:\"/^\\/\\d+\\.ld$/U\"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; classtype:trojan-activity; sid:28450; rev:2;)"
    },
    {
        "description": "MALWARE-CNC DeputyDog diskless method outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC DeputyDog diskless method outbound connection\"; flow:to_server,established; content:\"User-Agent: lynx|0D 0A|\"; fast_pattern:only; http_header; content:\"POST\"; http_method; pcre:\"/^\\x2f[0-9a-f]+$/iU\"; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2013-3918; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-090; classtype:trojan-activity; sid:28493; rev:6;)"
    },
    {
        "description": "EXPLOIT-KIT Nuclear exploit kit payload request",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"EXPLOIT-KIT Nuclear exploit kit payload request\"; flow:to_server,established; urilen:24<>26,norm; content:\"/f/\"; fast_pattern:only; http_uri; pcre:\"/^\\/f\\/1\\d{9}\\/\\d{9,10}(\\/\\d)+$/U\"; flowbits:set,file.exploit_kit.pe; metadata:ruleset community, service http; classtype:trojan-activity; sid:28596; rev:4;)"
    },
    {
        "description": "EXPLOIT-KIT Goon/Infinity exploit kit payload download attempt",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"EXPLOIT-KIT Goon/Infinity exploit kit payload download attempt\"; flow:to_server,established; urilen:<30; content:\".mp3\"; fast_pattern:only; http_uri; content:\" Java/1.\"; http_header; pcre:\"/\\/\\d+\\.mp3$/U\"; flowbits:set,file.exploit_kit.pe; metadata:policy max-detect-ips alert, ruleset community, service http; reference:cve,2012-0507; reference:url,blog.talosintel.com/2013/11/im-calling-this-goon-exploit-kit-for-now.html; classtype:trojan-activity; sid:28795; rev:7;)"
    },
    {
        "description": "MALWARE-CNC Win.Backdoor.Iniduoh variant outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Backdoor.Iniduoh variant outbound connection\"; flow:to_server,established; content:\"/is-ready\"; fast_pattern:only; http_uri; content:\"User|2D|Agent|3A 20|\"; http_header; content:\"|3C 7C 3E|\"; within:3; distance:8; http_header; content:\"|3C 7C 3E|\"; within:18; http_header; content:\"|3C 7C 3E|Microsoft Windows\"; within:84; http_header; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/en/file/220b551d9381fb56b48511b622a0bbc15482378396b3e83f708379f460f3347a/analysis/; reference:url,www.virustotal.com/en/file/be442a5f8be3bf720236f71a613a534b8aa82b16b0daf8ff84a59bcb92e19e7d/analysis/; classtype:trojan-activity; sid:28817; rev:4;)"
    },
    {
        "description": "EXPLOIT-KIT HiMan exploit kit outbound payload retreival - specific string",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"EXPLOIT-KIT HiMan exploit kit outbound payload retreival - specific string\"; flow:to_server,established; content:\"/tx.exe\"; fast_pattern:only; http_uri; flowbits:set,file.exploit_kit.pe; metadata:ruleset community, service http; classtype:trojan-activity; sid:28969; rev:4;)"
    },
    {
        "description": "EXPLOIT-KIT CritX exploit kit payload download attempt",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"EXPLOIT-KIT CritX exploit kit payload download attempt\"; flow:to_server,established; content:\"/loadmsie.php?id=\"; fast_pattern:only; http_uri; flowbits:set,file.exploit_kit.pe; metadata:ruleset community, service http; classtype:trojan-activity; sid:29166; rev:6;)"
    },
    {
        "description": "EXPLOIT-KIT CritX exploit kit payload download attempt",
        "rule": "alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:\"EXPLOIT-KIT CritX exploit kit payload download attempt\"; flow:to_client,established; content:\".exe|0D 0A|\"; fast_pattern:only; http_header; content:\"filename=\"; http_header; content:\".exe|0D 0A|\"; within:6; distance:24; http_header; pcre:\"/filename=(?![a-f]{24}|\\d{24})[a-f\\d]{24}\\.exe\\r\\n/H\"; flowbits:set,file.exploit_kit.pe; metadata:ruleset community, service http; classtype:trojan-activity; sid:29167; rev:6;)"
    },
    {
        "description": "EXPLOIT-KIT Magnitude exploit kit Microsoft Internet Explorer Payload request",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"EXPLOIT-KIT Magnitude exploit kit Microsoft Internet Explorer Payload request\"; flow:to_server,established; urilen:34; content:\"/?\"; depth:2; fast_pattern; http_uri; pcre:\"/^\\/\\?[a-f0-9]{32}$/U\"; content:\" MSIE \"; http_header; content:!\"Referer|3A|\"; http_header; flowbits:set,file.exploit_kit.pe; metadata:ruleset community, service http; classtype:trojan-activity; sid:29189; rev:5;)"
    },
    {
        "description": "FILE-IDENTIFY Adobe AIR file download request",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"FILE-IDENTIFY Adobe AIR file download request\"; flow:to_server,established; content:\".air\"; fast_pattern:only; http_uri; pcre:\"/\\x2eair([\\?\\x5c\\x2f]|$)/smiU\"; flowbits:set,file.zip; flowbits:noalert; metadata:policy balanced-ips alert, policy connectivity-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service http; classtype:misc-activity; sid:29384; rev:14;)"
    },
    {
        "description": "FILE-IDENTIFY Adobe AIR file attachment detected",
        "rule": "alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:\"FILE-IDENTIFY Adobe AIR file attachment detected\"; flow:to_client,established; content:\".air\"; fast_pattern:only; content:\"Content-Disposition: attachment|3B|\"; content:\"filename=\"; nocase; pcre:\"/filename=[^\\n]*\\x2eair/i\"; flowbits:set,file.zip; flowbits:noalert; metadata:policy balanced-ips alert, policy connectivity-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service imap, service pop3; classtype:misc-activity; sid:29385; rev:15;)"
    },
    {
        "description": "FILE-IDENTIFY Adobe AIR file attachment detected",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:\"FILE-IDENTIFY Adobe AIR file attachment detected\"; flow:to_server,established; content:\".air\"; fast_pattern:only; content:\"Content-Disposition: attachment|3B|\"; content:\"filename=\"; nocase; pcre:\"/filename=[^\\n]*\\x2eair/i\"; flowbits:set,file.zip; flowbits:noalert; metadata:policy balanced-ips alert, policy connectivity-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service smtp; classtype:misc-activity; sid:29386; rev:15;)"
    },
    {
        "description": "SERVER-WEBAPP HNAP remote code execution attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-WEBAPP HNAP remote code execution attempt\"; flow:established,to_server; urilen:6; content:\"/HNAP1\"; fast_pattern:only; http_uri; content:\"Authorization: Basic YWRtaW46\"; http_header; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,isc.sans.edu/diary/Linksys+Worm+%22TheMoon%22+Summary%3A+What+we+know+so+far/17633; classtype:attempted-admin; sid:29829; rev:2;)"
    },
    {
        "description": "SERVER-WEBAPP Linksys E-series HNAP TheMoon remote code execution attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-WEBAPP Linksys E-series HNAP TheMoon remote code execution attempt\"; flow:established,to_server; content:\"/tmUnblock.cgi\"; fast_pattern:only; http_uri; content:\"ttcp_ip\"; http_client_body; pcre:\"/ttcp_ip=.*?([\\x60\\x3b\\x7c]|[\\x3c\\x3e\\x24]\\x28|%60|%3b|%7c|%26|%3c%28|%3e%28|%24%28)/Pim\"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,isc.sans.edu/diary/Linksys+Worm+%28%22TheMoon%22%29+Captured/17630; classtype:attempted-admin; sid:29831; rev:3;)"
    },
    {
        "description": "EXPLOIT-KIT Redkit exploit kit payload request",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"EXPLOIT-KIT Redkit exploit kit payload request\"; flow:to_server,established; content:\"/download.asp?p=\"; nocase; http_uri; content:\" Java/1.\"; fast_pattern:only; http_header; pcre:\"/\\/download\\.asp\\?p\\=\\d$/Ui\"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.invincea.com/2014/02/ekia-citadel-a-k-a-the-malware-the-popped-fazio-mechanical/; classtype:trojan-activity; sid:29864; rev:2;)"
    },
    {
        "description": "EXPLOIT-KIT Hello/LightsOut exploit kit payload download attempt",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"EXPLOIT-KIT Hello/LightsOut exploit kit payload download attempt\"; flow:to_server,established; content:\".php?a=dw\"; fast_pattern:only; http_uri; pcre:\"/\\?a=dw[a-z]$/U\"; content:\" Java/1.\"; http_header; flowbits:set,file.exploit_kit.pe; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2011-1255; reference:cve,2012-1723; reference:cve,2013-1489; reference:url,attack.mitre.org/techniques/T1189; reference:url,blogs.cisco.com/security/watering-hole-attacks-target-energy-sector/; reference:url,jsunpack.jeek.org/?report=2a298ffa14fd2772bd646bd559f610b0c3b51862; reference:url,jsunpack.jeek.org/?report=977b49ea5dc5ef85d8f50d1f1222befee8bf3581; classtype:trojan-activity; sid:30003; rev:6;)"
    },
    {
        "description": "MALWARE-OTHER ANDR.Trojan.iBanking outbound connection attempt",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-OTHER ANDR.Trojan.iBanking outbound connection attempt\"; flow:to_server,established; urilen:21; content:\"/android/sms/sync.php\"; fast_pattern:only; http_uri; content:\"User-Agent|3A 20|Apache-HttpClient|2F|\"; http_header; content:\"bot_id=\"; http_client_body; content:\"&imei=\"; distance:0; http_client_body; content:\"&iscallhack=\"; distance:0; http_client_body; content:\"&issmshack=\"; distance:0; http_client_body; content:\"&isrecordhack=\"; distance:0; http_client_body; content:\"&isadmin=\"; distance:0; http_client_body; content:\"&control_number=\"; distance:0; http_client_body; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.kernelmode.info/forum/viewtopic.php?f=16&t=3166; reference:url,www.virustotal.com/en/file/38f6fccfc8a31306c0a03cad6908c148e8506fd70ce03165fd89e18113b68e02/analysis/; classtype:trojan-activity; sid:30070; rev:2;)"
    },
    {
        "description": "MALWARE-OTHER ANDR.Trojan.iBanking outbound connection attempt",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-OTHER ANDR.Trojan.iBanking outbound connection attempt\"; flow:to_server,established; urilen:21; content:\"POST\"; http_method; content:\"/android/sms/ping.php\"; fast_pattern:only; http_uri; content:\"User-Agent|3A 20|Apache-HttpClient|2F|\"; http_header; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.kernelmode.info/forum/viewtopic.php?f=16&t=3166; reference:url,www.virustotal.com/en/file/38f6fccfc8a31306c0a03cad6908c148e8506fd70ce03165fd89e18113b68e02/analysis/; classtype:trojan-activity; sid:30071; rev:2;)"
    },
    {
        "description": "MALWARE-OTHER ANDR.Trojan.iBanking outbound connection attempt",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-OTHER ANDR.Trojan.iBanking outbound connection attempt\"; flow:to_server,established; urilen:22; content:\"/android/sms/index.php\"; fast_pattern:only; http_uri; content:\"User-Agent|3A 20|Apache-HttpClient|2F|\"; http_header; content:\"bot_id=\"; http_client_body; content:\"&number=&iccid=&model=\"; distance:0; http_client_body; content:\"&imei=\"; distance:0; http_client_body; content:\"&os=\"; distance:0; http_client_body; content:\"&control_number=\"; distance:0; http_client_body; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.kernelmode.info/forum/viewtopic.php?f=16&t=3166; reference:url,www.virustotal.com/en/file/38f6fccfc8a31306c0a03cad6908c148e8506fd70ce03165fd89e18113b68e02/analysis/; classtype:trojan-activity; sid:30072; rev:2;)"
    },
    {
        "description": "EXPLOIT-KIT Nuclear exploit kit outbound payload request",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"EXPLOIT-KIT Nuclear exploit kit outbound payload request\"; flow:to_server,established; content:\"/f/\"; depth:3; http_uri; pcre:\"/^\\/f(?:\\/\\d)?\\/1[34]\\d{8}(?:\\/\\d{9,10})?(?:\\/\\d)+[^a-zA-Z]{1,6}$/U\"; flowbits:set,file.exploit_kit.pe; metadata:ruleset community, service http; classtype:trojan-activity; sid:30220; rev:6;)"
    },
    {
        "description": "PUA-ADWARE Lucky Leap Adware outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"PUA-ADWARE Lucky Leap Adware outbound connection\"; flow:to_server,established; content:\"/gcs?alpha=\"; fast_pattern:only; http_uri; content:\"|0D 0A|Cache-Control: no-store,no-cache|0D 0A|Pragma: no-cache|0D 0A|Connection: Keep-Alive|0D 0A 0D 0A|\"; content:!\"Accept\"; http_header; content:!\"User-Agent:\"; http_header; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/en/file/43c6fb02baf800b3ab3d8f35167c37dced8ef3244691e70499a7a9243068c016/analysis/1395425759/; classtype:trojan-activity; sid:30260; rev:8;)"
    },
    {
        "description": "PUA-ADWARE Lucky Leap Adware outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"PUA-ADWARE Lucky Leap Adware outbound connection\"; flow:to_server,established; content:\"/gdi?alpha=\"; fast_pattern:only; http_uri; content:\"|0D 0A|Cache-Control: no-store,no-cache|0D 0A|Pragma: no-cache|0D 0A|Connection: Keep-Alive|0D 0A 0D 0A|\"; content:!\"Accept\"; http_header; content:!\"User-Agent:\"; http_header; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/en/file/43c6fb02baf800b3ab3d8f35167c37dced8ef3244691e70499a7a9243068c016/analysis/1395425759/; classtype:trojan-activity; sid:30261; rev:8;)"
    },
    {
        "description": "EXPLOIT-KIT Goon/Infinity exploit kit malicious portable executable file request",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"EXPLOIT-KIT Goon/Infinity exploit kit malicious portable executable file request\"; flow:to_server,established; content:\".mp3?rnd=\"; fast_pattern:only; http_uri; pcre:\"/\\/\\d+\\.mp3\\?rnd=\\d+$/U\"; flowbits:set,file.exploit_kit.pe; metadata:ruleset community, service http; classtype:trojan-activity; sid:30319; rev:5;)"
    },
    {
        "description": "SERVER-OTHER OpenSSL SSLv3 heartbeat read overrun attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET [21,25,443,465,636,992,993,995,2484] (msg:\"SERVER-OTHER OpenSSL SSLv3 heartbeat read overrun attempt\"; flow:to_server,established,only_stream; content:\"|18 03 00|\"; depth:3; detection_filter:track by_src, count 3, seconds 1; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30510; rev:8;)"
    },
    {
        "description": "SERVER-OTHER OpenSSL TLSv1 heartbeat read overrun attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET [21,25,443,465,636,992,993,995,2484] (msg:\"SERVER-OTHER OpenSSL TLSv1 heartbeat read overrun attempt\"; flow:to_server,established,only_stream; content:\"|18 03 01|\"; depth:3; detection_filter:track by_src, count 3, seconds 1; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30511; rev:8;)"
    },
    {
        "description": "SERVER-OTHER OpenSSL TLSv1.1 heartbeat read overrun attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET [21,25,443,465,636,992,993,995,2484] (msg:\"SERVER-OTHER OpenSSL TLSv1.1 heartbeat read overrun attempt\"; flow:to_server,established,only_stream; content:\"|18 03 02|\"; depth:3; detection_filter:track by_src, count 3, seconds 1; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30512; rev:8;)"
    },
    {
        "description": "SERVER-OTHER OpenSSL TLSv1.2 heartbeat read overrun attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET [21,25,443,465,636,992,993,995,2484] (msg:\"SERVER-OTHER OpenSSL TLSv1.2 heartbeat read overrun attempt\"; flow:to_server,established,only_stream; content:\"|18 03 03|\"; depth:3; detection_filter:track by_src, count 3, seconds 1; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30513; rev:8;)"
    },
    {
        "description": "SERVER-OTHER OpenSSL SSLv3 large heartbeat response - possible ssl heartbleed attempt",
        "rule": "alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any (msg:\"SERVER-OTHER OpenSSL SSLv3 large heartbeat response - possible ssl heartbleed attempt\"; flow:to_client,established,only_stream; content:\"|18 03 00|\"; depth:3; byte_test:2,>,128,0,relative; content:\"|02|\"; within:1; distance:2; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30514; rev:11;)"
    },
    {
        "description": "SERVER-OTHER OpenSSL TLSv1 large heartbeat response - possible ssl heartbleed attempt",
        "rule": "alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any (msg:\"SERVER-OTHER OpenSSL TLSv1 large heartbeat response - possible ssl heartbleed attempt\"; flow:to_client,established,only_stream; content:\"|18 03 01|\"; depth:3; byte_test:2,>,128,0,relative; content:\"|02|\"; within:1; distance:2; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30515; rev:11;)"
    },
    {
        "description": "SERVER-OTHER OpenSSL TLSv1.1 large heartbeat response - possible ssl heartbleed attempt",
        "rule": "alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any (msg:\"SERVER-OTHER OpenSSL TLSv1.1 large heartbeat response - possible ssl heartbleed attempt\"; flow:to_client,established,only_stream; content:\"|18 03 02|\"; depth:3; byte_test:2,>,128,0,relative; content:\"|02|\"; within:1; distance:2; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30516; rev:11;)"
    },
    {
        "description": "SERVER-OTHER OpenSSL TLSv1.2 large heartbeat response - possible ssl heartbleed attempt",
        "rule": "alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any (msg:\"SERVER-OTHER OpenSSL TLSv1.2 large heartbeat response - possible ssl heartbleed attempt\"; flow:to_client,established,only_stream; content:\"|18 03 03|\"; depth:3; byte_test:2,>,128,0,relative; content:\"|02|\"; within:1; distance:2; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30517; rev:11;)"
    },
    {
        "description": "SERVER-OTHER OpenSSL SSLv3 heartbeat read overrun attempt - vulnerable client response",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET [21,25,443,465,636,992,993,995,2484] (msg:\"SERVER-OTHER OpenSSL SSLv3 heartbeat read overrun attempt - vulnerable client response\"; flow:to_server,established,only_stream; content:\"|18 03 00|\"; depth:3; byte_test:2,>,128,3; detection_filter:track by_dst, count 2, seconds 5; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30520; rev:9;)"
    },
    {
        "description": "SERVER-OTHER OpenSSL TLSv1 heartbeat read overrun attempt - vulnerable client response",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET [21,25,443,465,636,992,993,995,2484] (msg:\"SERVER-OTHER OpenSSL TLSv1 heartbeat read overrun attempt - vulnerable client response\"; flow:to_server,established,only_stream; content:\"|18 03 01|\"; depth:3; byte_test:2,>,128,3; detection_filter:track by_dst, count 2, seconds 5; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30521; rev:9;)"
    },
    {
        "description": "SERVER-OTHER OpenSSL TLSv1.1 heartbeat read overrun attempt - vulnerable client response",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET [21,25,443,465,636,992,993,995,2484] (msg:\"SERVER-OTHER OpenSSL TLSv1.1 heartbeat read overrun attempt - vulnerable client response\"; flow:to_server,established,only_stream; content:\"|18 03 02|\"; depth:3; byte_test:2,>,128,3; detection_filter:track by_dst, count 2, seconds 5; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30522; rev:9;)"
    },
    {
        "description": "SERVER-OTHER OpenSSL TLSv1.2 heartbeat read overrun attempt - vulnerable client response",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET [21,25,443,465,636,992,993,995,2484] (msg:\"SERVER-OTHER OpenSSL TLSv1.2 heartbeat read overrun attempt - vulnerable client response\"; flow:to_server,established,only_stream; content:\"|18 03 03|\"; depth:3; byte_test:2,>,128,3; detection_filter:track by_dst, count 2, seconds 5; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30523; rev:9;)"
    },
    {
        "description": "SERVER-OTHER OpenSSL TLSv1.1 heartbeat read overrun attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET [21,25,443,465,636,992,993,995,2484] (msg:\"SERVER-OTHER OpenSSL TLSv1.1 heartbeat read overrun attempt\"; flow:to_server,established; content:\"|18 03 02 00 03 01 40 00|\"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30524; rev:5;)"
    },
    {
        "description": "SERVER-OTHER OpenSSL TLSv1.2 heartbeat read overrun attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET [21,25,443,465,636,992,993,995,2484] (msg:\"SERVER-OTHER OpenSSL TLSv1.2 heartbeat read overrun attempt\"; flow:to_server,established; isdataat:68; isdataat:!69; content:\"|18 03 03 00 40|\"; depth:5; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30525; rev:4;)"
    },
    {
        "description": "SERVER-OTHER OpenSSL Heartbleed masscan access exploitation attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET 443 (msg:\"SERVER-OTHER OpenSSL Heartbleed masscan access exploitation attempt\"; flow:to_server,established; content:\"[masscan/1.0]\"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30549; rev:2;)"
    },
    {
        "description": "MALWARE-OTHER Win.Trojan.Agent E-FAX phishing attempt",
        "rule": "alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:\"MALWARE-OTHER Win.Trojan.Agent E-FAX phishing attempt\"; flow:to_client,established; flowbits:isset,file.zip; file_data; content:\"pdf_efax_\"; fast_pattern:only; content:\"PK\"; depth:2; content:\".pif\"; distance:0; nocase; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,attack.mitre.org/techniques/T1192; reference:url,www.virustotal.com/en/file/4e102fd6fce767fa6c0d0a9871bb71ec5969ded694a9292c2c8a9749e5648ed4/analysis/; classtype:trojan-activity; sid:30567; rev:3;)"
    },
    {
        "description": "MALWARE-OTHER Win.Trojan.Agent E-FAX phishing attempt",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-OTHER Win.Trojan.Agent E-FAX phishing attempt\"; flow:to_server,established; content:\"/cache/pdf_efax_\"; fast_pattern:only; http_uri; pcre:\"/\\/cache\\/pdf\\x5Fefax\\x5F\\d{8,15}\\.zip$/Ui\"; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,attack.mitre.org/techniques/T1192; reference:url,www.virustotal.com/en/file/4e102fd6fce767fa6c0d0a9871bb71ec5969ded694a9292c2c8a9749e5648ed4/analysis/; classtype:trojan-activity; sid:30568; rev:3;)"
    },
    {
        "description": "MALWARE-OTHER Win.Trojan.Agent Funeral ceremony phishing attempt",
        "rule": "alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:\"MALWARE-OTHER Win.Trojan.Agent Funeral ceremony phishing attempt\"; flow:to_client,established; content:\"filename=FuneralCeremony_\"; fast_pattern:only; http_header; content:\".zip\"; nocase; http_header; file_data; content:\"FuneralCeremony_\"; content:\".exe\"; distance:0; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,attack.mitre.org/techniques/T1192; reference:url,www.virustotal.com/en/file/285ec7e2f8cbaed5d8cebde56bb6d44a921eb4e8384981832822329d8ccfb125/analysis/1395241815/; classtype:trojan-activity; sid:30569; rev:3;)"
    },
    {
        "description": "SERVER-OTHER OpenSSL SSLv3 large heartbeat response - possible ssl heartbleed attempt",
        "rule": "alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any (msg:\"SERVER-OTHER OpenSSL SSLv3 large heartbeat response - possible ssl heartbleed attempt\"; flow:to_client,established; content:\"|16 03 00|\"; byte_jump:2,0,relative; content:\"|18 03 00|\"; within:3; fast_pattern; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30777; rev:4;)"
    },
    {
        "description": "SERVER-OTHER OpenSSL SSLv3 large heartbeat response - possible ssl heartbleed attempt",
        "rule": "alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any (msg:\"SERVER-OTHER OpenSSL SSLv3 large heartbeat response - possible ssl heartbleed attempt\"; flow:to_client,established; content:\"|17 03 00|\"; byte_jump:2,0,relative; content:\"|18 03 00|\"; within:3; fast_pattern; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30778; rev:4;)"
    },
    {
        "description": "SERVER-OTHER OpenSSL TLSv1 large heartbeat response - possible ssl heartbleed attempt",
        "rule": "alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any (msg:\"SERVER-OTHER OpenSSL TLSv1 large heartbeat response - possible ssl heartbleed attempt\"; flow:to_client,established; content:\"|16 03 01|\"; byte_jump:2,0,relative; content:\"|18 03 01|\"; within:3; fast_pattern; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30779; rev:4;)"
    },
    {
        "description": "SERVER-OTHER OpenSSL TLSv1 large heartbeat response - possible ssl heartbleed attempt",
        "rule": "alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any (msg:\"SERVER-OTHER OpenSSL TLSv1 large heartbeat response - possible ssl heartbleed attempt\"; flow:to_client,established; content:\"|17 03 01|\"; byte_jump:2,0,relative; content:\"|18 03 01|\"; within:3; fast_pattern; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30780; rev:4;)"
    },
    {
        "description": "SERVER-OTHER OpenSSL TLSv1.1 large heartbeat response - possible ssl heartbleed attempt",
        "rule": "alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any (msg:\"SERVER-OTHER OpenSSL TLSv1.1 large heartbeat response - possible ssl heartbleed attempt\"; flow:to_client,established; content:\"|17 03 02|\"; byte_jump:2,0,relative; content:\"|18 03 02|\"; within:3; fast_pattern; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30782; rev:4;)"
    },
    {
        "description": "SERVER-OTHER OpenSSL TLSv1.2 large heartbeat response - possible ssl heartbleed attempt",
        "rule": "alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any (msg:\"SERVER-OTHER OpenSSL TLSv1.2 large heartbeat response - possible ssl heartbleed attempt\"; flow:to_client,established; content:\"|16 03 03|\"; byte_jump:2,0,relative; content:\"|18 03 03|\"; within:3; fast_pattern; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30783; rev:4;)"
    },
    {
        "description": "SERVER-OTHER OpenSSL TLSv1.2 large heartbeat response - possible ssl heartbleed attempt",
        "rule": "alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any (msg:\"SERVER-OTHER OpenSSL TLSv1.2 large heartbeat response - possible ssl heartbleed attempt\"; flow:to_client,established; content:\"|17 03 03|\"; byte_jump:2,0,relative; content:\"|18 03 03|\"; within:3; fast_pattern; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30784; rev:4;)"
    },
    {
        "description": "SERVER-OTHER OpenSSL SSLv3 large heartbeat response - possible ssl heartbleed attempt",
        "rule": "alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any (msg:\"SERVER-OTHER OpenSSL SSLv3 large heartbeat response - possible ssl heartbleed attempt\"; flow:to_client,established; content:\"|18 03 00|\"; byte_jump:2,0,relative; content:\"|18 03 00|\"; within:3; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30785; rev:4;)"
    },
    {
        "description": "SERVER-OTHER OpenSSL TLSv1 large heartbeat response - possible ssl heartbleed attempt",
        "rule": "alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any (msg:\"SERVER-OTHER OpenSSL TLSv1 large heartbeat response - possible ssl heartbleed attempt\"; flow:to_client,established; content:\"|18 03 01|\"; byte_jump:2,0,relative; content:\"|18 03 01|\"; within:3; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30786; rev:4;)"
    },
    {
        "description": "FILE-OTHER RARLAB WinRAR ZIP format filename spoof attempt",
        "rule": "alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:\"FILE-OTHER RARLAB WinRAR ZIP format filename spoof attempt\"; flow:to_client,established; flowbits:isset,file.zip; file_data; content:\"|50 4B 03 04|\"; depth:4; content:\"|00 00|\"; within:2; distance:24; content:\".exe\"; within:64; flowbits:set,file.zip.winrar.spoof; flowbits:noalert; metadata:policy max-detect-ips alert, ruleset community, service ftp-data, service http, service imap, service pop3; reference:bugtraq,66383; reference:url,an7isec.blogspot.co.il/2014/03/winrar-file-extension-spoofing-0day.html; classtype:attempted-user; sid:30906; rev:3;)"
    },
    {
        "description": "FILE-OTHER RARLAB WinRAR ZIP format filename spoof attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"FILE-OTHER RARLAB WinRAR ZIP format filename spoof attempt\"; flow:to_server,established; flowbits:isset,file.zip; file_data; content:\"|50 4B 03 04|\"; depth:4; content:\"|00 00|\"; within:2; distance:24; content:\".exe\"; within:64; flowbits:set,file.zip.winrar.spoof; flowbits:noalert; metadata:policy max-detect-ips alert, ruleset community, service smtp; reference:bugtraq,66383; reference:url,an7isec.blogspot.co.il/2014/03/winrar-file-extension-spoofing-0day.html; classtype:attempted-user; sid:30909; rev:3;)"
    },
    {
        "description": "EXPLOIT-KIT Multiple exploit kit redirection gate",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"EXPLOIT-KIT Multiple exploit kit redirection gate\"; flow:to_server,established; urilen:72; content:\"POST\"; http_method; content:\".php?q=\"; fast_pattern:only; http_uri; pcre:\"/^\\/[a-f0-9]{32}\\.php\\?q=[a-f0-9]{32}$/U\"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; classtype:trojan-activity; sid:30920; rev:2;)"
    },
    {
        "description": "MALWARE-BACKDOOR Win.Backdoor.Hikit outbound banner response",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"MALWARE-BACKDOOR Win.Backdoor.Hikit outbound banner response\"; flow:to_client,established; content:\"|5D 00 20 00|h|00|i|00|k|00|i|00|t|00|>|00|\"; fast_pattern:only; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http, service ssl; reference:url,www.virustotal.com/en/file/aa4b2b448a5e246888304be51ef9a65a11a53bab7899bc1b56e4fc20e1b1fd9f/analysis/; classtype:trojan-activity; sid:30948; rev:3;)"
    },
    {
        "description": "EXPLOIT-KIT CritX exploit kit payload request",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"EXPLOIT-KIT CritX exploit kit payload request\"; flow:to_server,established; content:\"/load\"; http_uri; content:\".php\"; distance:0; http_uri; pcre:\"/\\/load(?:(?:db|rh|silver|msie|flash|fla[0-9]{4,5}))\\.php/U\"; flowbits:set,file.exploit_kit.pe; metadata:ruleset community, service http; reference:url,malware-traffic-analysis.net/2014/05/29/index.html; classtype:trojan-activity; sid:30973; rev:7;)"
    },
    {
        "description": "INDICATOR-COMPROMISE MinerDeploy monitor request attempt",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"INDICATOR-COMPROMISE MinerDeploy monitor request attempt\"; flow:to_server,established; content:\"/monitor.php?\"; fast_pattern; http_uri; content:\"myid=\"; distance:0; http_uri; content:\"&ip=\"; distance:0; http_uri; content:\"&cgminer=\"; distance:0; http_uri; content:\"&operatingsystem=\"; distance:0; http_uri; content:!\"Content-Length|3A 20|\"; http_header; content:!\"Content-Type|3A 20|\"; http_header; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/en/file/06033b08afd30b413cce3b9a169cb8396fe34865f3bacd436c652dbb469ced62/analysis/; classtype:trojan-activity; sid:31531; rev:2;)"
    },
    {
        "description": "POLICY-OTHER QLogic Switch 5600/5800 default ftp login attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $FTP_PORTS (msg:\"POLICY-OTHER QLogic Switch 5600/5800 default ftp login attempt\"; flow:to_server,established; content:\"PASS|20|images|0D 0A|\"; flowbits:isset,qlogic_default_ftp; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ftp; reference:url,attack.mitre.org/techniques/T1078; reference:url,filedownloads.qlogic.com/files/Manual/81355/UserGuide_5800V_Series_QuickTools_v80_59264-02B.pdf; reference:url,filedownloads.qlogic.com/files/manual/67941/QuickTools_Guide_Sb5600_Series_v74_59235-03_%5BA%5D.pdf; classtype:default-login-attempt; sid:31830; rev:3;)"
    },
    {
        "description": "POLICY-OTHER QLogic Switch 5600/5800 default ftp login attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $FTP_PORTS (msg:\"POLICY-OTHER QLogic Switch 5600/5800 default ftp login attempt\"; flow:to_server,established; content:\"USER|20|images|0D 0A|\"; flowbits:set,qlogic_default_ftp; flowbits:noalert; metadata:policy balanced-ips alert, policy security-ips alert, ruleset community, service ftp; reference:url,attack.mitre.org/techniques/T1078; reference:url,filedownloads.qlogic.com/files/Manual/81355/UserGuide_5800V_Series_QuickTools_v80_59264-02B.pdf; reference:url,filedownloads.qlogic.com/files/manual/67941/QuickTools_Guide_Sb5600_Series_v74_59235-03_%5BA%5D.pdf; classtype:default-login-attempt; sid:31831; rev:9;)"
    },
    {
        "description": "FILE-IDENTIFY JPEG file magic detection",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"FILE-IDENTIFY JPEG file magic detection\"; flow:to_server,established; file_data; content:\"|FF D8 FF|\"; depth:3; flowbits:set,file.jpeg; flowbits:noalert; metadata:policy balanced-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service smtp; classtype:misc-activity; sid:31871; rev:11;)"
    },
    {
        "description": "EXPLOIT-KIT Astrum exploit kit landing page",
        "rule": "alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:\"EXPLOIT-KIT Astrum exploit kit landing page\"; flow:to_client,established; file_data; content:\"{(new Image).src=|22|/\"; content:\"%72%6f%72%72%65%6e%6f\"; distance:0; fast_pattern; flowbits:set,file.exploit_kit.jar&file.exploit_kit.pdf&file.exploit_kit.flash&file.exploit_kit.silverlight; metadata:ruleset community, service http; reference:url,malware.dontneedcoffee.com/2014/09/astrum-ek.html; classtype:trojan-activity; sid:31965; rev:4;)"
    },
    {
        "description": "EXPLOIT-KIT Astrum exploit kit redirection attempt",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"EXPLOIT-KIT Astrum exploit kit redirection attempt\"; flow:to_server,established; urilen:>60,norm; content:\"POST\"; http_method; pcre:\"/\\x2f[\\w\\x2d]*\\x2e+$/mU\"; content:\"Referer|3A 20|\"; http_header; content:\"x-req|3A 20|\"; fast_pattern; http_header; content:\"Connection|3A 20|Keep-Alive|0D 0A|\"; http_header; content:\"Pragma|3A 20|no-cache|0D 0A|\"; http_header; flowbits:set,file.exploit_kit.jar&file.exploit_kit.pdf&file.exploit_kit.flash&file.exploit_kit.silverlight; metadata:ruleset community, service http; reference:url,malware.dontneedcoffee.com/2014/09/astrum-ek.html; classtype:trojan-activity; sid:31970; rev:4;)"
    },
    {
        "description": "EXPLOIT-KIT Astrum exploit kit multiple exploit download request",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"EXPLOIT-KIT Astrum exploit kit multiple exploit download request\"; flow:to_server,established; urilen:>60,norm; content:\"GET\"; content:\".. HTTP/1.\"; fast_pattern:only; pcre:\"/\\x2f[\\w\\x2d]*\\x2e\\x2e$/mU\"; content:\"Connection|3A 20|Keep-Alive|0D 0A|\"; http_header; flowbits:set,file.exploit_kit.jar&file.exploit_kit.pdf&file.exploit_kit.flash&file.exploit_kit.silverlight; flowbits:noalert; metadata:policy max-detect-ips alert, ruleset community, service http; reference:url,malware.dontneedcoffee.com/2014/09/astrum-ek.html; classtype:trojan-activity; sid:31971; rev:9;)"
    },
    {
        "description": "OS-OTHER Bash CGI environment variable injection attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"OS-OTHER Bash CGI environment variable injection attempt\"; flow:to_server,established; content:\"() {\"; fast_pattern:only; http_uri; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2014-6271; reference:cve,2014-6277; reference:cve,2014-6278; reference:cve,2014-7169; classtype:attempted-admin; sid:31977; rev:5;)"
    },
    {
        "description": "OS-OTHER Bash CGI environment variable injection attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"OS-OTHER Bash CGI environment variable injection attempt\"; flow:to_server,established; content:\"() {\"; fast_pattern:only; http_header; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2014-6271; reference:cve,2014-6277; reference:cve,2014-6278; reference:cve,2014-7169; classtype:attempted-admin; sid:31978; rev:5;)"
    },
    {
        "description": "OS-OTHER Malicious DHCP server bash environment variable injection attempt",
        "rule": "alert udp $HOME_NET 67 -> $HOME_NET 68 (msg:\"OS-OTHER Malicious DHCP server bash environment variable injection attempt\"; flow:stateless; content:\"() {\"; fast_pattern:only; content:\"|02 01 06 00|\"; depth:4; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community; reference:cve,2014-6271; reference:cve,2014-6277; reference:cve,2014-6278; reference:cve,2014-7169; classtype:attempted-admin; sid:31985; rev:6;)"
    },
    {
        "description": "MALWARE-OTHER Fake Delta Ticket HTTP Response phishing attack",
        "rule": "alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:\"MALWARE-OTHER Fake Delta Ticket HTTP Response phishing attack\"; flow:to_client,established; file_data; content:\"PK\"; depth:2; content:\"DeltaTicket_ET-RM-\"; distance:0; nocase; content:\".exe\"; distance:0; nocase; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,attack.mitre.org/techniques/T1192; reference:url,www.satinfo.es/blog/tag/deltaticket_et-rm-0hj423891156-exe; classtype:trojan-activity; sid:32008; rev:3;)"
    },
    {
        "description": "OS-OTHER Bash environment variable injection attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"OS-OTHER Bash environment variable injection attempt\"; flow:to_server,established; content:\"() {\"; fast_pattern:only; content:\"MAIL\"; nocase; content:\"FROM|3A|\"; distance:0; nocase; pcre:\"/^\\s*?MAIL\\s+?FROM\\x3a[^\\r\\n]*?\\x28\\x29\\s\\x7b/i\"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service smtp; reference:cve,2014-6271; reference:cve,2014-6277; reference:cve,2014-6278; reference:cve,2014-7169; classtype:attempted-admin; sid:32038; rev:3;)"
    },
    {
        "description": "OS-OTHER Bash environment variable injection attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"OS-OTHER Bash environment variable injection attempt\"; flow:to_server,established; content:\"() {\"; fast_pattern:only; content:\"RCPT\"; nocase; content:\"TO|3A|\"; distance:0; nocase; pcre:\"/^\\s*?RCPT\\s+?TO\\x3a[^\\r\\n]*?\\x28\\x29\\s\\x7b/i\"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service smtp; reference:cve,2014-6271; reference:cve,2014-6277; reference:cve,2014-6278; reference:cve,2014-7169; classtype:attempted-admin; sid:32039; rev:3;)"
    },
    {
        "description": "OS-OTHER Bash environment variable injection attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:\"OS-OTHER Bash environment variable injection attempt\"; flow:to_server,established; content:\"USER \"; depth:5; content:\"() {\"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ftp; reference:cve,2014-6271; reference:cve,2014-6277; reference:cve,2014-6278; reference:cve,2014-7169; classtype:attempted-admin; sid:32043; rev:3;)"
    },
    {
        "description": "OS-OTHER Bash environment variable injection attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:\"OS-OTHER Bash environment variable injection attempt\"; flow:to_server,established; content:\"PASS \"; depth:5; content:\"() {\"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ftp; reference:cve,2014-6271; reference:cve,2014-6277; reference:cve,2014-6278; reference:cve,2014-7169; classtype:attempted-admin; sid:32069; rev:3;)"
    },
    {
        "description": "MALWARE-OTHER Sinkhole reply - irc-sinkhole.cert.pl",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"MALWARE-OTHER Sinkhole reply - irc-sinkhole.cert.pl\"; flow:to_client,established; content:\"|3A|irc|2D|sinkhole|2E|cert|2E|pl\"; fast_pattern:only; content:\"|3A|End of MOTD command|2E|\"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community; classtype:trojan-activity; sid:32260; rev:3;)"
    },
    {
        "description": "FILE-IDENTIFY bmp file attachment detected",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:\"FILE-IDENTIFY bmp file attachment detected\"; flow:to_server,established; content:\".bmp\"; fast_pattern:only; content:\"Content-Disposition: attachment|3B|\"; content:\"filename=\"; nocase; pcre:\"/filename=[^\\n]*\\x2ebmp/i\"; flowbits:set,file.bmp; flowbits:noalert; metadata:policy balanced-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service smtp; reference:url,en.wikipedia.org/wiki/BMP_file_format; classtype:misc-activity; sid:32378; rev:12;)"
    },
    {
        "description": "FILE-IDENTIFY dib file attachment detected",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:\"FILE-IDENTIFY dib file attachment detected\"; flow:to_server,established; content:\".dib\"; fast_pattern:only; content:\"Content-Disposition: attachment|3B|\"; content:\"filename=\"; nocase; pcre:\"/filename=[^\\n]*\\x2edib/i\"; flowbits:set,file.bmp; flowbits:noalert; metadata:policy balanced-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service smtp; reference:url,en.wikipedia.org/wiki/BMP_file_format; classtype:misc-activity; sid:32380; rev:12;)"
    },
    {
        "description": "EXPLOIT-KIT Nuclear exploit kit outbound structure",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"EXPLOIT-KIT Nuclear exploit kit outbound structure\"; flow:to_server,established; content:\"/f/\"; depth:3; http_uri; pcre:\"/^\\/f(\\/[^\\x2f]+)?\\/14\\d{8}(\\/\\d{9,10})?(\\/\\d)+(\\/x[a-f0-9]+(\\x3b\\d)+?)?$/U\"; flowbits:set,file.exploit_kit.pe; metadata:ruleset community, service http; classtype:trojan-activity; sid:32386; rev:4;)"
    },
    {
        "description": "MALWARE-CNC Win.Dropper.Ch variant outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Dropper.Ch variant outbound connection\"; flow:to_server,established; content:\"POST\"; http_method; content:\"/tasks.php\"; fast_pattern:only; http_uri; content:\"Content-length:\"; http_header; content:\"Content-type:\"; http_header; content:!\"Accept\"; http_header; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/en/file/3d8f05f45f8335198e5488716be2a9c5cebead7d0321bc371fa475d689ffe658/analysis/; classtype:trojan-activity; sid:32670; rev:3;)"
    },
    {
        "description": "INDICATOR-COMPROMISE Potential Redirect from Compromised WordPress site to Fedex - Spammed Malware Download attempt",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"INDICATOR-COMPROMISE Potential Redirect from Compromised WordPress site to Fedex - Spammed Malware Download attempt\"; flow:to_server,established; urilen:1; content:\"GET\"; http_method; content:\"/wp-admin/\"; fast_pattern:only; http_header; content:\"Host: www.fedex.com|0D 0A|\"; http_header; pcre:\"/Referer\\x3a\\x20[\\x20-\\x7E]*?\\/wp\\x2dadmin\\/[a-z\\d\\x2d]+?\\.php\\r\\n/Hi\"; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.hybrid-analysis.com/sample/a531bc62b0460eba5b0003b535a2e9cceae0b623aecfdc6f0331743fbee77e56/; classtype:trojan-activity; sid:32888; rev:2;)"
    },
    {
        "description": "PUA-ADWARE SoftPulse variant HTTP response attempt",
        "rule": "alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:\"PUA-ADWARE SoftPulse variant HTTP response attempt\"; flow:to_client,established; file_data; content:\",|22|installerBehavior|22|:{|22|hideOnInstall|22|:\"; fast_pattern:only; content:\"{|22|time|22|:\"; content:\"|22|country|22|\"; within:30; content:\",|22|countryId|22|:\"; within:20; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ftp-data, service http, service imap, service pop3; reference:url,www.virustotal.com/en/file/7aa774bffa2eb38c691774c1cc59e0adf6186da62afc417baa6333670e1e3011/analysis/1421687954/; classtype:trojan-activity; sid:33212; rev:2;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.HawkEye Keylogger exfiltration attempt - clipboard and screenshot",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET [25,587] (msg:\"MALWARE-CNC Win.Trojan.HawkEye Keylogger exfiltration attempt - clipboard and screenshot\"; flow:to_server,established; content:\"Subject|3A 20|=?utf-8?B?\"; fast_pattern; content:\"=?=|0D 0A|\"; within:150; flowbits:set,hawk.lgr; flowbits:noalert; metadata:ruleset community, service smtp; reference:url,attack.mitre.org/techniques/T1020; reference:url,attack.mitre.org/techniques/T1056; reference:url,www.virustotal.com/en/file/f4499928a6fee5d37fb711ed6d68708bf116cfc7f284d3295dd30ded7ecf64b2/analysis/; classtype:trojan-activity; sid:33221; rev:8;)"
    },
    {
        "description": "PUA-TOOLBARS Win.Toolbar.Crossrider variant outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"PUA-TOOLBARS Win.Toolbar.Crossrider variant outbound connection\"; flow:to_server,established; content:\".gif?action=\"; http_uri; content:\"&browser=\"; distance:0; http_uri; content:\"&osbuild=\"; distance:0; http_uri; content:\"&osprod=\"; distance:0; http_uri; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/en/file/06f3bd3df0326b5c3c5b03070d9d870507b868ee4e1acff62f0d301c43492709/analysis/; classtype:trojan-activity; sid:33452; rev:3;)"
    },
    {
        "description": "OS-WINDOWS Microsoft Windows SMB NTLM NULL session attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:\"OS-WINDOWS Microsoft Windows SMB NTLM NULL session attempt\"; flow:to_server,established; content:\"|FF|SMB|73 00 00 00 00|\"; depth:9; offset:4; content:\"|00 00|\"; within:2; distance:13; content:\"|FF|\"; within:1; distance:9; content:\"NTLMSSP|00 03 00 00 00|\"; within:100; content:\"|00 00 00 00 40 00 00 00|\"; within:8; distance:24; flowbits:set,smb.null_session; flowbits:noalert; metadata:policy max-detect-ips alert, policy security-ips alert, ruleset community, service netbios-ssn; reference:bugtraq,1163; reference:cve,2000-0347; classtype:attempted-recon; sid:33825; rev:7;)"
    },
    {
        "description": "MALWARE-BACKDOOR Win.Backdoor.Wekby Torn variant outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"MALWARE-BACKDOOR Win.Backdoor.Wekby Torn variant outbound connection\"; flow:established, to_server; isdataat:15; isdataat:!16; content:\"|00 00 00 11 C8 00 00 00 00 00 00 00 00 00 00 00|\"; depth:16; fast_pattern:0,12; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community; reference:url,www.virustotal.com/en/file/1D6BCF409C85887861D587C8AABFC8C8393EA692FE93C0A6836BE507A7F75985/analysis/; classtype:trojan-activity; sid:34500; rev:4;)"
    },
    {
        "description": "INDICATOR-COMPROMISE Wild Neutron potential exploit attempt",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"INDICATOR-COMPROMISE Wild Neutron potential exploit attempt\"; flow:to_server,established; urilen:>25; content:\".swf?\"; http_uri; content:\"styleid=\"; distance:0; http_uri; content:\"&langid=\"; distance:0; http_uri; content:\"&sid=\"; distance:0; http_uri; content:\"&d=\"; distance:0; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/; classtype:trojan-activity; sid:35745; rev:2;)"
    },
    {
        "description": "FILE-IDENTIFY JPEG file upload detected",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"FILE-IDENTIFY JPEG file upload detected\"; flow:to_server,established; file_data; content:\"|FF D8 FF E1|\"; depth:4; flowbits:set,file.jpeg; flowbits:noalert; metadata:policy balanced-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service http; classtype:misc-activity; sid:35852; rev:9;)"
    },
    {
        "description": "FILE-IDENTIFY OLE Document upload detected",
        "rule": "alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:\"FILE-IDENTIFY OLE Document upload detected\"; flow:to_server,established; file_data; content:\"Content-Disposition|3A|\"; nocase; content:\"Form-data|3B|\"; within:20; nocase; content:\"|D0 CF 11 E0 A1 B1 1A E1|\"; within:200; fast_pattern; flowbits:set,file.ole; flowbits:noalert; metadata:policy balanced-ips alert, policy connectivity-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service http; classtype:misc-activity; sid:36058; rev:10;)"
    },
    {
        "description": "MALWARE-CNC Win.Backdoor.Chopper web shell connection",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Backdoor.Chopper web shell connection\"; flow:to_server,established; content:\"=@eval(base64_decode($_POST\"; fast_pattern:only; http_client_body; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,attack.mitre.org/techniques/T1001; reference:url,attack.mitre.org/techniques/T1100; reference:url,attack.mitre.org/techniques/T1132; reference:url,informationonsecurity.blogspot.com/2012/11/china-chopper-webshell.html; reference:url,www.virustotal.com/en/file/BE24561427D754C0C150272CAB5017D5A2DA64D41BEC74416B8AE363FB07FD77/analysis/; classtype:trojan-activity; sid:37245; rev:4;)"
    },
    {
        "description": "FILE-OFFICE RFT document malformed header",
        "rule": "alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:\"FILE-OFFICE RFT document malformed header\"; flow:to_client,established; flowbits:isset,file.rtf; file_data; content:\"|7B 5C|rtvpn\"; depth:7; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ftp-data, service http, service imap, service pop3; reference:cve,2015-1641; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-033; classtype:attempted-user; sid:38580; rev:2;)"
    },
    {
        "description": "FILE-OFFICE RFT document malformed header",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"FILE-OFFICE RFT document malformed header\"; flow:to_server,established; flowbits:isset,file.rtf; file_data; content:\"|7B 5C|rtvpn\"; depth:7; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service smtp; reference:cve,2015-1641; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-033; classtype:attempted-user; sid:38581; rev:2;)"
    },
    {
        "description": "PUA-ADWARE Win.Adware.OpenSoftwareUpdater variant outbound connection attempt",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"PUA-ADWARE Win.Adware.OpenSoftwareUpdater variant outbound connection attempt\"; flow:to_server,established; content:\"/installer.php?\"; http_uri; content:\"CODE=\"; fast_pattern:only; content:\"UID=\"; http_uri; content:\"action=\"; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/en/file/829918eb3edb26deccd2d80c7ac8bc8ad58b4fb76a370c11731884b408a21a73/analysis/1463575824/; classtype:trojan-activity; sid:38951; rev:2;)"
    },
    {
        "description": "PUA-ADWARE Win.Adware.OpenSoftwareUpdater variant outbound connection attempt",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"PUA-ADWARE Win.Adware.OpenSoftwareUpdater variant outbound connection attempt\"; flow:to_server,established; content:\"/optin.php?\"; fast_pattern:only; http_uri; content:\"f=\"; content:\"quant=\"; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/en/file/829918eb3edb26deccd2d80c7ac8bc8ad58b4fb76a370c11731884b408a21a73/analysis/1463575824/; classtype:trojan-activity; sid:38952; rev:2;)"
    },
    {
        "description": "PUA-ADWARE Win.Adware.OpenSoftwareUpdater variant outbound connection attempt",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"PUA-ADWARE Win.Adware.OpenSoftwareUpdater variant outbound connection attempt\"; flow:to_server,established; content:\"/info.php?\"; http_uri; content:\"quant=\"; fast_pattern:only; content:\"f=\"; http_uri; content:\"h=\"; http_uri; content:\"size=\"; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/en/file/829918eb3edb26deccd2d80c7ac8bc8ad58b4fb76a370c11731884b408a21a73/analysis/1463575824/; classtype:trojan-activity; sid:38953; rev:2;)"
    },
    {
        "description": "SQL use of sleep function in HTTP header - likely SQL injection attempt",
        "rule": "alert tcp any any -> any $HTTP_PORTS (msg:\"SQL use of sleep function in HTTP header - likely SQL injection attempt\"; flow:established,to_server; content:\"User-Agent|3A| \"; http_header; content:\"sleep(\"; fast_pattern; nocase; http_header; pcre:\"/User-Agent\\x3A\\x20[^\\r\\n]*sleep\\x28/Hi\"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,blog.cloudflare.com/the-sleepy-user-agent/; classtype:web-application-attack; sid:38993; rev:9;)"
    },
    {
        "description": "FILE-OFFICE RTF document incorrect file magic attempt",
        "rule": "alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:\"FILE-OFFICE RTF document incorrect file magic attempt\"; flow:to_client,established; flowbits:isset,file.rtf; file_data; content:\"|7B 5C|rt|0D 3C|\"; depth:6; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ftp-data, service http, service imap, service pop3; reference:cve,2015-1641; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-033; classtype:attempted-user; sid:39526; rev:2;)"
    },
    {
        "description": "FILE-OFFICE RTF document incorrect file magic attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"FILE-OFFICE RTF document incorrect file magic attempt\"; flow:to_server,established; flowbits:isset,file.rtf; file_data; content:\"|7B 5C|rt|0D 3C|\"; depth:6; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service smtp; reference:cve,2015-1641; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-033; classtype:attempted-user; sid:39527; rev:2;)"
    },
    {
        "description": "FILE-OFFICE Microsoft Office RTF WRAssembly ASLR bypass download attempt",
        "rule": "alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:\"FILE-OFFICE Microsoft Office RTF WRAssembly ASLR bypass download attempt\"; flow:to_client,established; flowbits:isset,file.rtf; file_data; content:\"WRAssembly\"; fast_pattern:only; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ftp-data, service http, service imap, service pop3; reference:cve,2015-1641; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-033; classtype:attempted-user; sid:39528; rev:4;)"
    },
    {
        "description": "FILE-OFFICE Microsoft Office RTF WRAssembly ASLR bypass download attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"FILE-OFFICE Microsoft Office RTF WRAssembly ASLR bypass download attempt\"; flow:to_server,established; flowbits:isset,file.rtf; file_data; content:\"WRAssembly\"; fast_pattern:only; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service smtp; reference:cve,2015-1641; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-033; classtype:attempted-user; sid:39529; rev:4;)"
    },
    {
        "description": "FILE-OFFICE Microsoft Windows RTF file with embedded object package SMTP upload attempt",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET 25 (msg:\"FILE-OFFICE Microsoft Windows RTF file with embedded object package SMTP upload attempt\"; flow:to_server,established; file_data; content:\"{|5C|rt\"; nocase; content:\"{|5C|object|5C|objemb{|5C|*|5C|objclass Package}\"; distance:0; nocase; flowbits:set,file.rtf.embed; metadata:policy max-detect-ips alert, policy security-ips alert, ruleset community, service smtp; reference:url,en.wikipedia.org/wiki/Rich_Text_Format; classtype:misc-activity; sid:39903; rev:4;)"
    },
    {
        "description": "FILE-IDENTIFY XLSB file magic detected",
        "rule": "alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:\"FILE-IDENTIFY XLSB file magic detected\"; flow:to_client,established; file_data; content:\"PK|03 04|\"; depth:4; flowbits:set,file.zip; flowbits:set,file.xlsb; flowbits:noalert; metadata:policy balanced-ips alert, policy connectivity-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service ftp-data, service http, service imap, service pop3; classtype:misc-activity; sid:40035; rev:10;)"
    },
    {
        "description": "FILE-IDENTIFY XLSB file magic detected",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"FILE-IDENTIFY XLSB file magic detected\"; flow:to_server,established; file_data; content:\"PK|03 04|\"; depth:4; flowbits:set,file.zip; flowbits:set,file.xlsb; flowbits:noalert; metadata:policy balanced-ips alert, policy connectivity-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service smtp; classtype:misc-activity; sid:40036; rev:10;)"
    },
    {
        "description": "SERVER-OTHER Cisco IOS Group-Prime memory disclosure exfiltration attempt",
        "rule": "alert udp $HOME_NET [500,848,4500,4848] -> $EXTERNAL_NET any (msg:\"SERVER-OTHER Cisco IOS Group-Prime memory disclosure exfiltration attempt\"; flow:to_client; dsize:>2000; content:\"|0B 10 05 00|\"; depth:8; offset:16; byte_test:4,>,2000,4,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community; reference:cve,2016-6415; reference:url,attack.mitre.org/techniques/T1020; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20160916-ikev1; classtype:attempted-recon; sid:40220; rev:6;)"
    },
    {
        "description": "SERVER-OTHER Cisco IOS Group-Prime MD5 memory disclosure attempt",
        "rule": "alert udp $EXTERNAL_NET any -> $HOME_NET [500,848,4500,4848] (msg:\"SERVER-OTHER Cisco IOS Group-Prime MD5 memory disclosure attempt\"; flow:to_server; dsize:>2000; content:\"|00 00 00 00 00 00 00 00|\"; depth:8; offset:8; content:\"|00 00 00 01 00 00 00 01|\"; depth:8; offset:32; content:\"|01 01 04 01|\"; within:4; distance:4; content:\"|80 02 00 01 80 04 00 01 00 06|\"; distance:0; fast_pattern; byte_test:2,>,2000,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community; reference:cve,2016-6415; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20160916-ikev1; classtype:attempted-recon; sid:40221; rev:5;)"
    },
    {
        "description": "SERVER-OTHER Cisco IOS Group-Prime SHA memory disclosure attempt",
        "rule": "alert udp $EXTERNAL_NET any -> $HOME_NET [500,848,4500,4848] (msg:\"SERVER-OTHER Cisco IOS Group-Prime SHA memory disclosure attempt\"; flow:to_server; dsize:>2000; content:\"|00 00 00 00 00 00 00 00|\"; depth:8; offset:8; content:\"|00 00 00 01 00 00 00 01|\"; depth:8; offset:32; content:\"|01 01 04 01|\"; within:4; distance:4; content:\"|80 02 00 02 80 04 00 01 00 06|\"; distance:0; fast_pattern; byte_test:2,>,2000,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community; reference:cve,2016-6415; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20160916-ikev1; classtype:attempted-recon; sid:40222; rev:5;)"
    },
    {
        "description": "BROWSER-FIREFOX Mozilla Firefox ESR NotifyTimeChange use after free attempt",
        "rule": "alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:\"BROWSER-FIREFOX Mozilla Firefox ESR NotifyTimeChange use after free attempt\"; flow:to_client,established; file_data; content:\".createElementNS\"; content:\"svg\"; within:10; content:\".setAttribute\"; content:\"begin\"; within:15; content:\".setAttribute\"; distance:0; content:\"end\"; within:10; content:\".end\"; within:20; content:\".setAttribute\"; distance:0; content:\"end\"; within:10; content:\".end\"; within:20; content:\".pauseAnimations\"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2016-9079; reference:url,www.mozilla.org/en-US/security/advisories/mfsa2016-92/; classtype:attempted-user; sid:40888; rev:3;)"
    },
    {
        "description": "BROWSER-FIREFOX Mozilla Firefox ESR NotifyTimeChange use after free attempt",
        "rule": "alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:\"BROWSER-FIREFOX Mozilla Firefox ESR NotifyTimeChange use after free attempt\"; flow:to_client,established; file_data; content:\".pauseAnimations\"; fast_pattern:only; content:\"svg\"; nocase; content:\"animate\"; nocase; content:\"begin\"; within:50; nocase; content:\"end\"; within:50; nocase; content:\".end\"; within:30; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2016-9079; reference:url,www.mozilla.org/en-US/security/advisories/mfsa2016-92/; classtype:attempted-user; sid:40896; rev:3;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Locky variant outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.Locky variant outbound connection\"; flow:to_server,established; urilen:12; content:\"/checkupdate\"; fast_pattern:only; http_uri; content:\"x-requested-with|3A 20|\"; http_header; content:\"Referer\"; http_header; content:\"=\"; depth:15; http_client_body; content:\"%\"; within:2; http_client_body; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,virustotal.com/en/file/b9cf176ddb51fa60c7512cdbafc5a598929ac3d0b3d0443a80a7f33259aa70f2/analysis/1484673198/; classtype:trojan-activity; sid:41335; rev:4;)"
    },
    {
        "description": "SERVER-WEBAPP WordPress get_post authentication bypass attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-WEBAPP WordPress get_post authentication bypass attempt\"; flow:to_server,established; content:\"/wp-json/\"; fast_pattern:only; http_uri; content:\"id=\"; nocase; http_uri; pcre:\"/[?&]id=[^&]*?[^\\d&]/Ui\"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,wordpress.org/news/2017/01/wordpress-4-7-2-security-release/; classtype:web-application-attack; sid:41495; rev:2;)"
    },
    {
        "description": "SERVER-WEBAPP WordPress get_post authentication bypass attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-WEBAPP WordPress get_post authentication bypass attempt\"; flow:to_server,established; content:\"/wp-json/\"; fast_pattern:only; http_uri; content:\"id=\"; nocase; http_client_body; pcre:\"/[?&]id=[^&]*?[^\\d&]/Pi\"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,wordpress.org/news/2017/01/wordpress-4-7-2-security-release/; classtype:web-application-attack; sid:41496; rev:2;)"
    },
    {
        "description": "SERVER-WEBAPP WordPress get_post authentication bypass attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-WEBAPP WordPress get_post authentication bypass attempt\"; flow:to_server,established; content:\"/wp-json/\"; fast_pattern:only; http_uri; content:\"|22|id|22|\"; nocase; http_client_body; pcre:\"/\\x22id\\x22\\s*\\x3A\\s*\\x22[^\\x22]*?[^\\d\\x22]/Pi\"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,wordpress.org/news/2017/01/wordpress-4-7-2-security-release/; classtype:web-application-attack; sid:41497; rev:2;)"
    },
    {
        "description": "SERVER-SAMBA Microsoft Windows SMBv2/SMBv3 Buffer Overflow attempt",
        "rule": "alert tcp $EXTERNAL_NET [139,445] -> $HOME_NET any (msg:\"SERVER-SAMBA Microsoft Windows SMBv2/SMBv3 Buffer Overflow attempt\"; flow:to_client,established; content:\"|FE|SMB|40 00|\"; depth:6; offset:4; content:\"|03 00|\"; within:2; distance:6; byte_test:3, >, 200, 1; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community; reference:cve,2017-0016; classtype:attempted-dos; sid:41499; rev:6;)"
    },
    {
        "description": "SERVER-OTHER Cisco IOS Smart Install protocol backup config command attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET 4786 (msg:\"SERVER-OTHER Cisco IOS Smart Install protocol backup config command attempt\"; flow:to_server,established; content:\"|00 00 00 01 00 00 00 01 00 00 00 08|\"; depth:12; content:\"://\"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community; reference:url,tools.cisco.com/security/center/content/CiscoSecurityResponse/cisco-sr-20170214-smi; classtype:attempted-admin; sid:41722; rev:4;)"
    },
    {
        "description": "SERVER-OTHER Cisco IOS Smart Install protocol download config command attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET 4786 (msg:\"SERVER-OTHER Cisco IOS Smart Install protocol download config command attempt\"; flow:to_server,established; content:\"|00 00 00 01 00 00 00 01 00 00 00 03|\"; depth:12; content:\"tftp://\"; nocase; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community; reference:url,tools.cisco.com/security/center/content/CiscoSecurityResponse/cisco-sr-20170214-smi; classtype:attempted-admin; sid:41723; rev:3;)"
    },
    {
        "description": "SERVER-OTHER Cisco IOS Smart Install protocol download image command attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET 4786 (msg:\"SERVER-OTHER Cisco IOS Smart Install protocol download image command attempt\"; flow:to_server,established; content:\"|00 00 00 01 00 00 00 01 00 00 00 02|\"; depth:12; content:\"tftp://\"; nocase; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community; reference:url,tools.cisco.com/security/center/content/CiscoSecurityResponse/cisco-sr-20170214-smi; classtype:attempted-admin; sid:41724; rev:3;)"
    },
    {
        "description": "SERVER-OTHER Cisco IOS Smart Install protocol version command attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET 4786 (msg:\"SERVER-OTHER Cisco IOS Smart Install protocol version command attempt\"; flow:to_server,established; content:\"|00 00 00 02 00 00 00 01 00 00 00 05|\"; depth:12; content:\"tftp://\"; nocase; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community; reference:cve,2018-0156; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20180328-smi; reference:url,tools.cisco.com/security/center/content/CiscoSecurityResponse/cisco-sr-20170214-smi; classtype:attempted-admin; sid:41725; rev:4;)"
    },
    {
        "description": "OS-WINDOWS Microsoft Windows SMB remote code execution attempt",
        "rule": "alert tcp any any -> $HOME_NET 445 (msg:\"OS-WINDOWS Microsoft Windows SMB remote code execution attempt\"; flow:to_server,established; content:\"|FF|SMB3|00 00 00 00|\"; depth:9; offset:4; byte_extract:2,26,TotalDataCount,relative,little; byte_test:2,>,TotalDataCount,20,relative,little; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service netbios-ssn; reference:cve,2017-0144; reference:cve,2017-0146; reference:url,blog.talosintelligence.com/2017/05/wannacry.html; reference:url,isc.sans.edu/forums/diary/ETERNALBLUE+Possible+Window+SMB+Buffer+Overflow+0Day/22304/; reference:url,technet.microsoft.com/en-us/security/bulletin/MS17-010; classtype:attempted-admin; sid:41978; rev:5;)"
    },
    {
        "description": "OS-WINDOWS Microsoft Windows SMB anonymous user session setup request detected",
        "rule": "alert tcp any any -> $HOME_NET 445 (msg:\"OS-WINDOWS Microsoft Windows SMB anonymous user session setup request detected\"; flow:to_server,established; content:\"|FF|SMB|73 00 00 00 00|\"; depth:13; offset:4; content:\"|01 00 00 00 00 00 00 00|\"; within:8; distance:38; content:\"|00 00 00 00 00|\"; within:5; distance:6; flowbits:set,smb.null_session; flowbits:noalert; metadata:policy max-detect-ips alert, policy security-ips alert, ruleset community, service netbios-ssn; reference:url,msdn.microsoft.com/en-us/library/ee441638.aspx; classtype:policy-violation; sid:42256; rev:7;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Doublepulsar variant process injection command",
        "rule": "alert tcp any any -> $HOME_NET 445 (msg:\"MALWARE-CNC Win.Trojan.Doublepulsar variant process injection command\"; flow:to_server,established; content:\"|FF|SMB|32 00 00 00 00|\"; depth:9; offset:4; content:\"|42 00|\"; within:2; distance:21; content:\"|0E 00|\"; within:2; distance:29; content:!\"|00 00|\"; within:2; flowbits:set,smb.trans2.mid66; metadata:impact_flag red, ruleset community, service netbios-ssn; reference:url,attack.mitre.org/techniques/T1055; reference:url,countercept.com/our-thinking/analyzing-the-doublepulsar-kernel-dll-injection-technique/; reference:url,www.virustotal.com/file/15ffbb8d382cd2ff7b0bd4c87a7c0bffd1541c2fe86865af445123bc0b770d13/analysis/; classtype:trojan-activity; sid:42331; rev:5;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Doublepulsar variant ping command",
        "rule": "alert tcp any any -> $HOME_NET 445 (msg:\"MALWARE-CNC Win.Trojan.Doublepulsar variant ping command\"; flow:to_server,established; content:\"|FF|SMB|32 00 00 00 00|\"; depth:9; offset:4; content:\"|41 00|\"; within:2; distance:21; content:\"|0E 00 0D 00 00 00 00 00 00 00 00 00 00 00 00 00 00|\"; within:17; distance:29; fast_pattern:0,10; flowbits:set,smb.trans2.mid65; flowbits:noalert; metadata:policy balanced-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service netbios-ssn; reference:url,countercept.com/our-thinking/analyzing-the-doublepulsar-kernel-dll-injection-technique/; reference:url,www.virustotal.com/file/15ffbb8d382cd2ff7b0bd4c87a7c0bffd1541c2fe86865af445123bc0b770d13/analysis/; classtype:trojan-activity; sid:42332; rev:8;)"
    },
    {
        "description": "OS-WINDOWS Microsoft Windows SMB large NT RENAME transaction request memory leak attempt",
        "rule": "alert tcp any any -> $HOME_NET 445 (msg:\"OS-WINDOWS Microsoft Windows SMB large NT RENAME transaction request memory leak attempt\"; flow:to_server,established; content:\"|FF|SMB|A0|\"; depth:5; offset:4; content:\"|05 00|\"; within:2; distance:64; byte_test:2,>,1024,0,relative,little; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service netbios-ssn; reference:url,msdn.microsoft.com/en-us/library/ee441910.aspx; reference:url,technet.microsoft.com/en-us/security/bulletin/MS17-010; classtype:attempted-recon; sid:42338; rev:3;)"
    },
    {
        "description": "OS-WINDOWS Microsoft Windows SMB possible leak of kernel heap memory",
        "rule": "alert tcp $HOME_NET 445 -> any any (msg:\"OS-WINDOWS Microsoft Windows SMB possible leak of kernel heap memory\"; flow:to_client,established; content:\"Frag\"; fast_pattern; content:\"Free\"; content:\"|FA FF FF|\"; content:\"|F8 FF FF|\"; within:3; distance:5; content:\"|F8 FF FF|\"; within:3; distance:5; metadata:policy balanced-ips alert, policy max-detect-ips drop, policy security-ips drop, ruleset community, service netbios-ssn; reference:cve,2017-0147; reference:url,technet.microsoft.com/en-us/security/bulletin/MS17-010; classtype:attempted-recon; sid:42339; rev:3;)"
    },
    {
        "description": "MALWARE-CNC Win.Backdoor.Chopper web shell connection",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Backdoor.Chopper web shell connection\"; flow:to_server,established; content:\"X-Forwarded-For\"; nocase; http_header; content:\"z9=base64%5fdecode\"; fast_pattern:only; http_client_body; content:\"=%40eval\"; http_client_body; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,attack.mitre.org/techniques/T1100; reference:url,www.fireeye.com/blog/threat-research/2013/08/breaking-down-the-china-chopper-web-shell-part-ii.html; classtype:trojan-activity; sid:42834; rev:5;)"
    },
    {
        "description": "MALWARE-CNC Win.Backdoor.Chopper web shell connection",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Backdoor.Chopper web shell connection\"; flow:to_server,established; content:\"X-Forwarded-For\"; nocase; http_header; content:\"=edoced_46esab\"; fast_pattern:only; http_client_body; content:\"z0=\"; http_client_body; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,attack.mitre.org/techniques/T1100; reference:url,www.fireeye.com/blog/threat-research/2013/08/breaking-down-the-china-chopper-web-shell-part-ii.html; classtype:trojan-activity; sid:42835; rev:5;)"
    },
    {
        "description": "MALWARE-CNC Win.Backdoor.Chopper web shell connection",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Backdoor.Chopper web shell connection\"; flow:to_server,established; content:\"=@eval(get_magic_quotes_gpc()?stripslashes($_POST[\"; fast_pattern:only; http_client_body; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,attack.mitre.org/techniques/T1100; reference:url,www.fireeye.com/blog/threat-research/2013/08/breaking-down-the-china-chopper-web-shell-part-ii.html; classtype:trojan-activity; sid:42836; rev:5;)"
    },
    {
        "description": "OS-WINDOWS Microsoft Windows SMB remote code execution attempt",
        "rule": "alert tcp any any -> $HOME_NET 445 (msg:\"OS-WINDOWS Microsoft Windows SMB remote code execution attempt\"; flow:to_server,established; content:\"|FF|SMB|A0 00 00 00 00|\"; depth:9; offset:4; content:\"|01 00 00 00 00|\"; within:5; distance:59; byte_test:4,>,0x8150,-33,relative,little; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service netbios-ssn; reference:cve,2017-0144; reference:cve,2017-0146; reference:url,isc.sans.edu/forums/diary/ETERNALBLUE+Possible+Window+SMB+Buffer+Overflow+0Day/22304/; reference:url,technet.microsoft.com/en-us/security/bulletin/MS17-010; classtype:attempted-admin; sid:42944; rev:2;)"
    },
    {
        "description": "PROTOCOL-OTHER NETBIOS SMB IPC share access attempt",
        "rule": "alert tcp any any -> $HOME_NET 445 (msg:\"PROTOCOL-OTHER NETBIOS SMB IPC share access attempt\"; flow:to_server,established; content:\"|FF|SMB|75 00 00 00 00|\"; depth:9; offset:4; content:\"IPC$|00|\"; fast_pattern:only; flowbits:set,smb.tree.connect.ipc; flowbits:noalert; metadata:policy balanced-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service netbios-ssn; reference:url,attack.mitre.org/techniques/T1077; classtype:misc-activity; sid:43002; rev:8;)"
    },
    {
        "description": "PROTOCOL-OTHER NETBIOS SMB IPC share access attempt",
        "rule": "alert tcp any any -> $HOME_NET 445 (msg:\"PROTOCOL-OTHER NETBIOS SMB IPC share access attempt\"; flow:to_server,established; content:\"|FF|SMB|75 00 00 00 00|\"; depth:9; offset:4; content:\"I|00|P|00|C|00|$|00 00 00|\"; fast_pattern:only; flowbits:set,smb.tree.connect.ipc; flowbits:noalert; metadata:policy balanced-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service netbios-ssn; reference:url,attack.mitre.org/techniques/T1077; classtype:misc-activity; sid:43003; rev:8;)"
    },
    {
        "description": "SERVER-SAMBA Samba is_known_pipe arbitrary module load code execution attempt",
        "rule": "alert tcp any any -> $HOME_NET 445 (msg:\"SERVER-SAMBA Samba is_known_pipe arbitrary module load code execution attempt\"; flow:to_server,established; flowbits:isset,smb.tree.connect.ipc; content:\"|FF|SMB|A2 00 00 00 00|\"; depth:9; offset:4; byte_test:2,=,0,1,relative,little,bitmask 0x8000; byte_extract:2,72,len,relative,little; content:\"/\"; within:1; content:\"/\"; within:len; distance:1; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service netbios-ssn; reference:cve,2017-7494; reference:url,www.samba.org/samba/security/CVE-2017-7494.html; classtype:attempted-user; sid:43004; rev:5;)"
    },
    {
        "description": "SERVER-WEBAPP Netgear DGN1000 series routers authentication bypass attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-WEBAPP Netgear DGN1000 series routers authentication bypass attempt\"; flow:to_server,established; content:\"/setup.cgi\"; nocase; http_uri; content:\"currentsetting.htm\"; fast_pattern:only; http_uri; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:bugtraq,60281; reference:url,www.exploit-db.com/exploits/25978/; classtype:attempted-admin; sid:44687; rev:3;)"
    },
    {
        "description": "MALWARE-CNC Osx.Trojan.SHLayer variant outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Osx.Trojan.SHLayer variant outbound connection\"; flow:to_server,established; content:\"/screens/\"; nocase; http_uri; content:\"/\"; within:1; distance:8; http_uri; content:\"==\"; within:2; distance:6; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,objective-see.com/blog/blog_0x20.html; reference:url,www.virustotal.com/gui/file/f5d76324cb8fcae7f00b6825e4c110ddfd6b32db452f1eca0f4cff958316869c/detection; classtype:trojan-activity; sid:45545; rev:3;)"
    },
    {
        "description": "MALWARE-CNC Unix.Trojan.Vpnfilter variant outbound connection attempt",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Unix.Trojan.Vpnfilter variant outbound connection attempt\"; flow:to_server,established; content:\"User-Agent: Mozilla/6.1 (compatible|3B| MSIE 9.0|3B| Windows NT 5.3|3B| Trident/5.0)|0D 0A|\"; fast_pattern:only; http_header; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,blog.talosintelligence.com/2018/05/VPNFilter.html; classtype:trojan-activity; sid:45563; rev:3;)"
    },
    {
        "description": "MALWARE-CNC Vbs.Trojan.Agent inbound payload download",
        "rule": "alert tcp $EXTERNAL_NET 1025: -> $HOME_NET any (msg:\"MALWARE-CNC Vbs.Trojan.Agent inbound payload download\"; flow:to_client,established; content:\"s1|2D 7C 2D|\"; fast_pattern:only; content:\"Content-Length\"; content:\"s1|2D 7C 2D|\"; within:200; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community; reference:url,blog.talosintelligence.com/2018/02/targeted-attacks-in-middle-east.html; reference:url,virustotal.com/en/file/15f5aaa71bfa3d62fd558a3e88dd5ba26f7638bf2ac653b8d6b8d54dc7e5926b/analysis/; classtype:trojan-activity; sid:45644; rev:3;)"
    },
    {
        "description": "MALWARE-CNC Vbs.Trojan.Agent inbound payload download",
        "rule": "alert tcp $EXTERNAL_NET 1025: -> $HOME_NET any (msg:\"MALWARE-CNC Vbs.Trojan.Agent inbound payload download\"; flow:to_client,established; content:\"s2|2D 7C 2D|\"; fast_pattern:only; content:\"Content-Length\"; content:\"s3|2D 7C 2D|\"; within:200; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community; reference:url,blog.talosintelligence.com/2018/02/targeted-attacks-in-middle-east.html; reference:url,virustotal.com/en/file/15f5aaa71bfa3d62fd558a3e88dd5ba26f7638bf2ac653b8d6b8d54dc7e5926b/analysis/; classtype:trojan-activity; sid:45645; rev:3;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Silverstar outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"MALWARE-CNC Win.Trojan.Silverstar outbound connection\"; flow:to_server,established; content:\"response=fallback\"; fast_pattern:only; http_uri; content:\"/api.php?\"; depth:9; http_uri; content:\"gpu=\"; nocase; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/#/file/3f751799a501532f43ca5f12fe80aa0bad78f9f5d57e76bf49b401bb99f355df/detection; classtype:trojan-activity; sid:45960; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Revenge RAT initial outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"MALWARE-CNC Win.Trojan.Revenge RAT initial outbound connection\"; flow:to_server,established; content:\"Information\"; depth:11; content:\"false|2A 2D 5D|NK|5B 2D 2A|\"; fast_pattern:only; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community; reference:url,www.virustotal.com/en/file/518f7803ad1b8e630f50719d7cb3638ea5d67fa4d4387a55f44ddca4ef55a3ee/analysis/; reference:url,www.virustotal.com/en/file/79bdbf9ec639d5ccf3992e9c9fe9eeba21d191dc168194a80b50f3aa8068892a/analysis/; reference:url,www.virustotal.com/en/file/edb115dd5ca7c7f9dd069746daa0a4ee6298bf94de62510d3f8bebfa5f5a8bcd/analysis/; classtype:trojan-activity; sid:45961; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Revenge RAT inbound heartbeat check",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"MALWARE-CNC Win.Trojan.Revenge RAT inbound heartbeat check\"; flow:to_client,established; content:\"PNC|2A 2D 5D|NK|5B 2D 2A|\"; depth:11; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community; reference:url,www.virustotal.com/en/file/518f7803ad1b8e630f50719d7cb3638ea5d67fa4d4387a55f44ddca4ef55a3ee/analysis/; reference:url,www.virustotal.com/en/file/79bdbf9ec639d5ccf3992e9c9fe9eeba21d191dc168194a80b50f3aa8068892a/analysis/; reference:url,www.virustotal.com/en/file/edb115dd5ca7c7f9dd069746daa0a4ee6298bf94de62510d3f8bebfa5f5a8bcd/analysis/; classtype:trojan-activity; sid:45962; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.UDPOS outbound command and control IP address check",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.UDPOS outbound command and control IP address check\"; flow:to_server,established; content:\"/index.php?udpool=\"; fast_pattern:only; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,blogs.forcepoint.com/security-labs/udpos-exfiltrating-credit-card-data-dns; reference:url,www.virustotal.com/#/file/62688903adfc719c5514f25a17563547aac4801959852f5d49faa93967ce86cf/detection; classtype:trojan-activity; sid:45963; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.UDPOS outbound system information disclousre",
        "rule": "alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:\"MALWARE-CNC Win.Trojan.UDPOS outbound system information disclousre\"; flow:to_server; isdataat:150; content:\"|0F|\"; content:\"|03|bin\"; within:4; distance:15; fast_pattern; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service dns; reference:url,blogs.forcepoint.com/security-labs/udpos-exfiltrating-credit-card-data-dns; reference:url,www.virustotal.com/#/file/62688903adfc719c5514f25a17563547aac4801959852f5d49faa93967ce86cf/detection; classtype:trojan-activity; sid:45964; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.UDPOS outbound heartbeat",
        "rule": "alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:\"MALWARE-CNC Win.Trojan.UDPOS outbound heartbeat\"; flow:to_server; isdataat:150; content:\"|0F|\"; content:\"|04|ping\"; within:5; distance:15; fast_pattern; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service dns; reference:url,blogs.forcepoint.com/security-labs/udpos-exfiltrating-credit-card-data-dns; reference:url,www.virustotal.com/#/file/62688903adfc719c5514f25a17563547aac4801959852f5d49faa93967ce86cf/detection; classtype:trojan-activity; sid:45966; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.UDPOS outbound data exfiltration",
        "rule": "alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:\"MALWARE-CNC Win.Trojan.UDPOS outbound data exfiltration\"; flow:to_server; isdataat:150; content:\"|0F|\"; content:\"|03|trp\"; within:4; distance:15; fast_pattern; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service dns; reference:url,attack.mitre.org/techniques/T1020; reference:url,blogs.forcepoint.com/security-labs/udpos-exfiltrating-credit-card-data-dns; reference:url,www.virustotal.com/#/file/62688903adfc719c5514f25a17563547aac4801959852f5d49faa93967ce86cf/detection; classtype:trojan-activity; sid:45967; rev:2;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.UDPOS outbound data exfiltration",
        "rule": "alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:\"MALWARE-CNC Win.Trojan.UDPOS outbound data exfiltration\"; flow:to_server; isdataat:150; content:\"|0F|\"; content:\"|04|note\"; within:5; distance:15; fast_pattern; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service dns; reference:url,attack.mitre.org/techniques/T1020; reference:url,blogs.forcepoint.com/security-labs/udpos-exfiltrating-credit-card-data-dns; reference:url,www.virustotal.com/#/file/62688903adfc719c5514f25a17563547aac4801959852f5d49faa93967ce86cf/detection; classtype:trojan-activity; sid:45968; rev:2;)"
    },
    {
        "description": "MALWARE-CNC MultiOS.Trojan.OSCelestial variant outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"MALWARE-CNC MultiOS.Trojan.OSCelestial variant outbound connection\"; flow:to_server,established; content:\"|72 00 17|com.net.LoginDataPacket\"; fast_pattern:only; content:\"|74 00 13|Lcom/net/LoginData\"; nocase; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community; reference:url,www.virustotal.com/en/file/9b4843ff0181af15a6c8478ca00aafd4296592a2985a480575810f4f64442742/analysis/; classtype:trojan-activity; sid:45979; rev:1;)"
    },
    {
        "description": "MALWARE-CNC MultiOS.Trojan.OSCelestial variant inbound connection",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"MALWARE-CNC MultiOS.Trojan.OSCelestial variant inbound connection\"; flow:to_client,established; content:\"|74 00 29|net.oscp.client.keylogger.KeystrokeLogger\"; fast_pattern:only; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community; reference:url,attack.mitre.org/techniques/T1056; reference:url,www.virustotal.com/en/file/9b4843ff0181af15a6c8478ca00aafd4296592a2985a480575810f4f64442742/analysis/; classtype:trojan-activity; sid:45980; rev:2;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Gen variant outbound communication",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.Gen variant outbound communication\"; flow:to_server,established; urilen:6; content:\"/A56WY\"; fast_pattern:only; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,us-cert.gov/ncas/alerts/TA17-293A; classtype:trojan-activity; sid:46048; rev:2;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.CrossRAT outbound connection attempt",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"MALWARE-CNC Win.Trojan.CrossRAT outbound connection attempt\"; flow:to_server,established; content:\"[^8]&&&\"; fast_pattern:only; content:\"[^8]&&&\"; isdataat:!0,relative; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community; reference:url,www.virustotal.com/#/file/da81aec00b563123d2fbd14fb6a76619c90f81e83c5bd8aa0676922cae96b9ad/detection; classtype:trojan-activity; sid:46050; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Bandook/Anbacas outbound connection attempt",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"MALWARE-CNC Win.Trojan.Bandook/Anbacas outbound connection attempt\"; flow:to_server,established; content:\"QDAwMD\"; depth:6; fast_pattern; content:\"&&&\"; within:200; isdataat:!0,relative; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community; reference:url,info.lookout.com/rs/051-ESQ-475/images/Lookout_Dark-Caracal_srr_20180118_us_v.1.0.pdf; reference:url,www.virustotal.com/#/file/bf600e7b27bdd9e396e5c396aba7f079c244bfb92ee45c721c2294aa36586206/detection; classtype:trojan-activity; sid:46051; rev:1;)"
    },
    {
        "description": "MALWARE-CNC User-Agent known malicious user-agent string Uploador - Win.Trojan.CrossRAT",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC User-Agent known malicious user-agent string Uploador - Win.Trojan.CrossRAT\"; flow:to_server,established; content:\"User-Agent|3A| Uploador|0D 0A|\"; fast_pattern:only; http_header; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/#/file/da81aec00b563123d2fbd14fb6a76619c90f81e83c5bd8aa0676922cae96b9ad/detection; classtype:trojan-activity; sid:46052; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.yty second stage downloader initial outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.yty second stage downloader initial outbound connection\"; flow:to_server,established; content:\"/football/goal\"; fast_pattern:only; http_uri; content:\"ball=\"; http_client_body; content:\"score=\"; http_client_body; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.arbornetworks.com/blog/asert/donot-team-leverages-new-modular-malware-framework-south-asia/; classtype:trojan-activity; sid:46066; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.yty plugin downloader initial outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.yty plugin downloader initial outbound connection\"; flow:to_server,established; content:\"Expect: 100-continue\"; fast_pattern:only; http_header; content:\"pc=\"; http_client_body; content:\"pc_data=\"; http_client_body; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,attack.mitre.org/techniques/T1176; reference:url,www.arbornetworks.com/blog/asert/donot-team-leverages-new-modular-malware-framework-south-asia/; classtype:trojan-activity; sid:46067; rev:2;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.yty module download request",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.yty module download request\"; flow:to_server,established; content:\"/football/download/\"; depth:19; http_uri; content:!\"User-Agent|3A|\"; nocase; http_header; content:!\"Accept|3A|\"; nocase; http_header; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.arbornetworks.com/blog/asert/donot-team-leverages-new-modular-malware-framework-south-asia/; classtype:trojan-activity; sid:46068; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.yty module request",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.yty module request\"; flow:to_server,established; content:\"Expect: 100-continue\"; fast_pattern:only; http_header; content:\"cnumber=\"; http_uri; content:\"orname=\"; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.arbornetworks.com/blog/asert/donot-team-leverages-new-modular-malware-framework-south-asia/; classtype:trojan-activity; sid:46069; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.yty file exfiltration outbound request",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.yty file exfiltration outbound request\"; flow:to_server,established; content:\"Expect: 100-continue\"; fast_pattern:only; http_header; content:\"id=\"; depth:3; http_client_body; content:\"&pc=\"; http_client_body; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,attack.mitre.org/techniques/T1020; reference:url,www.arbornetworks.com/blog/asert/donot-team-leverages-new-modular-malware-framework-south-asia/; classtype:trojan-activity; sid:46070; rev:4;)"
    },
    {
        "description": "SERVER-WEBAPP Drupal 8 remote code execution attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-WEBAPP Drupal 8 remote code execution attempt\"; flow:to_server,established; content:\"element_parents=\"; fast_pattern:only; http_uri; content:\"#value\"; http_uri; pcre:\"/(%23|#)(submit|validate|access_callback|pre_render|post_render|lazy_builder|%6c%61%7a%79%5f%62%75%69%6c%64%65%72)/Pi\"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2018-7600; reference:url,www.drupal.org/sa-core-2018-002; classtype:attempted-admin; sid:46316; rev:5;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Dropper variant outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $FILE_DATA_PORTS (msg:\"MALWARE-CNC Win.Trojan.Dropper variant outbound connection\"; flow:established,to_server; content:\"IHkoeWRrcnkpIikqNy95ZCB5LSl5ZCB5\"; depth:40; fast_pattern; http_client_body; content:!\"Referer|3A|\"; nocase; http_header; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/#/file/fd08f6bc823cbfa495f0568ba4284e02f1cad57e56bd04ef0a0b948ea9dddee4/details; classtype:trojan-activity; sid:46378; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Kraens delivery attempt",
        "rule": "alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:\"MALWARE-CNC Win.Trojan.Kraens delivery attempt\"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:\"{|22|i|22|:|22|%s|22|,|22|l|22|:[\"; fast_pattern:only; content:\"RES_OK\"; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ftp-data, service http, service imap, service pop3; reference:url,www.virustotal.com/#/file/426d7bb2f4b362c6ff6b982565aa2bdb47e70320da0f60ba6c9bf04049e08829; classtype:trojan-activity; sid:46421; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Kraens delivery attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"MALWARE-CNC Win.Trojan.Kraens delivery attempt\"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:\"{|22|i|22|:|22|%s|22|,|22|l|22|:[\"; fast_pattern:only; content:\"RES_OK\"; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service smtp; reference:url,www.virustotal.com/#/file/426d7bb2f4b362c6ff6b982565aa2bdb47e70320da0f60ba6c9bf04049e08829; classtype:trojan-activity; sid:46422; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Vbs.Downloader.Kryptik known malicious user-agent string ",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Vbs.Downloader.Kryptik known malicious user-agent string \"; flow:to_server,established; content:\"User-Agent|3A| USR-KL\"; fast_pattern:only; http_header; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/en/file/7975cbaa5657d89b45126bf739fd84acd5bbe724f372a20360bd4fc038b67541; classtype:trojan-activity; sid:46435; rev:2;)"
    },
    {
        "description": "MALWARE-CNC Vbs.Downloader.Agent inbound connection",
        "rule": "alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:\"MALWARE-CNC Vbs.Downloader.Agent inbound connection\"; flow:to_client,established; flowbits:isset,file.ole; file_data; content:\"3832D640-CF90-11CF-8E43-00A0C911005A\"; fast_pattern:only; content:\"Workbook_Open\"; nocase; content:\"Document_Open\"; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ftp-data, service http, service imap, service pop3; reference:url,www.virustotal.com/#/file/7975cbaa5657d89b45126bf739fd84acd5bbe724f372a20360bd4fc038b67541; classtype:trojan-activity; sid:46436; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Vbs.Downloader.Agent inbound connection",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"MALWARE-CNC Vbs.Downloader.Agent inbound connection\"; flow:to_server,established; flowbits:isset,file.ole; file_data; content:\"3832D640-CF90-11CF-8E43-00A0C911005A\"; fast_pattern:only; content:\"Workbook_Open\"; nocase; content:\"Document_Open\"; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service smtp; reference:url,www.virustotal.com/#/file/7975cbaa5657d89b45126bf739fd84acd5bbe724f372a20360bd4fc038b67541; classtype:trojan-activity; sid:46437; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Vbs.Downloader.Agent inbound connection",
        "rule": "alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:\"MALWARE-CNC Vbs.Downloader.Agent inbound connection\"; flow:to_client,established; flowbits:isset,file.ole; file_data; content:\"Shell\"; nocase; content:\"vbHide\"; within:100; fast_pattern; content:\"Chr\"; nocase; content:\"Asc\"; within:100; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ftp-data, service http, service imap, service pop3; reference:url,www.virustotal.com/#/file/7975cbaa5657d89b45126bf739fd84acd5bbe724f372a20360bd4fc038b67541; classtype:trojan-activity; sid:46438; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Vbs.Downloader.Agent inbound delivery attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"MALWARE-CNC Vbs.Downloader.Agent inbound delivery attempt\"; flow:to_server,established; flowbits:isset,file.ole; file_data; content:\"Shell\"; nocase; content:\"vbHide\"; within:100; fast_pattern; content:\"Chr\"; nocase; content:\"Asc\"; within:100; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service smtp; reference:url,www.virustotal.com/#/file/7975cbaa5657d89b45126bf739fd84acd5bbe724f372a20360bd4fc038b67541; classtype:trojan-activity; sid:46439; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Installation Keylogger Osx.Trojan.Mokes data exfiltration",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Installation Keylogger Osx.Trojan.Mokes data exfiltration\"; flow:established,to_server,only_stream; content:\"GET /v1 HTTP/1.1\"; depth:16; fast_pattern; content:\"Connection: \"; http_header; content:\"User-Agent: \"; http_header; content:\"Accept-Encoding: \"; http_header; content:\"Accept-Language: \"; http_header; content:\"Host: \"; http_header; detection_filter:track by_src,count 3,seconds 6; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,attack.mitre.org/techniques/T1020; reference:url,attack.mitre.org/techniques/T1056; reference:url,www.virustotal.com/en/file/664e0a048f61a76145b55d1f1a5714606953d69edccec5228017eb546049dc8c/analysis/; classtype:trojan-activity; sid:46482; rev:6;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Ammy heartbeat",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:\"MALWARE-CNC Win.Trojan.Ammy heartbeat\"; flow:to_server,established; content:\"id=\"; depth:3; offset:5; content:\"&os=\"; within:4; distance:8; content:\"&priv=\"; distance:0; content:\"&cred=\"; distance:0; content:\"&pcname=\"; distance:0; content:\"&build_time=\"; distance:0; fast_pattern; content:\"&card=\"; distance:0; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; classtype:trojan-activity; sid:46487; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Ammy download attempt",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.Ammy download attempt\"; flow:to_server,established; content:\"/q2/index.php?\"; fast_pattern:only; http_uri; content:\"id=\"; http_uri; content:\"&c=\"; http_uri; content:\"&mk=\"; http_uri; content:\"&il=\"; http_uri; content:\"&vr=\"; http_uri; content:\"&bt=\"; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; classtype:trojan-activity; sid:46488; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Agent outbound request",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.Agent outbound request\"; flow:to_server,established; content:\".php?&1001=\"; fast_pattern:only; http_uri; content:\"99=\"; http_uri; content:\"f1=\"; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/en/file/123275cc76ef377986715c98abb0fec50cbd53f01dc3976080009dc7cdafbe86/analysis/; classtype:trojan-activity; sid:46501; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Agent outbound request",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.Agent outbound request\"; flow:to_server,established; content:\".php?&1001=\"; fast_pattern:only; http_uri; content:\"1=\"; http_client_body; content:\"2=\"; http_client_body; pcre:\"/(^|&)\\d{1,2}=[^&]*?\\d{4}/Pm\"; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/en/file/123275cc76ef377986715c98abb0fec50cbd53f01dc3976080009dc7cdafbe86/analysis/; classtype:trojan-activity; sid:46502; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Unruy outbound callout",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.Unruy outbound callout\"; flow:to_server,established; content:\".php?q=\"; fast_pattern:only; http_uri; content:\"Accept-Language: en-us\"; http_header; content:\"Accept-Encoding: gzip, deflate\"; http_header; content:\"Connection: Keep-Alive\"; http_header; content:\"Referer: http://www.google.com\"; http_header; pcre:\"/.php\\?q=\\d{1,4}\\.\\d{2,4}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.[0-9a-f]{64}\\.1.\\d{4,6}/U\"; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; classtype:trojan-activity; sid:46612; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Dropper malicious script download attempt",
        "rule": "alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:\"MALWARE-CNC Win.Trojan.Dropper malicious script download attempt\"; flow:to_client,established; file_data; content:\"<script\"; nocase; content:\"ActiveXObject\"; nocase; content:\"WScript.Shell\"; fast_pattern; nocase; content:\"p o w e r s h e l l\"; nocase; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ftp-data, service http, service imap, service pop3; reference:url,virustotal.com/#/file/76afa767b0374bde95d9a93074aceaec88228ba234caa13dd01313076baf02ee/detection; classtype:trojan-activity; sid:46742; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Dropper initial outbound connection attempt",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $FILE_DATA_PORTS (msg:\"MALWARE-CNC Win.Trojan.Dropper initial outbound connection attempt\"; flow:to_server,established; content:\".php?utma\"; fast_pattern:only; http_uri; content:!\"Referer:\"; nocase; http_header; pcre:\"/(stem|slick)\\.php\\?utma/iU\"; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ftp-data, service http, service imap, service pop3; reference:url,virustotal.com/#/file/76afa767b0374bde95d9a93074aceaec88228ba234caa13dd01313076baf02ee/detection; classtype:trojan-activity; sid:46743; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Qarallax outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"MALWARE-CNC Win.Trojan.Qarallax outbound connection\"; flow:established,to_server; content:\"|00 07|nemesis\"; depth:10; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community; reference:url,www.virustotal.com/en/file/658f67dbf509fc017ace6db7ed38b3591fe72b9ba950a59054869cd718b4da2b/analysis; classtype:trojan-activity; sid:46747; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Qarallax outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"MALWARE-CNC Win.Trojan.Qarallax outbound connection\"; flow:established,to_server; content:\"|00 05|child|01 00 16|\"; depth:11; content:\"|22|magic|22|\"; within:100; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community; reference:url,www.virustotal.com/en/file/658f67dbf509fc017ace6db7ed38b3591fe72b9ba950a59054869cd718b4da2b/analysis; classtype:trojan-activity; sid:46748; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Downloader.Zebrocy known malicious user-agent string",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Downloader.Zebrocy known malicious user-agent string\"; flow:to_server,established; content:\"User-Agent|3A| Mozilla v5.1\"; fast_pattern:only; http_header; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/#/file/5fab4d08348b4ef080ba91bdb0d769d31797f5092bff3b24b3c23d091fccc8a7; classtype:trojan-activity; sid:46785; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Downloader.Zebrocy initial outbound request",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Downloader.Zebrocy initial outbound request\"; flow:to_server,established; content:\"?fort=\"; fast_pattern:only; http_uri; content:\"pol=\"; depth:4; http_client_body; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/#/file/5fab4d08348b4ef080ba91bdb0d769d31797f5092bff3b24b3c23d091fccc8a7; classtype:trojan-activity; sid:46786; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Andr.Trojan.ZooPark outbound connection attempt",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Andr.Trojan.ZooPark outbound connection attempt\"; flow:to_server,established; content:\"/telg/sv/sv.php\"; fast_pattern:only; http_uri; content:\"id\"; http_client_body; content:\"data\"; http_client_body; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/en/file/76fa36d35e0e16b0ea416726b0da2a66dfe7d7b35504cf6c475eac4cfa95fe3a/analysis; classtype:trojan-activity; sid:46787; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Andr.Trojan.ZooPark outbound connection attempt",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Andr.Trojan.ZooPark outbound connection attempt\"; flow:to_server,established; content:\"/telg/index.php?set=show\"; fast_pattern:only; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/en/file/76fa36d35e0e16b0ea416726b0da2a66dfe7d7b35504cf6c475eac4cfa95fe3a/analysis; classtype:trojan-activity; sid:46788; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Andr.Trojan.ZooPark outbound connection attempt",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Andr.Trojan.ZooPark outbound connection attempt\"; flow:to_server,established; content:\"/get/index.php\"; http_uri; content:\"id=Z29nbw==\"; fast_pattern:only; http_uri; content:\"user=\"; http_uri; content:\"pass=\"; http_uri; content:\"data=\"; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/en/file/76fa36d35e0e16b0ea416726b0da2a66dfe7d7b35504cf6c475eac4cfa95fe3a/analysis; classtype:trojan-activity; sid:46789; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Andr.Trojan.ZooPark outbound connection attempt",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Andr.Trojan.ZooPark outbound connection attempt\"; flow:to_server,established; content:\"/spyMobile/upload.php\"; fast_pattern:only; http_uri; content:\"iemi=\"; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/en/file/76fa36d35e0e16b0ea416726b0da2a66dfe7d7b35504cf6c475eac4cfa95fe3a/analysis; classtype:trojan-activity; sid:46790; rev:1;)"
    },
    {
        "description": "SERVER-WEBAPP BA Systems BAS Web information disclosure attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-WEBAPP BA Systems BAS Web information disclosure attempt\"; flow:to_server,established; content:\"/isc/get_sid.aspx\"; fast_pattern:only; http_uri; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2017-17974; classtype:attempted-user; sid:46805; rev:1;)"
    },
    {
        "description": "SERVER-WEBAPP BA Systems BAS Web information disclosure attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-WEBAPP BA Systems BAS Web information disclosure attempt\"; flow:to_server,established; content:\"/isc/get_sid_js.aspx\"; fast_pattern:only; http_uri; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2017-17974; classtype:attempted-user; sid:46806; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Ransomware.Satan outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Ransomware.Satan outbound connection\"; flow:to_server,established; content:\"/data/token.php\"; fast_pattern:only; http_uri; content:\"status=\"; nocase; http_uri; content:\"code=\"; nocase; http_uri; content:\"Winnet Client\"; nocase; http_header; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/en/file/b686cba1894f8ab5cec0ce5db195022def00204f6cd143a325608ec93e8b74ee/analysis/; classtype:trojan-activity; sid:46818; rev:1;)"
    },
    {
        "description": "MALWARE-OTHER Win.Ransomware.Satan payload download",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-OTHER Win.Ransomware.Satan payload download\"; flow:to_server,established; content:\"/cab/sts.exe\"; fast_pattern:only; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/en/file/b686cba1894f8ab5cec0ce5db195022def00204f6cd143a325608ec93e8b74ee/analysis/; classtype:trojan-activity; sid:46819; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Dunihi outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"MALWARE-CNC Win.Trojan.Dunihi outbound connection\"; flow:to_server,established; content:\"|00 00 A2 30 81 9F 30 0D 06 09 2A 86 48 86 F7 0D 01 01 01 05 00 03 81 8D 00 30 81 89 02 81 81 00|\"; depth:32; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community; reference:url,www.virustotal.com/en/file/be442a5f8be3bf720236f71a613a534b8aa82b16b0daf8ff84a59bcb92e19e7d/analysis/; classtype:trojan-activity; sid:46827; rev:2;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.CowerSnail command and control response detected",
        "rule": "alert tcp $EXTERNAL_NET 20480 -> $HOME_NET any (msg:\"MALWARE-CNC Win.Trojan.CowerSnail command and control response detected\"; flow:to_client,established; content:\"pk\"; depth:2; content:\"R|00|e|00|q|00|u|00|e|00|s|00|t|00|\"; fast_pattern:only; content:\"|00|a|00|r|00|g|00|\"; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service irc; reference:url,www.virustotal.com/#/file/3fb8a4d2ed4f662a4cb4270bb5f488b79c8758aa6fc5c8b119c78fba38d6b7d1/detection; classtype:trojan-activity; sid:46872; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.CowerSnail initial outbound connection attempt",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET 20480 (msg:\"MALWARE-CNC Win.Trojan.CowerSnail initial outbound connection attempt\"; flow:to_server,established; content:\"+CHANNEL|0B|\"; fast_pattern:only; content:\"line-client\"; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service irc; reference:url,www.virustotal.com/#/file/3fb8a4d2ed4f662a4cb4270bb5f488b79c8758aa6fc5c8b119c78fba38d6b7d1/detection; classtype:trojan-activity; sid:46873; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Joanap variant outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET 25 (msg:\"MALWARE-CNC Win.Trojan.Joanap variant outbound connection\"; flow:to_server,established; content:\"TO: Joana <xiake722@gmail.com>\"; fast_pattern:only; content:\"SUBJECT: |5B|T|5D|\"; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service smtp; reference:url,www.virustotal.com/#/file/077d9e0e12357d27f7f0c336239e961a7049971446f7a3f10268d9439ef67885/detection; reference:url,www.virustotal.com/#/file/4c5b8c3e0369eb738686c8a111dfe460e26eb3700837c941ea2e9afd3255981e/detection; classtype:trojan-activity; sid:46885; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Nocturnal outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.Nocturnal outbound connection\"; flow:to_server,established; content:\"/server/gate.php\"; fast_pattern:only; http_uri; content:\"name=|22|hwid|22|\"; http_client_body; content:\"name=|22|platform|22|\"; http_client_body; content:\"name=|22|pcount|22|\"; http_client_body; content:\"name=|22|cccount|22|\"; http_client_body; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/en/file/ae7e5a7b34dc216e9da384fcf9868ab2c1a1d731f583f893b2d2d4009da15a4e/analysis/; classtype:trojan-activity; sid:46895; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Fareit variant outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.Fareit variant outbound connection\"; flow:to_server,established; content:\"/panel/logout.php\"; depth:17; http_uri; content:!\"Accept\"; http_header; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,virustotal.com/en/file/6de535e8d4b82e5554a138ec1d6c6b530943ff08d5e04308d695f473e74f9600/analysis/; classtype:trojan-activity; sid:46922; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Dropper outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.Dropper outbound connection\"; flow:to_server,established; content:\"User-Agent: HTTPREAD|0D 0A|\"; fast_pattern:only; http_header; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/en/file/782cc4188618cf0c4815f85ea7873a004464095f5ed459b8d1579fa27ce5810e/analysis/; classtype:trojan-activity; sid:46936; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Danabot outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.Danabot outbound connection\"; flow:to_server,established; content:\"/index.php?m=S&\"; fast_pattern:only; http_uri; content:\"&a=\"; http_uri; content:\"&b=\"; http_uri; content:\"&d=\"; http_uri; content:\"&e=\"; http_uri; content:!\"Referer\"; http_header; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/en/file/f60c6c45ff27d1733d8ab03393ab88e3a2d7c75c7d9fce3169417e8c9fd3df12/analysis; classtype:trojan-activity; sid:46966; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Danabot outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.Danabot outbound connection\"; flow:to_server,established; content:\"/index.php?m=F&\"; fast_pattern:only; http_uri; content:\"&a=\"; http_uri; content:\"&b=\"; http_uri; content:\"&d=\"; http_uri; content:\"&e=\"; http_uri; content:!\"Referer\"; http_header; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/en/file/f60c6c45ff27d1733d8ab03393ab88e3a2d7c75c7d9fce3169417e8c9fd3df12/analysis; classtype:trojan-activity; sid:46967; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Danabot outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.Danabot outbound connection\"; flow:to_server,established; content:\"/index.php?m=T&\"; fast_pattern:only; http_uri; content:\"&a=\"; http_uri; content:\"&b=\"; http_uri; content:\"&d=\"; http_uri; content:\"&e=\"; http_uri; content:!\"Referer\"; http_header; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/en/file/f60c6c45ff27d1733d8ab03393ab88e3a2d7c75c7d9fce3169417e8c9fd3df12/analysis; classtype:trojan-activity; sid:46968; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Orcus RAT inbound SSL certificate",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"MALWARE-CNC Win.Trojan.Orcus RAT inbound SSL certificate\"; flow:to_client,established; content:\"|16 03|\"; depth:2; content:\"|02|\"; within:1; distance:3; content:\"|0C|Orcus Server\"; fast_pattern:only; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssl; reference:url,virustotal.com/en/file/8d880758549220154d2ff4ee578f2b49527c5fb76a07d55237b61e30bcc09e3a/analysis/; classtype:trojan-activity; sid:46981; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.SocketPlayer outbound connection",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET [$HTTP_PORTS,3000,5156,7218] (msg:\"MALWARE-CNC Win.Trojan.SocketPlayer outbound connection\"; flow:to_server,established; content:\"POST /cl/uplod/\"; fast_pattern:only; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/en/file/de38e74b2cd493d0f014fc6ca5d2834cea213778c2e056a7c84e9547fe275889/analysis/; classtype:trojan-activity; sid:47005; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Spyware.Invisimole CnC outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Spyware.Invisimole CnC outbound connection\"; flow:to_server,established; content:\"/www/\"; depth:5; fast_pattern; http_uri; content:\"/00\"; distance:0; http_uri; content:!\"Accept|3A|\"; http_header; pcre:\"/\\/www\\/(%[A-F0-9]{2}){5,}\\/00/I\"; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/en/file/be554e706f6b8ab8f4bbea209b669e9dca98bf647faa55c46756f322dadab32f/analysis/; classtype:trojan-activity; sid:47016; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.TechSupportScam installed binary outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.TechSupportScam installed binary outbound connection\"; flow:to_server,established; content:\"/show_new.php?\"; fast_pattern:only; http_uri; content:\"code=\"; nocase; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/#/file/c9adabc7516e38ce611cbde5856fbe6b06e8afee4422d754aa810aec59ecd8d8/detection; classtype:trojan-activity; sid:47067; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.TechSupportScam installed binary outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.TechSupportScam installed binary outbound connection\"; flow:to_server,established; content:\"/register.php?\"; fast_pattern:only; http_uri; content:\"p=\"; nocase; http_uri; content:\"&code=\"; nocase; http_uri; content:!\"User-Agent\"; http_header; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/#/file/c9adabc7516e38ce611cbde5856fbe6b06e8afee4422d754aa810aec59ecd8d8/detection; classtype:trojan-activity; sid:47068; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.TechSupportScam installed binary outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.TechSupportScam installed binary outbound connection\"; flow:to_server,established; content:\"/update_new.php?\"; fast_pattern:only; http_uri; content:\"code=\"; nocase; http_uri; content:!\"User-Agent\"; http_header; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/#/file/c9adabc7516e38ce611cbde5856fbe6b06e8afee4422d754aa810aec59ecd8d8/detection; classtype:trojan-activity; sid:47069; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Js.Trojan.Agent JS Sniffer beacon connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Js.Trojan.Agent JS Sniffer beacon connection\"; flow:established,to_server; content:\".php?\"; http_uri; content:\"=WyJ1cmw\"; fast_pattern:only; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; classtype:trojan-activity; sid:47320; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.ARS VBS loader outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.ARS VBS loader outbound connection\"; flow:to_server,established; content:\"?os=\"; http_uri; content:\"&user=\"; http_uri; content:\"&av=\"; http_uri; content:\"&fw=\"; http_uri; content:\"&hwid=\"; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.flashpoint-intel.com/blog/meet-ars-vbs-loader/; classtype:trojan-activity; sid:47338; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Unix.Trojan.Vpnfilter plugin variant connection attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"MALWARE-CNC Unix.Trojan.Vpnfilter plugin variant connection attempt\"; flow:to_client,established; content:\"|00 AC D3 62 78 26 76 31 E5 E7 E5 1D C2 3C 15 40 25 2F 90 BD 1F 7F 0E 5E 33 77 EC 0C 1E 6B 61 47|\"; fast_pattern:only; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community; reference:url,attack.mitre.org/techniques/T1176; reference:url,blog.talosintelligence.com/2018/05/VPNFilter.html; classtype:trojan-activity; sid:47377; rev:2;)"
    },
    {
        "description": "MALWARE-CNC Osx.Trojan.Calisto outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Osx.Trojan.Calisto outbound connection\"; flow:to_server,established; content:\"/calisto/upload.php\"; fast_pattern:only; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,virustotal.com/en/file/81c127c3cceaf44df10bb3ceb20ce1774f6a9ead0db4bd991abf39db828661cc/analysis/; classtype:trojan-activity; sid:47414; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Osx.Trojan.Calisto outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Osx.Trojan.Calisto outbound connection\"; flow:to_server,established; content:\"/calisto/listenyee.php\"; fast_pattern:only; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,virustotal.com/en/file/81c127c3cceaf44df10bb3ceb20ce1774f6a9ead0db4bd991abf39db828661cc/analysis/; classtype:trojan-activity; sid:47415; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Mapoyun variant outbound connection attempt",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"MALWARE-CNC Win.Trojan.Mapoyun variant outbound connection attempt\"; flow:to_server,established; content:\"Connection:Close|3B|\"; fast_pattern:only; http_header; content:\"X-CA-\"; nocase; http_header; content:!\"User-Agent|3A|\"; nocase; http_header; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,virustotal.com/en/file/34cbcbbbc4b538f30bc3d57dd587f1b604d29f113c149bf1ab53898464ad9c80/analysis/; classtype:trojan-activity; sid:47427; rev:2;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Zegost variant outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:\"MALWARE-CNC Win.Trojan.Zegost variant outbound connection\"; flow:to_server,established; content:\"|2A 00 00 00|\"; depth:4; isdataat:37,relative; isdataat:!38,relative; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community; reference:url,www.virustotal.com/#/file/108bbc4ff7b7da4f0de1225094964d03b19fc38b93933f739c475f08ae17915e/detection; classtype:trojan-activity; sid:47567; rev:2;)"
    },
    {
        "description": "SERVER-WEBAPP Joomla Proclaim biblestudy backup access attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:\"SERVER-WEBAPP Joomla Proclaim biblestudy backup access attempt\"; flow:to_server,established; content:\"/media/com_biblestudy/backup/\"; fast_pattern:only; http_uri; content:\".sql\"; http_uri; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; classtype:attempted-recon; sid:47613; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.KeyPass variant inbound connection attempt",
        "rule": "alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:\"MALWARE-CNC Win.Trojan.KeyPass variant inbound connection attempt\"; flow:to_client,established; file_data; content:\"|7B 22|line1|22 3A 22|\"; depth:10; fast_pattern; content:\"|22|line2|22 3A 22|\"; within:30; distance:30; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,virustotal.com/#/file/901d893f665c6f9741aa940e5f275952/detection; classtype:trojan-activity; sid:47627; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Marap outbound beacon detected",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.Marap outbound beacon detected\"; flow:to_server,established; content:\"/dot.php\"; fast_pattern:only; http_uri; content:\"param=\"; depth:6; http_client_body; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/en/file/bc1fc69f9747dc034ece7d9bb795c5e596d9be6ca71efe75c6c0fd18f3cbfbf5/analysis/; classtype:trojan-activity; sid:47650; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Andr.Trojan.MysteryBot outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Andr.Trojan.MysteryBot outbound connection\"; flow:to_server,established; content:\"/site/gate.php?i=eyAiYWN0aW9uIjog\"; fast_pattern:only; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/en/file/334f1efd0b347d54a418d1724d51f8451b7d0bebbd05f648383d05c00726a7ae/analysis/; classtype:trojan-activity; sid:47723; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Andr.Trojan.AnubisCrypt variant outbound post detected",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Andr.Trojan.AnubisCrypt variant outbound post detected\"; flow:to_server, established; content:\"/private/\"; fast_pattern; http_uri; content:\".php\"; distance:0; http_uri; content:\"p=\"; http_client_body; content:\"User-Agent:\"; http_header; content:\"Android\"; within:100; http_header; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/#/file/d27034b9f58aa71f08f3c57d893fe07cdd395c9b4e494fbcca2a1d1ca3dce88e/detection; classtype:trojan-activity; sid:47876; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Andr.Trojan.AnubisCrypt variant outbound post detected",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Andr.Trojan.AnubisCrypt variant outbound post detected\"; flow:to_server, established; content:\"/private/checkPanel.php\"; fast_pattern:only; http_uri; content:\"User-Agent:\"; http_header; content:\"Android\"; within:100; http_header; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/#/file/d27034b9f58aa71f08f3c57d893fe07cdd395c9b4e494fbcca2a1d1ca3dce88e/detection; classtype:trojan-activity; sid:47877; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.OilRig variant outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.OilRig variant outbound connection\"; flow:to_server,established; content:\"/tahw?\"; depth:6; http_uri; pcre:\"/\\x2ftahw\\x3f[A-F0-9]{3,84}$/U\"; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/#/file/055b7607848777634b2b17a5c51da7949829ff88084c3cb30bcb3e58aae5d8e9; classtype:attempted-user; sid:47898; rev:2;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.OilRig variant outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.OilRig variant outbound connection\"; flow:to_server,established; content:\"/khc?\"; depth:5; http_uri; pcre:\"/\\x2fkhc\\x3f[A-F0-9]{3,84}$/U\"; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/#/file/055b7607848777634b2b17a5c51da7949829ff88084c3cb30bcb3e58aae5d8e9; classtype:attempted-user; sid:47899; rev:2;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.OilRig variant outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.OilRig variant outbound connection\"; flow:to_server,established; content:\"/pser?\"; depth:6; http_uri; pcre:\"/\\x2fpser\\x3f[A-F0-9]{3,84}(BBZ|BBY)/U\"; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/#/file/055b7607848777634b2b17a5c51da7949829ff88084c3cb30bcb3e58aae5d8e9; classtype:attempted-user; sid:47900; rev:2;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.MSDownloader variant outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.MSDownloader variant outbound connection\"; flow:to_server,established; content:\"MS_D0wnl0ad3r\"; fast_pattern:only; http_header; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/#/file/c3c5d7961381c202c98badc7ff0739b4f381c10b4e76d153ad2a978118a4b505/detection; classtype:trojan-activity; sid:47934; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.MSDownloader variant download",
        "rule": "alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:\"MALWARE-CNC Win.Trojan.MSDownloader variant download\"; flow:to_client,established; file_data; content:\"Content-Type|3A 20|multipart/form-data|3B| boundary=MS_D0wnl0ad3r\"; fast_pattern:44,13; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ftp-data, service http, service imap, service pop3; reference:url,www.virustotal.com/#/file/c3c5d7961381c202c98badc7ff0739b4f381c10b4e76d153ad2a978118a4b505/detection; classtype:trojan-activity; sid:47935; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.MSDownloader variant download",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"MALWARE-CNC Win.Trojan.MSDownloader variant download\"; flow:to_server,established; file_data; content:\"Content-Type|3A 20|multipart/form-data|3B| boundary=MS_D0wnl0ad3r\"; fast_pattern:44,13; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service smtp; reference:url,www.virustotal.com/#/file/c3c5d7961381c202c98badc7ff0739b4f381c10b4e76d153ad2a978118a4b505/detection; classtype:trojan-activity; sid:47936; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.AcridRain outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.AcridRain outbound connection\"; flow:to_server,established; content:\"browser/Vivaldi.txtPK\"; fast_pattern:only; http_client_body; content:\"/Upload/\"; http_uri; urilen:8; content:!\"User-Agent|3A 20|\"; http_header; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/#/file/3d28392d2dc1292a95b6d8f394c982844a9da0cdd84101039cf6ca3cf9874c1c/analysis/; classtype:trojan-activity; sid:48035; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.AcridRain outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.AcridRain outbound connection\"; flow:to_server,established; content:\"/Libs.zip\"; fast_pattern:only; http_uri; urilen:9; content:!\"User-Agent|3A 20|\"; http_header; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/#/file/3d28392d2dc1292a95b6d8f394c982844a9da0cdd84101039cf6ca3cf9874c1c/analysis/; classtype:trojan-activity; sid:48036; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.MirageFox variant outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.MirageFox variant outbound connection\"; flow:to_server,established; content:\"/image_download.php?uid=\"; fast_pattern:only; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/#/file/016948ec7743b09e41b6968b42dfade5480774df3baf915e4c8753f5f90d1734/analysis; classtype:trojan-activity; sid:48092; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.MirageFox variant outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.MirageFox variant outbound connection\"; flow:to_server,established; content:\"/search?gid=\"; fast_pattern:only; http_uri; content:\"Accept:*/*\"; http_header; content:\"POST\"; http_method; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/#/file/97813e76564aa829a359c2d12c9c6b824c532de0fc15f43765cf6b106a32b9a5/analysis; classtype:trojan-activity; sid:48093; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.ITranslator variant outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.ITranslator variant outbound connection\"; flow:to_server,established; content:\"/dl.itranslator.info/\"; fast_pattern:only; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/#/file/b73d436d7741f50d29764367cbecc4ee67412230ff0d66b7d1d0e4d26983824d/analysis; classtype:trojan-activity; sid:48115; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.ITranslator variant outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.ITranslator variant outbound connection\"; flow:to_server,established; content:\"/gl.php?uid=\"; fast_pattern:only; http_uri; content:\"&v=\"; http_uri; content:\"&x=\"; within:20; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/#/file/b73d436d7741f50d29764367cbecc4ee67412230ff0d66b7d1d0e4d26983824d/analysis; classtype:trojan-activity; sid:48116; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.ITranslator variant outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.ITranslator variant outbound connection\"; flow:to_server,established; content:\"/ufiles/\"; fast_pattern:only; http_uri; content:\".dll\"; http_uri; content:\"UID: \"; http_header; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/#/file/b73d436d7741f50d29764367cbecc4ee67412230ff0d66b7d1d0e4d26983824d/analysis; classtype:trojan-activity; sid:48117; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.ITranslator variant outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.ITranslator variant outbound connection\"; flow:to_server,established; content:\"User-Agent: ITRANSLATOR|0D 0A|\"; fast_pattern:only; http_header; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/#/file/b73d436d7741f50d29764367cbecc4ee67412230ff0d66b7d1d0e4d26983824d/analysis; classtype:trojan-activity; sid:48118; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.ITranslator variant outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.ITranslator variant outbound connection\"; flow:to_server,established; content:\"UID: P002|0D 0A|\"; fast_pattern:only; http_header; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/#/file/b73d436d7741f50d29764367cbecc4ee67412230ff0d66b7d1d0e4d26983824d/analysis; classtype:trojan-activity; sid:48119; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.ITranslator variant outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.ITranslator variant outbound connection\"; flow:to_server,established; content:\"/cfg?cb=\"; fast_pattern:only; http_uri; content:\"&guid=\"; http_uri; content:\"&uid=\"; distance:0; http_uri; content:\"&ua=\"; distance:0; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/#/file/b73d436d7741f50d29764367cbecc4ee67412230ff0d66b7d1d0e4d26983824d/analysis; classtype:trojan-activity; sid:48120; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Downloader.XAgent variant outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Downloader.XAgent variant outbound connection\"; flow:to_server,established; content:\"&itwm=\"; fast_pattern:only; http_uri; pcre:\"/&itwm=([a-z0-9\\-\\=]{1,50})/Ui\"; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/#/file/b814fdbb7cfe6e5192fe1126835b903354d75bfb15a6c262ccc2caf13a8ce4b6; classtype:trojan-activity; sid:48140; rev:2;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Zebrocy variant outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.Zebrocy variant outbound connection\"; flow:to_server,established; content:\"/technet-support/library/online-service-description.php\"; fast_pattern:only; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,virustotal.com/#/file/fcf03bf5ef4babce577dd13483391344e957fd2c855624c9f0573880b8cba62e; classtype:trojan-activity; sid:48764; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Zebrocy variant outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.Zebrocy variant outbound connection\"; flow:to_server,established; content:\"/advance/portable_version/service.php\"; fast_pattern:only; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,virustotal.com/#/file/93680d34d798a22c618c96dec724517829ec3aad71215213a2dcb1eb190ff9fa; classtype:trojan-activity; sid:48765; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Zebrocy variant outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.Zebrocy variant outbound connection\"; flow:to_server,established; content:\"/pkg/image/do.php\"; fast_pattern:only; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,virustotal.com/#/file/50d610226aa646dd643fab350b48219626918305aaa86f9dbd356c78a19204cc; classtype:trojan-activity; sid:48766; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Zebrocy variant payload download attempt",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.Zebrocy variant payload download attempt\"; flow:to_server,established; content:\"/Templates/NormalOld.dotm\"; fast_pattern:only; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,virustotal.com/#/file/07646dc0a8c8946bb78be9b96147d4327705c1a3c3bd3fbcedab32c43d914305; classtype:trojan-activity; sid:48767; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Js.Trojan.Agent variant outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Js.Trojan.Agent variant outbound connection\"; flow:established,to_server; content:\"User-Agent|3A| xmsSofts_1.0.0_\"; fast_pattern:only; http_header; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; classtype:trojan-activity; sid:48818; rev:2;)"
    },
    {
        "description": "MALWARE-CNC Js.Trojan.Agent variant inbound payload download",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Js.Trojan.Agent variant inbound payload download\"; flow:established,to_server; content:\"/blogs/enc7.js\"; fast_pattern:only; http_uri; urilen:14; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; classtype:trojan-activity; sid:48819; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Zebrocy variant outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.Zebrocy variant outbound connection\"; flow:to_server,established; content:\"/company-device-support/values/correlate-sec.php\"; fast_pattern:only; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,virustotal.com/#/file/dcbc770aeea8ad4c3f45b89535b4cb3592d6c627d6cf92ec7dfe2f8b41cda998; classtype:trojan-activity; sid:48844; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Osx.Trojan.WindTail outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Osx.Trojan.WindTail outbound connection\"; flow:to_server,established; content:\".php?very=\"; fast_pattern:only; http_uri; content:\"&xnvk=\"; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,virustotal.com/#/file/ad282e5ba2bc06a128eb20da753350278a2e47ab545fdab808e94a2ff7b4061e; classtype:trojan-activity; sid:48845; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Osx.Trojan.WindTail outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Osx.Trojan.WindTail outbound connection\"; flow:to_server,established; content:\"User-Agent: usrnode/\"; fast_pattern:only; http_header; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,virustotal.com/#/file/ad282e5ba2bc06a128eb20da753350278a2e47ab545fdab808e94a2ff7b4061e; classtype:trojan-activity; sid:48846; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Osx.Trojan.WindTail outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Osx.Trojan.WindTail outbound connection\"; flow:to_server,established; content:\"/qgHUDRZiYhOqQiN/kESklNvxsNZQcPl.php\"; fast_pattern:only; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,virustotal.com/#/file/ad282e5ba2bc06a128eb20da753350278a2e47ab545fdab808e94a2ff7b4061e; classtype:trojan-activity; sid:48847; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Agent variant outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.Agent variant outbound connection\"; flow:to_server,established; content:\"/foth1018/go.php\"; fast_pattern:only; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; classtype:trojan-activity; sid:48872; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.BitterRAT variant outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.BitterRAT variant outbound connection\"; flow:to_server,established; content:\"/js/drv\"; fast_pattern:only; http_uri; urilen:7; content:!\"Referer:\"; http_header; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,virustotal.com/#/file/7d1e26a031db514dd8258de071b96dc57ebc31baf394129c020dd65b8acfc517; classtype:trojan-activity; sid:48873; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.BitterRAT variant outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.BitterRAT variant outbound connection\"; flow:to_server,established; content:\"/ourtyaz/dwnack.php?cId=\"; fast_pattern:only; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,virustotal.com/#/file/f5afe24061226630faa0f1a125e011819627cee3254060bdf2691bad65ff1d1c; classtype:trojan-activity; sid:48874; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.BitterRAT variant outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.BitterRAT variant outbound connection\"; flow:to_server,established; content:\"/MarkQuality455/developerbuild.php?b=\"; fast_pattern:only; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,virustotal.com/#/file/5716509e4cdbf8ffa5fbce02b8881320cb852d98e590215455986a5604a453f7; classtype:trojan-activity; sid:48875; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.BitterRAT variant outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.BitterRAT variant outbound connection\"; flow:to_server,established; content:\"/purchase61dfdusfdsu/costnbenifit8889.php?p=\"; fast_pattern:only; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,virustotal.com/#/file/705487b3deaf5f2ffa3240208044015e836cf4b32ef817154e23cb9f5859993f; classtype:trojan-activity; sid:48876; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.BitterRAT variant outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.BitterRAT variant outbound connection\"; flow:to_server,established; content:\"/ourtyaz/qwe.php?TIe=\"; fast_pattern:only; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,virustotal.com/#/file/172fb23460f34d174baa359c23d46d139fe30cd2d97b11b733aae496ab609c25; classtype:trojan-activity; sid:48877; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.BitterRAT variant outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.BitterRAT variant outbound connection\"; flow:to_server,established; content:\"/winter/zxd.php?TIe=\"; fast_pattern:only; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,virustotal.com/#/file/121a0e5e66cc7bdc78387b2e67222eb0349ca038e5aced3ed0eccb167106a40e; classtype:trojan-activity; sid:48878; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Zebrocy variant outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.Zebrocy variant outbound connection\"; flow:to_server,established; content:\"/software-apptication/help-support-apl/getidpolapl.php\"; fast_pattern:only; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,virustotal.com/#/file/fcf03bf5ef4babce577dd13483391344e957fd2c855624c9f0573880b8cba62e; classtype:trojan-activity; sid:48904; rev:1;)"
    },
    {
        "description": "SERVER-SAMBA Samba is_known_pipe arbitrary module load code execution attempt",
        "rule": "alert tcp any any -> $HOME_NET 445 (msg:\"SERVER-SAMBA Samba is_known_pipe arbitrary module load code execution attempt\"; flow:to_server,established; flowbits:isset,smb.tree.connect.ipc; content:\"|FF|SMB|A2 00 00 00 00|\"; depth:9; offset:4; byte_test:2,=,1,1,relative,little,bitmask 0x8000; byte_extract:2,72,len,relative,little; content:\"/\"; within:2; content:\"/\"; within:len; distance:2; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service netbios-ssn; reference:cve,2017-7494; reference:url,www.samba.org/samba/security/CVE-2017-7494.html; classtype:attempted-user; sid:49090; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Zebrocy variant outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.Zebrocy variant outbound connection\"; flow:to_server,established; content:\"/help-desk/remote-assistant-service/PostId.php?q=\"; fast_pattern:only; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,virustotal.com/#/file/dc64fec5e951acf298184be89cf89128550b318d719dcc8e2c3194ec3bdb340b; classtype:trojan-activity; sid:49396; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Zebrocy variant outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.Zebrocy variant outbound connection\"; flow:to_server,established; content:\"/ministerstvo-energetiki/seminars/2019/06/Seminar.rtf\"; fast_pattern:only; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,virustotal.com/#/file/f617e805ccd0b1451e1f448d1328201d79cb846ba8b5b97221c26188fd1a1836; classtype:trojan-activity; sid:49397; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Zebrocy variant outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:\"MALWARE-CNC Win.Trojan.Zebrocy variant outbound connection\"; flow:to_server,established; content:\"S|00|e|00|m|00|i|00|n|00|a|00|r|00|_|00|2|00|0|00|1|00|8|00|_|00|1|00|.|00|A|00|O|00|-|00|A|00|\"; fast_pattern:only; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service netbios-ssn; reference:url,virustotal.com/#/file/573ea78afb50100f896185164da3b8519e2e0f609a34a7c70460eca5b4ae640d; classtype:trojan-activity; sid:49398; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Fakewmi variant outbound connection attempt",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.Fakewmi variant outbound connection attempt\"; flow:to_server,established; content:\".png?ID=\"; fast_pattern:only; http_uri; content:\"&MAC=\"; http_uri; content:\"&OS=\"; http_uri; content:\"&BIT=\"; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/#/file/bdbfa96d17c2f06f68b3bcc84568cf445915e194f130b0dc2411805cf889b6cc/detection; classtype:trojan-activity; sid:49571; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Fakewmi variant outbound connection attempt",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.Fakewmi variant outbound connection attempt\"; flow:to_server,established; content:\".exez?ID=\"; fast_pattern:only; http_uri; content:\"&GUID=\"; http_uri; content:\"&_T=\"; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/#/file/bdbfa96d17c2f06f68b3bcc84568cf445915e194f130b0dc2411805cf889b6cc/detection; classtype:trojan-activity; sid:49572; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.SectorA05 outbound connection attempt",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.SectorA05 outbound connection attempt\"; flow:to_server,established; content:\"/bbs/data/tmp/ping.php\"; fast_pattern:only; http_uri; content:\"word=\"; nocase; http_uri; content:\"note=\"; nocase; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,threatrecon.nshc.net/2019/01/30/operation-kitty-phishing/; classtype:trojan-activity; sid:49592; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.SectorA05 outbound connection attempt",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.SectorA05 outbound connection attempt\"; flow:to_server,established; urilen:<50; content:\"/indox.php?v=\"; fast_pattern:only; http_uri; pcre:\"/\\/indox\\.php\\x3fv=(pp|pe|s)/U\"; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,threatrecon.nshc.net/2019/01/30/operation-kitty-phishing/; classtype:trojan-activity; sid:49593; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.SectorA05 outbound connection attempt",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.SectorA05 outbound connection attempt\"; flow:to_server,established; content:\".php?file=Cobra_\"; fast_pattern:only; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,threatrecon.nshc.net/2019/01/30/operation-kitty-phishing/; classtype:trojan-activity; sid:49594; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.SectorA05 outbound connection attempt",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.SectorA05 outbound connection attempt\"; flow:to_server,established; content:\"/board.php\"; fast_pattern:only; http_uri; pcre:\"/\\/board\\.php\\?(m=[0-9A-F]{0,12}&)?(v=([abcef]|\\d+\\.\\d+))/U\"; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,threatrecon.nshc.net/2019/01/30/operation-kitty-phishing/; classtype:trojan-activity; sid:49595; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.TSCookie variant outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:\"MALWARE-CNC Win.Trojan.TSCookie variant outbound connection\"; flow:to_server,established; content:\"User-Agent: Mozilla/4.0 (compatible|3B| MSIE 8.0|3B| Win32)|0D 0A|\"; fast_pattern:only; content:\"|20|/t\"; depth:4; offset:3; content:\".aspx?m=\"; within:20; content:!\"Referer\"; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community; reference:url,blogs.jpcert.or.jp/en/2018/11/tscookie2.html; classtype:trojan-activity; sid:49664; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Ransomware.Lockergoga binary download attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"MALWARE-CNC Win.Ransomware.Lockergoga binary download attempt\"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:\"|00 00 00 00 73 63 61 6E 6E 69 6E 67 2E 2E 2E 00 20 3A 20 00 73 63 61 6E 20 66 69 6E 69 73 65 64 00 00 00 00 63 3A 2F 2E 6C 6F 67 00 77 61 72 6D 69 6E 67 20 75 70 2E 2E 2E 00 00 00|\"; fast_pattern:only; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service smtp; reference:url,bleepingcomputer.com/news/security/new-lockergoga-ransomware-allegedly-used-in-altran-attack/; classtype:trojan-activity; sid:49676; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Ransomware.Lockergoga binary download attempt",
        "rule": "alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:\"MALWARE-CNC Win.Ransomware.Lockergoga binary download attempt\"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:\"AVBlockTransformation\"; fast_pattern:only; content:\"boost\"; content:\"BlockCipher\"; nocase; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ftp-data, service http, service imap, service pop3; reference:url,bleepingcomputer.com/news/security/new-lockergoga-ransomware-allegedly-used-in-altran-attack/; classtype:trojan-activity; sid:49677; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Ransomware.Lockergoga binary download attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"MALWARE-CNC Win.Ransomware.Lockergoga binary download attempt\"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:\"AVBlockTransformation\"; fast_pattern:only; content:\"boost\"; content:\"BlockCipher\"; nocase; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service smtp; reference:url,bleepingcomputer.com/news/security/new-lockergoga-ransomware-allegedly-used-in-altran-attack/; classtype:trojan-activity; sid:49678; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Ransomware.Lockergoga binary download attempt",
        "rule": "alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:\"MALWARE-CNC Win.Ransomware.Lockergoga binary download attempt\"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:\"|40 74 6B 85 FF 7C 65 7F 04 85 F6 74 5F 8B 03 8B 40 04 8B 4C 18 38 0F B7 54 18 40 89 55 EC 8B 41|\"; fast_pattern:only; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ftp-data, service http, service imap, service pop3; reference:url,bleepingcomputer.com/news/security/new-lockergoga-ransomware-allegedly-used-in-altran-attack/; classtype:trojan-activity; sid:49679; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Ransomware.Lockergoga binary download attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"MALWARE-CNC Win.Ransomware.Lockergoga binary download attempt\"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:\"|40 74 6B 85 FF 7C 65 7F 04 85 F6 74 5F 8B 03 8B 40 04 8B 4C 18 38 0F B7 54 18 40 89 55 EC 8B 41|\"; fast_pattern:only; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service smtp; reference:url,bleepingcomputer.com/news/security/new-lockergoga-ransomware-allegedly-used-in-altran-attack/; classtype:trojan-activity; sid:49680; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Zacinlo outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.Zacinlo outbound connection\"; flow:to_server,established; content:\"/entry/feedbackinfo/production/\"; fast_pattern:only; http_uri; content:\"User-Agent: wget\"; http_header; content:\"Referer:\"; http_header; content:\"/entry/feedbackinfo/production/\"; within:100; http_header; content:!\"Accept-\"; http_header; content:!\"Content-\"; http_header; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,labs.bitdefender.com/2018/06/six-years-and-counting-inside-the-complex-zacinlo-ad-fraud-operation/; classtype:trojan-activity; sid:49788; rev:2;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Zacinlo outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.Zacinlo outbound connection\"; flow:to_server,established; content:\"/updaterinfo.bin\"; fast_pattern:only; http_uri; content:\"User-Agent: wget\"; http_header; content:\"Referer:\"; http_header; content:\"/updater/\"; within:50; http_header; content:!\"Accept-Encoding\"; http_header; content:!\"Accept-\"; http_header; content:!\"Content-\"; http_header; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,labs.bitdefender.com/2018/06/six-years-and-counting-inside-the-complex-zacinlo-ad-fraud-operation/; classtype:trojan-activity; sid:49789; rev:2;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Zacinlo outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.Zacinlo outbound connection\"; flow:to_server,established; content:\"/entry/exe/runinfo\"; fast_pattern:only; http_uri; content:\"&mac=\"; http_uri; content:\"User-Agent: wget\"; http_header; content:\"Referer:\"; http_header; content:\"/entry/\"; within:50; http_header; content:!\"Accept-\"; http_header; content:!\"Content-\"; http_header; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,labs.bitdefender.com/2018/06/six-years-and-counting-inside-the-complex-zacinlo-ad-fraud-operation/; classtype:trojan-activity; sid:49790; rev:1;)"
    },
    {
        "description": "OS-WINDOWS Microsoft Windows RDP MS_T120 channel bind attempt",
        "rule": "alert tcp any any -> $HOME_NET 3389 (msg:\"OS-WINDOWS Microsoft Windows RDP MS_T120 channel bind attempt\"; flow:to_server,established; content:\"MS_T120|00|\"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service rdp; reference:cve,2019-0708; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2019-0708; classtype:attempted-admin; sid:50137; rev:2;)"
    },
    {
        "description": "MALWARE-CNC Win.Downloader.TeamBot outbound cnc connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Downloader.TeamBot outbound cnc connection\"; flow:to_server,established; content:\"/7773/index.php\"; fast_pattern:only; http_uri; urilen:15; content:\"&string=\"; http_client_body; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/#/file/91637c3b2fdb9fe50e80dd872580856275eb0275e885fec4b47ffcbe7d724b61; classtype:trojan-activity; sid:50258; rev:2;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.TeamBot outbound cnc connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.TeamBot outbound cnc connection\"; flow:to_server,established; content:\"/php/gate.php\"; fast_pattern:only; http_uri; content:\"key=\"; nocase; http_client_body; content:\"&string=\"; distance:0; nocase; http_client_body; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/#/file/5ef40f982016085ed58e0088eaa4be6e8c32cfa6526a5e681116b0914427ee21; classtype:trojan-activity; sid:50259; rev:2;)"
    },
    {
        "description": "MALWARE-CNC Win.Downloader.TeamBot additional payload download attempt",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Downloader.TeamBot additional payload download attempt\"; flow:to_server,established; content:\"/7773/plug/\"; fast_pattern:only; http_uri; content:\".ahk\"; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/#/file/efe51c2453821310c7a34dca3054021d0f6d453b7133c381d75e3140901efd12; classtype:trojan-activity; sid:50260; rev:2;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.TeamBot outbound cnc connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.TeamBot outbound cnc connection\"; flow:to_server,established; content:\"/?gate&hwid=\"; fast_pattern:only; http_uri; content:\"&pwd=\"; http_uri; content:\"pcuser\"; distance:0; http_uri; content:\"admin\"; distance:0; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/#/file/5ef40f982016085ed58e0088eaa4be6e8c32cfa6526a5e681116b0914427ee21; classtype:trojan-activity; sid:50261; rev:2;)"
    },
    {
        "description": "MALWARE-CNC Win.Downloader.TeamBot additional payload download attempt",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Downloader.TeamBot additional payload download attempt\"; flow:to_server,established; content:\"/7773/plug/htv/tv.dll\"; fast_pattern:only; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/#/file/f64792324839f660b9bdfda95501a568c076641cf08ce63c1ddbe29b45623ac0; classtype:trojan-activity; sid:50262; rev:2;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.TeamBot outbound cnc connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.TeamBot outbound cnc connection\"; flow:to_server,established; content:\"logincreds=\"; fast_pattern:only; http_client_body; content:\"isAdmin=\"; http_client_body; content:\"antivirus=\"; http_client_body; content:\"commentary=\"; http_client_body; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/#/file/5ef40f982016085ed58e0088eaa4be6e8c32cfa6526a5e681116b0914427ee21; classtype:trojan-activity; sid:50263; rev:2;)"
    },
    {
        "description": "MALWARE-CNC Win.Downloader.TeamBot outbound cnc connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Downloader.TeamBot outbound cnc connection\"; flow:to_server,established; content:\"/7773/uploads/upload.php\"; fast_pattern:only; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/#/file/43fbda74a65668333727c6512562db4f9e712cf1d5ad9dca8f06ae51bb937ba2; classtype:trojan-activity; sid:50264; rev:2;)"
    },
    {
        "description": "MALWARE-BACKDOOR Win.Backdoor.Chopper webshell inbound request attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"MALWARE-BACKDOOR Win.Backdoor.Chopper webshell inbound request attempt\"; flow:to_server,established; content:\"/temporary_listen_addresses/smsservice\"; fast_pattern:only; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,cybersecurity.att.com/blogs/labs-research/sharepoint-vulnerability-exploited-in-the-wild; reference:url,isc.sans.edu/diary/CVE-2019-0604+Attack/24952; classtype:trojan-activity; sid:50276; rev:3;)"
    },
    {
        "description": "MALWARE-BACKDOOR Win.Backdoor.Chopper webshell inbound request attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"MALWARE-BACKDOOR Win.Backdoor.Chopper webshell inbound request attempt\"; flow:to_server,established; content:\"/temporary_listen_addresses/wsman\"; fast_pattern:only; http_uri; content:\"_reguestguid\"; nocase; http_cookie; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,cybersecurity.att.com/blogs/labs-research/sharepoint-vulnerability-exploited-in-the-wild; reference:url,isc.sans.edu/diary/CVE-2019-0604+Attack/24952; classtype:trojan-activity; sid:50277; rev:4;)"
    },
    {
        "description": "MALWARE-CNC User-Agent known malicious user agent - BURAN - Win.Trojan.Buran",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC User-Agent known malicious user agent - BURAN - Win.Trojan.Buran\"; flow:to_server,established; content:\"User-Agent|3A 20|BURAN|0D 0A|\"; fast_pattern:only; http_header; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/en/file/0bed6711e6db24563a66ee99928864e8cf3f8cff0636c1efca1b14ef15941603/analysis/; classtype:trojan-activity; sid:50424; rev:2;)"
    },
    {
        "description": "MALWARE-CNC Win.Downloader.TeamBot additional payload download attempt",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Downloader.TeamBot additional payload download attempt\"; flow:to_server,established; content:\".exe\"; fast_pattern:only; http_uri; urilen:6; content:\"User-Agent: Microsoft Internet Explorer|0D 0A|\"; http_header; content:!\"Connection\"; http_header; content:!\"Accept\"; http_header; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,virustotal.com/#/file/3024ca140830e8eaf6634c1fd00bdfbd3968c3e96886ff9ec7d1b105c946e5c8; classtype:trojan-activity; sid:50445; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Downloader.TeamBot outbound cnc connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Downloader.TeamBot outbound cnc connection\"; flow:to_server,established; content:\"/get.php?pid=\"; fast_pattern:only; http_uri; content:\"User-Agent: Microsoft Internet Explorer|0D 0A|\"; http_header; content:!\"Connection\"; http_header; content:!\"Accept\"; http_header; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,virustotal.com/#/file/3024ca140830e8eaf6634c1fd00bdfbd3968c3e96886ff9ec7d1b105c946e5c8; classtype:trojan-activity; sid:50446; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Unix.Backdoor.Godlua variant outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET 65314 (msg:\"MALWARE-CNC Unix.Backdoor.Godlua variant outbound connection\"; flow:to_server,established; content:\"|01 00 10|\"; depth:3; content:\"|00 12 5C|\"; within:3; distance:9; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community; reference:url,virustotal.com/gui/file/bd8b1bd06817772af89d93a1789d5df13e15136e53a6af60be0900986c56234f/detection; classtype:trojan-activity; sid:50811; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Dropper.Clipbanker variant outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Dropper.Clipbanker variant outbound connection\"; flow:to_server,established; content:\"/wp-content/plugins/WPSecurity/load.php\"; fast_pattern:only; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/en/file/2922662802eed0d2300c3646a7a9ae73209f71b37ab94b25e6df57f6aed7f23e/analysis/; classtype:trojan-activity; sid:50989; rev:1;)"
    },
    {
        "description": "MALWARE-BACKDOOR Win.Backdoor.Agent webshell inbound request attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"MALWARE-BACKDOOR Win.Backdoor.Agent webshell inbound request attempt\"; flow:to_server,established; content:\"Response.Write(|22|UAshell|22|)|3B 0D 0A|\"; fast_pattern:only; http_header; content:\"/ua.aspx\"; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2019-0604; reference:url,portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-0604; classtype:trojan-activity; sid:51368; rev:2;)"
    },
    {
        "description": "MALWARE-OTHER ANDR.Trojan.Agent outbound connection attempt",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-OTHER ANDR.Trojan.Agent outbound connection attempt\"; flow:to_server,established; content:\"/recv_android.php\"; fast_pattern:only; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/en/file/2bbd16a5c6e8f59cc221500b680af434785611de1194216d47ef10c52b2032e1/analysis/; classtype:trojan-activity; sid:51484; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.BlackRAT variant outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"MALWARE-CNC Win.Trojan.BlackRAT variant outbound connection\"; flow:to_server,established; content:\"ProClient.Data\"; fast_pattern:only; content:\"Clientx|2C 20|Version=\"; nocase; content:\"data|05|bytes\"; nocase; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community; reference:url,www.virustotal.com/gui/file/6610e632758a0ae2ab9b259fe1f83236aff6b5bd485c3d4e3fd4995be68535bf/detection; classtype:trojan-activity; sid:51532; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.BlackRAT variant inbound connection",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"MALWARE-CNC Win.Trojan.BlackRAT variant inbound connection\"; flow:to_client,established; content:\"BlackRAT.Data\"; fast_pattern:only; content:\"|2C 20|Version=\"; nocase; content:\"data|05|bytes\"; nocase; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community; reference:url,www.virustotal.com/gui/file/6610e632758a0ae2ab9b259fe1f83236aff6b5bd485c3d4e3fd4995be68535bf/detection; classtype:trojan-activity; sid:51533; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.ModularInstaller variant outbound connection detected",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.ModularInstaller variant outbound connection detected\"; flow:to_server,established; content:\"User-Agent|3A 20|Installer/23\"; fast_pattern:only; http_header; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.flashpoint-intel.com/blog/newly-discovered-malware-framework-cashing-in-on-ad-fraud/; classtype:trojan-activity; sid:51541; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.ModularInstaller variant outbound connection detected",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.ModularInstaller variant outbound connection detected\"; flow:to_server,established; content:\"/webkit_login_records\"; fast_pattern:only; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.flashpoint-intel.com/blog/newly-discovered-malware-framework-cashing-in-on-ad-fraud/; classtype:trojan-activity; sid:51542; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.ModularInstaller variant outbound connection detected",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.ModularInstaller variant outbound connection detected\"; flow:to_server,established; content:\"PATCH\"; http_method; content:\"/installers/\"; http_uri; content:\"X-Installer-\"; fast_pattern:only; http_header; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.flashpoint-intel.com/blog/newly-discovered-malware-framework-cashing-in-on-ad-fraud/; classtype:trojan-activity; sid:51543; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.ModularInstaller variant outbound connection detected",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.ModularInstaller variant outbound connection detected\"; flow:to_server,established; content:\"/upload_files\"; http_uri; content:\"X-File-Name:\"; fast_pattern:only; http_header; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.flashpoint-intel.com/blog/newly-discovered-malware-framework-cashing-in-on-ad-fraud/; classtype:trojan-activity; sid:51544; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.ModularInstaller variant outbound connection detected",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.ModularInstaller variant outbound connection detected\"; flow:to_server,established; content:\"/tasks\"; http_uri; content:\"X-Finder-\"; fast_pattern:only; http_header; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.flashpoint-intel.com/blog/newly-discovered-malware-framework-cashing-in-on-ad-fraud/; classtype:trojan-activity; sid:51545; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.ModularInstaller variant outbound connection detected",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.ModularInstaller variant outbound connection detected\"; flow:to_server,established; content:\"/webkit_cookies\"; http_uri; content:\"X-Finder-\"; fast_pattern:only; http_header; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.flashpoint-intel.com/blog/newly-discovered-malware-framework-cashing-in-on-ad-fraud/; classtype:trojan-activity; sid:51546; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Amadey botnet outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.Amadey botnet outbound connection\"; flow:to_server,established; content:\"bi=\"; fast_pattern:only; http_client_body; content:\"/index.php\"; nocase; http_uri; content:\"id=\"; nocase; http_client_body; content:\"sd=\"; nocase; http_client_body; content:\"vs=\"; nocase; http_client_body; content:\"ar=\"; nocase; http_client_body; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/gui/file/ea09fb5b9c31bbf5817f22634f0ad837605a3352df099690d5e3a948bb719e83; classtype:trojan-activity; sid:51636; rev:3;)"
    },
    {
        "description": "MALWARE-CNC Osx.Trojan.Gmera variant outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Osx.Trojan.Gmera variant outbound connection\"; flow:to_server,established; content:\"/link.php?\"; depth:13; fast_pattern; http_uri; content:\"User-Agent: curl/\"; http_header; content:!\"Referer\"; nocase; http_header; pcre:\"/^\\/link\\.php\\?.{4,20}&\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}/U\"; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/en/file/18e1db7c37a63d987a5448b4dd25103c8053799b0deea5f45f00ca094afe2fe7/analysis/; classtype:trojan-activity; sid:51642; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Silence variant outbound connection detected",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.Silence variant outbound connection detected\"; flow:to_server,established; content:\"/showthread.php?\"; fast_pattern:only; http_uri; content:\"alphayz=\"; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/gui/file/793b0dea13a1934f3a81d348ca8cb033da908a74feed5a37a3ccc9cb08cf31f1/detection; classtype:trojan-activity; sid:51670; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Silence variant outbound connection detected",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.Silence variant outbound connection detected\"; flow:to_server,established; content:\"/showthread.php?yz=\"; fast_pattern:only; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/gui/file/793b0dea13a1934f3a81d348ca8cb033da908a74feed5a37a3ccc9cb08cf31f1/detection; classtype:trojan-activity; sid:51671; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Andr.Trojan.Moonshine outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET [$HTTP_PORTS,10011] (msg:\"MALWARE-CNC Andr.Trojan.Moonshine outbound connection\"; flow:established,to_server; content:\"User-Agent: hots scot\"; fast_pattern:only; content:\"/ws?\"; nocase; content:\"whisky_id=\"; nocase; content:\"device_id=\"; nocase; content:\"Upgrade: websocket\"; nocase; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/en/file/6977e6098815cd91016be9d76f194ed4622640d03c6cdd66b1032306a2190af7/analysis/; classtype:trojan-activity; sid:51672; rev:1;)"
    },
    {
        "description": "MALWARE-OTHER Xml.Phishing.Evernote outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-OTHER Xml.Phishing.Evernote outbound connection\"; flow:to_server,established; content:\"_spacertoofee=\"; fast_pattern:only; http_uri; content:\"hondacbrheavy\"; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/en/file/26f541b6e334574311c168af5d84b2d6887115bbff33ae5b45d28b0f66901b87/analysis/; classtype:misc-activity; sid:52026; rev:1;)"
    },
    {
        "description": "MALWARE-OTHER Xml.Phishing.Evernote outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-OTHER Xml.Phishing.Evernote outbound connection\"; flow:to_server,established; content:\"_truthcolor=\"; fast_pattern:only; http_uri; content:\"dramafrine\"; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/en/file/50d0c853da4e7d2226d70e136d6e88e8e3841cc67a85df976d1bdf7084571a60/analysis/; classtype:misc-activity; sid:52027; rev:1;)"
    },
    {
        "description": "FILE-IDENTIFY Portable Executable binary file magic detected",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"FILE-IDENTIFY Portable Executable binary file magic detected\"; flow:to_server,established; file_data; content:\"ZM\"; byte_jump:4,58,relative,little; content:\"PE|00 00|\"; within:4; distance:-64; flowbits:set,file.exe; flowbits:noalert; metadata:policy balanced-ips alert, policy connectivity-ips alert, policy max-detect-ips alert, policy security-ips alert, ruleset community, service smtp; classtype:misc-activity; sid:52056; rev:3;)"
    },
    {
        "description": "FILE-IDENTIFY Portable Executable binary file magic detected",
        "rule": "alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:\"FILE-IDENTIFY Portable Executable binary file magic detected\"; flow:to_client,established; file_data; content:\"ZM\"; byte_jump:4,58,relative,little; content:\"PE|00 00|\"; within:4; distance:-64; flowbits:set,file.exe; flowbits:noalert; metadata:policy max-detect-ips alert, ruleset community, service ftp-data, service http, service imap, service pop3; classtype:misc-activity; sid:52057; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Js.Trojan.FakeUpdate outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Js.Trojan.FakeUpdate outbound connection\"; flow:to_server,established; content:\"POST /1x1.png HTTP/\"; fast_pattern:only; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/#/file/8035806fc7109137ab55d39046ad9e010597bf5390b2e82740add8d1749edaf3; classtype:trojan-activity; sid:52259; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.XpertRAT inbound connection",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:\"MALWARE-CNC Win.Trojan.XpertRAT inbound connection\"; flow:to_client,established; isdataat:!12; content:\"|7C 30 7C A1 40 23 40 21|\"; depth:8; offset:3; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community; reference:url,www.virustotal.com/gui/file/064d1d9a20f737679bb7ce912854c7ab29f78a0716ee8bc8dc69ade02acdca5a/detection; classtype:trojan-activity; sid:52548; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.XpertRAT outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"MALWARE-CNC Win.Trojan.XpertRAT outbound connection\"; flow:to_server,established; isdataat:!11; content:\"|7C|root|7C|\"; depth:6; offset:3; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community; reference:url,www.virustotal.com/gui/file/064d1d9a20f737679bb7ce912854c7ab29f78a0716ee8bc8dc69ade02acdca5a/detection; classtype:trojan-activity; sid:52549; rev:1;)"
    },
    {
        "description": "SERVER-WEBAPP Citrix ADC and Gateway arbitrary code execution attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-WEBAPP Citrix ADC and Gateway arbitrary code execution attempt\"; flow:to_server,established; content:\"/vpns/\"; fast_pattern:only; http_uri; content:\"NSC_USER:\"; http_raw_header; content:\"../\"; within:10; http_raw_header; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2019-19781; reference:url,support.citrix.com/article/CTX267027; classtype:web-application-attack; sid:52620; rev:2;)"
    },
    {
        "description": "SERVER-APACHE Apache Tomcat AJP connector arbitrary file access attempt",
        "rule": "alert tcp any any -> $HOME_NET 8009 (msg:\"SERVER-APACHE Apache Tomcat AJP connector arbitrary file access attempt\"; flow:to_server,established; content:\"|12 34|\"; depth:2; content:\"|02|\"; within:1; distance:2; byte_test:1,!&,0xF9,0,relative; byte_extract:2,1,protocol_len,relative; content:\"HTTP\"; within:protocol_len; nocase; content:\"javax.servlet.include.request_uri|00|\"; fast_pattern:only; content:\"javax.servlet.include.servlet_path|00|\"; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2020-1938; classtype:attempted-user; sid:53341; rev:2;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Copperhedge outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.Copperhedge outbound connection\"; flow:to_server,established; content:\"*dJU!*JE&!M@UNQ@\"; fast_pattern:only; http_client_body; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,virustotal.com/gui/file/d8af45210bf931bc5b03215ed30fb731e067e91f25eda02a404bd55169e3e3c3/detection; classtype:trojan-activity; sid:54053; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Copperhedge outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.Copperhedge outbound connection\"; flow:to_server,established; content:\"t34kjfdla45l\"; fast_pattern:only; http_client_body; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,virustotal.com/gui/file/b4bf6322c67a23553d5a9af6fcd9510eb613ffac963a21e32a9ced83132a09ba/detection; classtype:trojan-activity; sid:54054; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Win.Trojan.Copperhedge outbound connection",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC Win.Trojan.Copperhedge outbound connection\"; flow:to_server,established; content:\"_webident_f\"; fast_pattern:only; http_client_body; content:\"_webident_s\"; http_client_body; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,virustotal.com/gui/file/0a763da26a67cb2b09a3ae6e1ac07828065eb980e452ce7d3354347976038e7e/detection; classtype:trojan-activity; sid:54055; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Unix.Malware.Drovorub cnc inbound connection attempt",
        "rule": "alert tcp any any -> any any (msg:\"MALWARE-CNC Unix.Malware.Drovorub cnc inbound connection attempt\"; flow:established; content:\"{|22|children|22|:[{|22|name|22|:\"; fast_pattern:only; content:\"|81|\"; depth:1; content:\"|22 2C 22|value|22 3A|\"; distance:0; nocase; pcre:\"/^\\x81.{1,9}\\x7b\\x22children\\x22\\x3a\\x5b\\x7b\\x22name\\x22\\x3a\\x22[a-z0-9_\\x2e]+\\x22\\x2c\\x22value\\x22\\x3a\\x22[a-z0-9\\x2b\\x2f]+={0,2}\\x22\\x7d/ims\"; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community; reference:url,media.defense.gov/2020/Aug/13/2002476465/-1/-1/0/CSA_DROVORUB_RUSSIAN_GRU_MALWARE_AUG_2020.PDF; classtype:trojan-activity; sid:54793; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Rat.Tool.CSBundleUSATodayServer variant inbound command attempt",
        "rule": "alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:\"MALWARE-CNC Rat.Tool.CSBundleUSATodayServer variant inbound command attempt\"; flow:to_client,established; file_data; content:\"{|22|navgd|22|:|22|<div class=gnt_n_dd_ls_w><div class=gnt_n_dd_nt>ONLY AT USA TODAY:</div><div class=gnt_n_dd_ls><a class=gnt_n_dd_ls_a href=https://supportlocal.usatoday.com/\"; fast_pattern:only; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.fireeye.com/blog/threat-research/2020/12/unauthorized-access-of-fireeye-red-team-tools.html; classtype:trojan-activity; sid:56605; rev:1;)"
    },
    {
        "description": "MALWARE-CNC Rat.Tool.CSBundleUSATodayServer variant inbound command attempt",
        "rule": "alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:\"MALWARE-CNC Rat.Tool.CSBundleUSATodayServer variant inbound command attempt\"; flow:to_client,established; content:\"X-Timer: S1593010188.776402,VS0,VE1\"; fast_pattern:only; http_header; content:\"Content-Type: application/json|5C 3B| charset=utf-8\"; http_header; content:\"Strict-Transport-Security: max-age=10890000\"; http_header; content:\"Cache-Control: public, immutable, max-age=315360000\"; http_header; content:\"X-Cache: HIT, HIT\"; http_header; content:\"Vary: X-AbVariant, X-AltUrl, Accept-Encoding\"; http_header; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.fireeye.com/blog/threat-research/2020/12/unauthorized-access-of-fireeye-red-team-tools.html; classtype:trojan-activity; sid:56606; rev:1;)"
    },
    {
        "description": "MALWARE-CNC MultiOS.Malware.GORAT outbound communication attempt",
        "rule": "alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"MALWARE-CNC MultiOS.Malware.GORAT outbound communication attempt\"; flow:to_server,established; content:\"POST\"; http_method; content:\"|0D 0A 0D 0A|murica\"; fast_pattern:only; rawbytes; content:!\"|0D 0A|Referer:\"; http_header; content:!\"|0D 0A|Accept\"; http_header; content:!\"|0D 0A|Cookie:\"; http_header; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,fireeye.com/blog/threat-research/2020/12/unauthorized-access-of-fireeye-red-team-tools.html; classtype:trojan-activity; sid:56862; rev:1;)"
    },
    {
        "description": "MALWARE-CNC MultiOS.Malware.GORAT command and control response attempt",
        "rule": "alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:\"MALWARE-CNC MultiOS.Malware.GORAT command and control response attempt\"; flow:to_client,established; content:\"HTTP/1.\"; depth:7; http_header; content:\"|0D 0A 0D 0A|murica\"; fast_pattern:only; rawbytes; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,fireeye.com/blog/threat-research/2020/12/unauthorized-access-of-fireeye-red-team-tools.html; classtype:trojan-activity; sid:56863; rev:1;)"
    },
    {
        "description": "MALWARE-CNC MultiOS.Malware.GORAT command and control SSL certificate",
        "rule": "alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:\"MALWARE-CNC MultiOS.Malware.GORAT command and control SSL certificate\"; flow:to_client,established; ssl_state:server_hello; content:\"|16 03 03|\"; depth:3; content:\"ACME Shell Co.0\"; content:\"Z\"; distance:0; content:\"ACME Shell Co.0\"; distance:0; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssl; reference:url,fireeye.com/blog/threat-research/2020/12/unauthorized-access-of-fireeye-red-team-tools.html; classtype:trojan-activity; sid:56864; rev:1;)"
    },
    {
        "description": "SERVER-MAIL Microsoft Exchange Server arbitrary file write attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-MAIL Microsoft Exchange Server arbitrary file write attempt\"; flow:to_server,established; content:\"/DDIService.svc/SetObject\"; fast_pattern:only; http_uri; content:\"VirtualDirectory\"; nocase; http_uri; content:\"ExternalUrl\"; nocase; http_client_body; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-27065; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2021-27065; classtype:attempted-admin; sid:57252; rev:1;)"
    },
    {
        "description": "SERVER-MAIL Microsoft Exchange Server arbitrary file write attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-MAIL Microsoft Exchange Server arbitrary file write attempt\"; flow:to_server,established; content:\"/DDIService.svc/SetObject\"; fast_pattern:only; http_uri; content:\"VirtualDirectory\"; nocase; http_uri; content:\"FilePathName\"; nocase; http_client_body; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-27065; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2021-27065; classtype:attempted-admin; sid:57253; rev:1;)"
    },
    {
        "description": "MALWARE-BACKDOOR Perl.Backdoor.PULSECHECK variant cnc connection",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"MALWARE-BACKDOOR Perl.Backdoor.PULSECHECK variant cnc connection\"; flow:to_server,established; content:\"/secid_canceltoken.cgi\"; fast_pattern:only; http_uri; content:\"X-CMD|3A|\"; nocase; http_header; content:\"X-KEY|3A|\"; nocase; http_header; content:\"POST\"; http_method; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.fireeye.com/blog/threat-research/2021/04/suspected-apt-actors-leverage-bypass-techniques-pulse-secure-zero-day.html; classtype:trojan-activity; sid:57461; rev:1;)"
    },
    {
        "description": "MALWARE-BACKDOOR Perl.Backdoor.HARDPULSE variant inbound cnc connection",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"MALWARE-BACKDOOR Perl.Backdoor.HARDPULSE variant inbound cnc connection\"; flow:to_server,established; content:\"/compcheckjava.cgi\"; fast_pattern:only; http_uri; content:\"hashid=\"; nocase; http_client_body; content:\"checkcode=\"; nocase; http_client_body; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.fireeye.com/blog/threat-research/2021/04/suspected-apt-actors-leverage-bypass-techniques-pulse-secure-zero-day.html; classtype:trojan-activity; sid:57464; rev:1;)"
    },
    {
        "description": "MALWARE-BACKDOOR Perl.Backdoor.STEADYPULSE variant inbound cnc connection",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"MALWARE-BACKDOOR Perl.Backdoor.STEADYPULSE variant inbound cnc connection\"; flow:to_server,established; content:\"/licenseserverproto.cgi\"; fast_pattern:only; http_uri; content:\"id=\"; nocase; http_client_body; pcre:\"/(^|&)(server)?id=/Pim\"; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.fireeye.com/blog/threat-research/2021/04/suspected-apt-actors-leverage-bypass-techniques-pulse-secure-zero-day.html; classtype:trojan-activity; sid:57465; rev:2;)"
    },
    {
        "description": "MALWARE-BACKDOOR Perl.Backdoor.ATRIUM variant inbound cnc connection",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"MALWARE-BACKDOOR Perl.Backdoor.ATRIUM variant inbound cnc connection\"; flow:to_server,established; content:\"/compcheckresult.cgi\"; fast_pattern:only; http_uri; content:\"id=\"; nocase; http_client_body; pcre:\"/(^|&)id=/Pim\"; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.fireeye.com/blog/threat-research/2021/04/suspected-apt-actors-leverage-bypass-techniques-pulse-secure-zero-day.html; classtype:trojan-activity; sid:57466; rev:1;)"
    },
    {
        "description": "MALWARE-BACKDOOR Perl.Backdoor.SLIGHTPULSE variant inbound cnc connection",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"MALWARE-BACKDOOR Perl.Backdoor.SLIGHTPULSE variant inbound cnc connection\"; flow:to_server,established; content:\"/meeting_testmsjava.cgi\"; fast_pattern:only; http_uri; content:\"POST\"; http_method; pcre:\"/(^|&)(name|img|cert)=/Pim\"; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.fireeye.com/blog/threat-research/2021/04/suspected-apt-actors-leverage-bypass-techniques-pulse-secure-zero-day.html; classtype:trojan-activity; sid:57467; rev:1;)"
    },
    {
        "description": "MALWARE-BACKDOOR Perl.Backdoor.SLIGHTPULSE variant inbound cnc connection",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"MALWARE-BACKDOOR Perl.Backdoor.SLIGHTPULSE variant inbound cnc connection\"; flow:to_server,established; content:\"/meeting_testjs.cgi\"; fast_pattern:only; http_uri; content:\"POST\"; http_method; pcre:\"/(^|&)(name|img|cert)=/Pim\"; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.fireeye.com/blog/threat-research/2021/04/suspected-apt-actors-leverage-bypass-techniques-pulse-secure-zero-day.html; classtype:trojan-activity; sid:57468; rev:1;)"
    },
    {
        "description": "MALWARE-BACKDOOR Perl.Backdoor.ATRIUM variant inbound cnc connection",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"MALWARE-BACKDOOR Perl.Backdoor.ATRIUM variant inbound cnc connection\"; flow:to_server,established; content:\"/compcheckresult.cgi\"; fast_pattern:only; http_uri; content:\"id=\"; nocase; http_uri; pcre:\"/[?&]id=/Ui\"; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.fireeye.com/blog/threat-research/2021/04/suspected-apt-actors-leverage-bypass-techniques-pulse-secure-zero-day.html; classtype:trojan-activity; sid:57541; rev:1;)"
    },
    {
        "description": "INDICATOR-COMPROMISE Revil Kaseya ransomware log clearing http upload",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"INDICATOR-COMPROMISE Revil Kaseya ransomware log clearing http upload\"; flow:to_server,established; file_data; content:\"Server.CreateObject\"; content:\"KComWExec.execCmd\"; fast_pattern:only; metadata:impact_flag red, policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,doublepulsar.com/kaseya-supply-chain-attack-delivers-mass-ransomware-event-to-us-companies-76e4ec6ec64b; reference:url,www.huntress.com/blog/rapid-response-kaseya-vsa-mass-msp-ransomware-incident; classtype:web-application-attack; sid:57879; rev:2;)"
    },
    {
        "description": "SERVER-WEBAPP Microsoft Exchange autodiscover server side request forgery attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-WEBAPP Microsoft Exchange autodiscover server side request forgery attempt\"; flow:to_server,established; content:\"/autodiscover\"; fast_pattern:only; http_uri; content:\"Email=\"; nocase; http_client_body; pcre:\"/(^|&)Email=[^&]*?(\\x2f|%(25)?2f)autodiscover/Pim\"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-31207; reference:cve,2021-34473; reference:cve,2021-34523; reference:cve,2022-41040; reference:cve,2022-41082; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2021-31207; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2021-34473; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2021-34523; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2022-41040; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2022-41082; classtype:attempted-admin; sid:57906; rev:6;)"
    },
    {
        "description": "SERVER-WEBAPP Microsoft Exchange autodiscover server side request forgery attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-WEBAPP Microsoft Exchange autodiscover server side request forgery attempt\"; flow:to_server,established; content:\"/autodiscover\"; fast_pattern:only; http_uri; content:\"Email=\"; nocase; http_uri; pcre:\"/[?&]Email=[^&]*?\\x2fautodiscover/Ui\"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-31207; reference:cve,2021-34473; reference:cve,2021-34523; reference:cve,2022-41040; reference:cve,2022-41082; reference:cve,2023-21529; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2021-31207; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2021-34473; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2021-34523; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2022-41040; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2022-41082; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2023-21529; classtype:attempted-admin; sid:57907; rev:7;)"
    },
    {
        "description": "SERVER-WEBAPP Microsoft Exchange autodiscover server side request forgery attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-WEBAPP Microsoft Exchange autodiscover server side request forgery attempt\"; flow:to_server,established; content:\"/autodiscover\"; fast_pattern:only; http_uri; content:\"Email\"; nocase; http_client_body; content:\"Content-Disposition\"; nocase; http_client_body; pcre:\"/name\\s*=\\s*[\\x22\\x27]?Email((?!^--).)*?[\\r\\n]{2,}((?!^--).)*?\\x2fautodiscover/Psim\"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-31207; reference:cve,2021-34473; reference:cve,2021-34523; reference:cve,2022-41040; reference:cve,2022-41082; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2021-31207; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2021-34473; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2021-34523; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2022-41040; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2022-41082; classtype:attempted-admin; sid:57908; rev:6;)"
    },
    {
        "description": "SERVER-WEBAPP Microsoft Exchange autodiscover server side request forgery attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-WEBAPP Microsoft Exchange autodiscover server side request forgery attempt\"; flow:to_server,established; content:\"/autodiscover\"; fast_pattern:only; http_uri; content:\"Email=\"; nocase; http_cookie; pcre:\"/Email=[^\\x3b\\r\\n]*?(\\x2f|%(25)?2f)autodiscover/Ci\"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-31207; reference:cve,2021-34473; reference:cve,2021-34523; reference:cve,2022-41040; reference:cve,2022-41082; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2021-31207; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2021-34473; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2021-34523; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2022-41040; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2022-41082; classtype:attempted-admin; sid:57983; rev:5;)"
    },
    {
        "description": "SERVER-OTHER Apache Log4j logging remote code execution attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-OTHER Apache Log4j logging remote code execution attempt\"; flow:to_server,established; content:\"${jndi:\"; fast_pattern:only; http_uri; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105; classtype:attempted-user; sid:58722; rev:5;)"
    },
    {
        "description": "SERVER-OTHER Apache Log4j logging remote code execution attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-OTHER Apache Log4j logging remote code execution attempt\"; flow:to_server,established; content:\"${jndi:\"; fast_pattern:only; http_header; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105; reference:cve,2022-20933; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-meraki-mx-vpn-dos-vnESbgBf; classtype:attempted-user; sid:58723; rev:6;)"
    },
    {
        "description": "SERVER-OTHER Apache Log4j logging remote code execution attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-OTHER Apache Log4j logging remote code execution attempt\"; flow:to_server,established; content:\"${lower:\"; fast_pattern:only; http_header; pcre:\"/\\x24{(\\x24{(upper|lower):j}|j)(\\x24{(upper|lower):n}|n)(\\x24{(upper|lower):d}|d)(\\x24{(upper|lower):i}|i)(\\x24{(upper|lower)::}|:)/Hi\"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105; reference:cve,2022-20933; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-meraki-mx-vpn-dos-vnESbgBf; classtype:attempted-user; sid:58724; rev:6;)"
    },
    {
        "description": "SERVER-OTHER Apache Log4j logging remote code execution attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-OTHER Apache Log4j logging remote code execution attempt\"; flow:to_server,established; content:\"${lower:\"; fast_pattern:only; http_uri; pcre:\"/\\x24{(\\x24{(upper|lower):j}|j)(\\x24{(upper|lower):n}|n)(\\x24{(upper|lower):d}|d)(\\x24{(upper|lower):i}|i)(\\x24{(upper|lower)::}|:)/Ui\"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105; classtype:attempted-user; sid:58725; rev:5;)"
    },
    {
        "description": "SERVER-OTHER Apache Log4j logging remote code execution attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-OTHER Apache Log4j logging remote code execution attempt\"; flow:to_server,established; content:\"jndi\"; fast_pattern:only; content:\"jndi\"; nocase; http_cookie; pcre:\"/(%(25)?24|\\x24)(%(25)?7b|\\x7b)jndi(%(25)?3a|\\x3a)/Ci\"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105; reference:cve,2022-20933; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-meraki-mx-vpn-dos-vnESbgBf; classtype:attempted-user; sid:58726; rev:7;)"
    },
    {
        "description": "SERVER-OTHER Apache Log4j logging remote code execution attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-OTHER Apache Log4j logging remote code execution attempt\"; flow:to_server,established; content:\"${jndi:\"; fast_pattern:only; http_client_body; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105; classtype:attempted-user; sid:58727; rev:5;)"
    },
    {
        "description": "SERVER-OTHER Apache Log4j logging remote code execution attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-OTHER Apache Log4j logging remote code execution attempt\"; flow:to_server,established; content:\"${lower:\"; fast_pattern:only; http_client_body; pcre:\"/\\x24{(\\x24{(upper|lower):j}|j)(\\x24{(upper|lower):n}|n)(\\x24{(upper|lower):d}|d)(\\x24{(upper|lower):i}|i)(\\x24{(upper|lower)::}|:)/Pi\"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105; classtype:attempted-user; sid:58728; rev:5;)"
    },
    {
        "description": "SERVER-OTHER Apache Log4j logging remote code execution attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-OTHER Apache Log4j logging remote code execution attempt\"; flow:to_server,established; content:\"${upper:\"; fast_pattern:only; http_uri; pcre:\"/\\x24{(\\x24{(upper|lower):j}|j)(\\x24{(upper|lower):n}|n)(\\x24{(upper|lower):d}|d)(\\x24{(upper|lower):i}|i)(\\x24{(upper|lower)::}|:)/Ui\"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105; classtype:attempted-user; sid:58729; rev:5;)"
    },
    {
        "description": "SERVER-OTHER Apache Log4j logging remote code execution attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-OTHER Apache Log4j logging remote code execution attempt\"; flow:to_server,established; content:\"lower\"; fast_pattern:only; content:\"lower\"; nocase; http_cookie; pcre:\"/(%(25)?24|\\x24)(%(25)?7b|\\x7b)lower(%(25)?3a|\\x3a)/Ci\"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105; reference:cve,2022-20933; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-meraki-mx-vpn-dos-vnESbgBf; classtype:attempted-user; sid:58730; rev:7;)"
    },
    {
        "description": "SERVER-OTHER Apache Log4j logging remote code execution attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-OTHER Apache Log4j logging remote code execution attempt\"; flow:to_server,established; content:\"${upper:\"; fast_pattern:only; http_header; pcre:\"/\\x24{(\\x24{(upper|lower):j}|j)(\\x24{(upper|lower):n}|n)(\\x24{(upper|lower):d}|d)(\\x24{(upper|lower):i}|i)(\\x24{(upper|lower)::}|:)/Hi\"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105; reference:cve,2022-20933; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-meraki-mx-vpn-dos-vnESbgBf; classtype:attempted-user; sid:58731; rev:6;)"
    },
    {
        "description": "SERVER-OTHER Apache Log4j logging remote code execution attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-OTHER Apache Log4j logging remote code execution attempt\"; flow:to_server,established; content:\"upper\"; fast_pattern:only; content:\"upper\"; nocase; http_cookie; pcre:\"/(%(25)?24|\\x24)(%(25)?7b|\\x7b)upper(%(25)?3a|\\x3a)/Ci\"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105; reference:cve,2022-20933; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-meraki-mx-vpn-dos-vnESbgBf; classtype:attempted-user; sid:58732; rev:7;)"
    },
    {
        "description": "SERVER-OTHER Apache Log4j logging remote code execution attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-OTHER Apache Log4j logging remote code execution attempt\"; flow:to_server,established; content:\"${upper:\"; fast_pattern:only; http_client_body; pcre:\"/\\x24{(\\x24{(upper|lower):j}|j)(\\x24{(upper|lower):n}|n)(\\x24{(upper|lower):d}|d)(\\x24{(upper|lower):i}|i)(\\x24{(upper|lower)::}|:)/Pi\"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105; classtype:attempted-user; sid:58733; rev:5;)"
    },
    {
        "description": "SERVER-OTHER Apache Log4j logging remote code execution attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-OTHER Apache Log4j logging remote code execution attempt\"; flow:to_server,established; content:\"jndi\"; fast_pattern:only; http_client_body; pcre:\"/(%(25)?24|\\x24)(%(25)?7b|\\x7b)jndi(%(25)?3a|\\x3a)/Pi\"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105; classtype:attempted-user; sid:58734; rev:4;)"
    },
    {
        "description": "SERVER-OTHER Apache Log4j logging remote code execution attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-OTHER Apache Log4j logging remote code execution attempt\"; flow:to_server,established; content:\"lower\"; fast_pattern:only; http_client_body; pcre:\"/(%(25)?24|\\x24)(%(25)?7b|\\x7b)lower(%(25)?3a|\\x3a)/Pi\"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105; classtype:attempted-user; sid:58735; rev:4;)"
    },
    {
        "description": "SERVER-OTHER Apache Log4j logging remote code execution attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-OTHER Apache Log4j logging remote code execution attempt\"; flow:to_server,established; content:\"upper\"; fast_pattern:only; http_client_body; pcre:\"/(%(25)?24|\\x24)(%(25)?7b|\\x7b)upper(%(25)?3a|\\x3a)/Pi\"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105; classtype:attempted-user; sid:58736; rev:4;)"
    },
    {
        "description": "SERVER-OTHER Apache Log4j logging remote code execution attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-OTHER Apache Log4j logging remote code execution attempt\"; flow:to_server,established; content:\"jndi\"; fast_pattern:only; http_header; pcre:\"/(%(25)?24|\\x24)(%(25)?7b|\\x7b)jndi(%(25)?3a|\\x3a)/Hi\"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105; reference:cve,2022-20933; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-meraki-mx-vpn-dos-vnESbgBf; classtype:attempted-user; sid:58737; rev:5;)"
    },
    {
        "description": "SERVER-OTHER Apache Log4j logging remote code execution attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-OTHER Apache Log4j logging remote code execution attempt\"; flow:to_server,established; content:\"upper\"; fast_pattern:only; http_header; pcre:\"/(%(25)?24|\\x24)(%(25)?7b|\\x7b)upper(%(25)?3a|\\x3a)/Hi\"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105; reference:cve,2022-20933; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-meraki-mx-vpn-dos-vnESbgBf; classtype:attempted-user; sid:58738; rev:5;)"
    },
    {
        "description": "SERVER-OTHER Apache Log4j logging remote code execution attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-OTHER Apache Log4j logging remote code execution attempt\"; flow:to_server,established; content:\"lower\"; fast_pattern:only; http_header; pcre:\"/(%(25)?24|\\x24)(%(25)?7b|\\x7b)lower(%(25)?3a|\\x3a)/Hi\"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105; reference:cve,2022-20933; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-meraki-mx-vpn-dos-vnESbgBf; classtype:attempted-user; sid:58739; rev:5;)"
    },
    {
        "description": "SERVER-OTHER Apache Log4j logging remote code execution attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-OTHER Apache Log4j logging remote code execution attempt\"; flow:to_server,established; content:\"%24%7b\"; fast_pattern:only; http_client_body; pcre:\"/%24%7b.{0,200}(%(25)?24|\\x24)(%(25)?7b|\\x7b).{0,200}(%(25)?3a|\\x3a)(%(25)?(27|2d|5c|22)|[\\x27\\x2d\\x5c\\x22])*([jndi\\x7d\\x3a\\x2d]|(%(25)?(7d|3a|2d))|(%(25)?5c|\\x5c)u00[a-f0-9]{2}){1,4}(%(25)?(22|27)|[\\x22\\x27])?(%(25)?(3a|7d)|[\\x3a\\x7djndi])/Pi\"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105; classtype:attempted-user; sid:58740; rev:6;)"
    },
    {
        "description": "SERVER-OTHER Apache Log4j logging remote code execution attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-OTHER Apache Log4j logging remote code execution attempt\"; flow:to_server,established; content:\"${\"; fast_pattern:only; http_client_body; pcre:\"/\\x24\\x7b.{0,200}(%(25)?24|\\x24)(%(25)?7b|\\x7b).{0,200}(%(25)?3a|\\x3a)(%(25)?(27|2d|5c|22)|[\\x27\\x2d\\x5c\\x22])*([jndi\\x7d\\x3a\\x2d]|(%(25)?(7d|3a|2d))|(%(25)?5c|\\x5c)u00[a-f0-9]{2}){1,4}(%(25)?(22|27)|[\\x22\\x27])?(%(25)?(3a|7d)|[\\x3a\\x7djndi])/Pi\"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105; classtype:attempted-user; sid:58741; rev:6;)"
    },
    {
        "description": "SERVER-OTHER Apache Log4j logging remote code execution attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-OTHER Apache Log4j logging remote code execution attempt\"; flow:to_server,established; content:\"${\"; fast_pattern:only; http_header; content:\"|2F|\"; http_uri; pcre:\"/\\x24\\x7b(jndi|[^\\x7d\\x80-\\xff]*?\\x24\\x7b[^\\x7d\\x80-\\xff]*?\\x3a[^\\x7d]*?\\x7d)/Hi\"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105; reference:cve,2022-20933; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-meraki-mx-vpn-dos-vnESbgBf; classtype:attempted-user; sid:58742; rev:8;)"
    },
    {
        "description": "SERVER-OTHER Apache Log4j logging remote code execution attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-OTHER Apache Log4j logging remote code execution attempt\"; flow:to_server,established; content:\"${\"; fast_pattern:only; content:\"${\"; nocase; http_cookie; content:\"|2F|\"; http_uri; pcre:\"/\\x24\\x7b(jndi|[^\\x7d\\x80-\\xff]*?\\x24\\x7b[^\\x7d]*?\\x3a[^\\x7d]*?\\x7d)/Ci\"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105; classtype:attempted-user; sid:58743; rev:6;)"
    },
    {
        "description": "SERVER-OTHER Apache Log4j logging remote code execution attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-OTHER Apache Log4j logging remote code execution attempt\"; flow:to_server,established; content:\"${\"; fast_pattern:only; http_uri; pcre:\"/\\x24\\x7b(jndi|[^\\x7d\\x80-\\xff]*?\\x24\\x7b[^\\x7d]*?\\x3a[^\\x7d]*?\\x7d)/Ui\"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105; classtype:attempted-user; sid:58744; rev:6;)"
    },
    {
        "description": "SERVER-OTHER Apache Log4j logging remote code execution attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:\"SERVER-OTHER Apache Log4j logging remote code execution attempt\"; flow:to_server,established; content:\"|24 7B|\"; fast_pattern:only; pcre:\"/^[\\w\\x2d\\x20]+\\x3a[^\\r\\n]*?\\x24\\x7b(jndi|lower|upper)\\x3a/im\"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service smtp; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105; classtype:attempted-user; sid:58751; rev:4;)"
    },
    {
        "description": "SERVER-OTHER Apache Log4j logging remote code execution attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-OTHER Apache Log4j logging remote code execution attempt\"; flow:to_server,established; content:\"%2524%257B\"; fast_pattern:only; http_client_body; pcre:\"/%2524%257b.{0,200}(%(25)?24|\\x24)(%(25)?7b|\\x7b).{0,200}(%(25)?3a|\\x3a)(%(25)?(27|2d|5c|22)|[\\x27\\x2d\\x5c\\x22])*([jndi\\x7d\\x3a\\x2d]|(%(25)?(7d|3a|2d))|(%(25)?5c|\\x5c)u00[a-f0-9]{2}){1,4}(%(25)?(22|27)|[\\x22\\x27])?(%(25)?(3a|7d)|[\\x3a\\x7djndi])/Pi\"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105; classtype:attempted-user; sid:58784; rev:4;)"
    },
    {
        "description": "SERVER-OTHER Apache Log4j logging remote code execution attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-OTHER Apache Log4j logging remote code execution attempt\"; flow:to_server,established; content:\"%24{\"; fast_pattern:only; http_client_body; pcre:\"/%24\\x7b.{0,200}(%(25)?24|\\x24)(%(25)?7b|\\x7b).{0,200}(%(25)?3a|\\x3a)(%(25)?(27|2d|5c|22)|[\\x27\\x2d\\x5c\\x22])*([jndi\\x7d\\x3a\\x2d]|(%(25)?(7d|3a|2d))|(%(25)?5c|\\x5c)u00[a-f0-9]{2}){1,4}(%(25)?(22|27)|[\\x22\\x27])?(%(25)?(3a|7d)|[\\x3a\\x7djndi])/Pi\"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105; classtype:attempted-user; sid:58785; rev:4;)"
    },
    {
        "description": "SERVER-OTHER Apache Log4j logging remote code execution attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-OTHER Apache Log4j logging remote code execution attempt\"; flow:to_server,established; content:\"%2524{\"; fast_pattern:only; http_client_body; pcre:\"/%2524\\x7b.{0,200}(%(25)?24|\\x24)(%(25)?7b|\\x7b).{0,200}(%(25)?3a|\\x3a)(%(25)?(27|2d|5c|22)|[\\x27\\x2d\\x5c\\x22])*([jndi\\x7d\\x3a\\x2d]|(%(25)?(7d|3a|2d))|(%(25)?5c|\\x5c)u00[a-f0-9]{2}){1,4}(%(25)?(22|27)|[\\x22\\x27])?(%(25)?(3a|7d)|[\\x3a\\x7djndi])/Pi\"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105; classtype:attempted-user; sid:58786; rev:4;)"
    },
    {
        "description": "SERVER-OTHER Apache Log4j logging remote code execution attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-OTHER Apache Log4j logging remote code execution attempt\"; flow:to_server,established; content:\"%24%257b\"; fast_pattern:only; http_client_body; pcre:\"/%24%257b.{0,200}(%(25)?24|\\x24)(%(25)?7b|\\x7b).{0,200}(%(25)?3a|\\x3a)(%(25)?(27|2d|5c|22)|[\\x27\\x2d\\x5c\\x22])*([jndi\\x7d\\x3a\\x2d]|(%(25)?(7d|3a|2d))|(%(25)?5c|\\x5c)u00[a-f0-9]{2}){1,4}(%(25)?(22|27)|[\\x22\\x27])?(%(25)?(3a|7d)|[\\x3a\\x7djndi])/Pi\"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105; classtype:attempted-user; sid:58787; rev:4;)"
    },
    {
        "description": "SERVER-OTHER Apache Log4j logging remote code execution attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-OTHER Apache Log4j logging remote code execution attempt\"; flow:to_server,established; content:\"$%7b\"; fast_pattern:only; http_client_body; pcre:\"/\\x24%7b.{0,200}(%(25)?24|\\x24)(%(25)?7b|\\x7b).{0,200}(%(25)?3a|\\x3a)(%(25)?(27|2d|5c|22)|[\\x27\\x2d\\x5c\\x22])*([jndi\\x7d\\x3a\\x2d]|(%(25)?(7d|3a|2d))|(%(25)?5c|\\x5c)u00[a-f0-9]{2}){1,4}(%(25)?(22|27)|[\\x22\\x27])?(%(25)?(3a|7d)|[\\x3a\\x7djndi])/Pi\"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105; classtype:attempted-user; sid:58788; rev:4;)"
    },
    {
        "description": "SERVER-OTHER Apache Log4j logging remote code execution attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-OTHER Apache Log4j logging remote code execution attempt\"; flow:to_server,established; content:\"$%257b\"; fast_pattern:only; http_client_body; pcre:\"/\\x24%257b.{0,200}(%(25)?24|\\x24)(%(25)?7b|\\x7b).{0,200}(%(25)?3a|\\x3a)(%(25)?(27|2d|5c|22)|[\\x27\\x2d\\x5c\\x22])*([jndi\\x7d\\x3a\\x2d]|(%(25)?(7d|3a|2d))|(%(25)?5c|\\x5c)u00[a-f0-9]{2}){1,4}(%(25)?(22|27)|[\\x22\\x27])?(%(25)?(3a|7d)|[\\x3a\\x7djndi])/Pi\"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105; classtype:attempted-user; sid:58789; rev:4;)"
    },
    {
        "description": "SERVER-OTHER Apache Log4j logging remote code execution attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-OTHER Apache Log4j logging remote code execution attempt\"; flow:to_server,established; content:\"%2524%7b\"; fast_pattern:only; http_client_body; pcre:\"/%2524%7b.{0,200}(%(25)?24|\\x24)(%(25)?7b|\\x7b).{0,200}(%(25)?3a|\\x3a)(%(25)?(27|2d|5c|22)|[\\x27\\x2d\\x5c\\x22])*([jndi\\x7d\\x3a\\x2d]|(%(25)?(7d|3a|2d))|(%(25)?5c|\\x5c)u00[a-f0-9]{2}){1,4}(%(25)?(22|27)|[\\x22\\x27])?(%(25)?(3a|7d)|[\\x3a\\x7djndi])/Pi\"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105; classtype:attempted-user; sid:58790; rev:4;)"
    },
    {
        "description": "SERVER-OTHER Apache Log4j logging remote code execution attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-OTHER Apache Log4j logging remote code execution attempt\"; flow:to_server,established; content:\"Authorization: Basic JH\"; fast_pattern:only; http_header; content:\"Authorization: Basic \"; http_header; base64_decode:relative; base64_data; pcre:\"/\\x24\\x7b(jndi|lower|upper|.{0,200}\\x24\\x7b.{0,200}\\x3a[\\x27\\x22\\x2d\\x5c]*[jndi\\x7d\\x3a\\x2d]{1,4}[\\x22\\x27]?[\\x3a\\x7djndi])/i\"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105; classtype:attempted-user; sid:58795; rev:4;)"
    },
    {
        "description": "SERVER-WEBAPP F5 BIG-IP iControl remote code execution attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-WEBAPP F5 BIG-IP iControl remote code execution attempt\"; flow:to_server,established; content:\"Connection:\"; nocase; http_header; content:\"X-F5-Auth\"; distance:0; fast_pattern; nocase; http_header; pcre:\"/^Connection:[^\\r\\n]*?X-F5-Auth/Him\"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2022-1388; classtype:attempted-user; sid:59735; rev:2;)"
    },
    {
        "description": "SERVER-WEBAPP Multiple products OGNL expression injection attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-WEBAPP Multiple products OGNL expression injection attempt\"; flow:to_server,established; content:\".action\"; nocase; http_uri; content:\"getRuntime\"; http_uri; content:\"exec\"; within:15; http_uri; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; classtype:attempted-admin; sid:59925; rev:2;)"
    },
    {
        "description": "INDICATOR-COMPROMISE Python remote shell spawn attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"INDICATOR-COMPROMISE Python remote shell spawn attempt\"; flow:to_server,established; content:\"pty.spawn(|22|/bin\"; http_uri; content:\"sh\"; within:10; http_uri; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; classtype:misc-attack; sid:59926; rev:2;)"
    },
    {
        "description": "MALWARE-BACKDOOR Jsp.Webshell.TinyUploader upload attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"MALWARE-BACKDOOR Jsp.Webshell.TinyUploader upload attempt\"; flow:to_server,established; content:\"java.io.FileOutputStream\"; fast_pattern:only; content:\"<%\"; content:\"request\"; within:100; content:\"write\"; content:\"getParameter\"; within:100; isdataat:!600; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2022-26134; reference:url,community.atlassian.com/t5/Confluence-discussions/CVE-2022-26134-Critical-severity-unauthenticated-remote-code/td-p/20456533; classtype:trojan-activity; sid:59927; rev:2;)"
    },
    {
        "description": "MALWARE-BACKDOOR Jsp.Webshell.Chopper webshell download attempt",
        "rule": "alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:\"MALWARE-BACKDOOR Jsp.Webshell.Chopper webshell download attempt\"; flow:to_client,established; file_data; content:\"DriverManager.getConnection\"; content:\"ServletOutputStream\"; content:\"ResultSetMetaData\"; content:\"request.getParameter\"; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2022-26134; reference:url,community.atlassian.com/t5/Confluence-discussions/CVE-2022-26134-Critical-severity-unauthenticated-remote-code/td-p/20456533; classtype:trojan-activity; sid:59928; rev:2;)"
    },
    {
        "description": "MALWARE-BACKDOOR Jsp.Webshell.Behinder download attempt",
        "rule": "alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:\"MALWARE-BACKDOOR Jsp.Webshell.Behinder download attempt\"; flow:to_client,established; file_data; content:\"<%\"; content:\"java.util.*\"; content:\"extends ClassLoader\"; fast_pattern:only; content:\"defineClass\"; content:\"getInstance(|22|AES|22|)\"; content:\"decodeBuffer\"; distance:0; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2022-26134; reference:url,community.atlassian.com/t5/Confluence-discussions/CVE-2022-26134-Critical-severity-unauthenticated-remote-code/td-p/20456533; classtype:trojan-activity; sid:59929; rev:2;)"
    },
    {
        "description": "MALWARE-BACKDOOR Jsp.Webshell.Noop download attempt",
        "rule": "alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:\"MALWARE-BACKDOOR Jsp.Webshell.Noop download attempt\"; flow:to_client,established; file_data; content:\"java.util.*\"; content:\"java.io.FileOutputStream\"; distance:0; content:\"request.getParameter(|22|name|22|)\"; within:200; fast_pattern; content:\"request.getParameter(|22|contentString|22|)\"; isdataat:!300,relative; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2022-26134; reference:url,community.atlassian.com/t5/Confluence-discussions/CVE-2022-26134-Critical-severity-unauthenticated-remote-code/td-p/20456533; classtype:trojan-activity; sid:59930; rev:2;)"
    },
    {
        "description": "MALWARE-BACKDOOR Jsp.Webshell.Chopper upload attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"MALWARE-BACKDOOR Jsp.Webshell.Chopper upload attempt\"; flow:to_server,established; content:\"DriverManager.getConnection\"; content:\"ServletOutputStream\"; content:\"ResultSetMetaData\"; content:\"request.getParameter\"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2022-26134; reference:url,community.atlassian.com/t5/Confluence-discussions/CVE-2022-26134-Critical-severity-unauthenticated-remote-code/td-p/20456533; classtype:trojan-activity; sid:59931; rev:2;)"
    },
    {
        "description": "MALWARE-BACKDOOR Jsp.Webshell.Behinder upload attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"MALWARE-BACKDOOR Jsp.Webshell.Behinder upload attempt\"; flow:to_server,established; content:\"<%\"; content:\"java.util.*\"; content:\"extends ClassLoader\"; fast_pattern:only; content:\"defineClass\"; content:\"getInstance(|22|AES|22|)\"; content:\"decodeBuffer\"; distance:0; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2022-26134; reference:url,community.atlassian.com/t5/Confluence-discussions/CVE-2022-26134-Critical-severity-unauthenticated-remote-code/td-p/20456533; classtype:trojan-activity; sid:59932; rev:2;)"
    },
    {
        "description": "MALWARE-BACKDOOR Jsp.Webshell.Noop upload attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"MALWARE-BACKDOOR Jsp.Webshell.Noop upload attempt\"; flow:to_server,established; content:\"java.util.*\"; content:\"java.io.FileOutputStream\"; distance:0; content:\"request.getParameter(|22|name|22|)\"; within:200; fast_pattern; content:\"confluence\"; nocase; content:\"request.getParameter(|22|contentString|22|)\"; isdataat:!300,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2022-26134; reference:url,community.atlassian.com/t5/Confluence-discussions/CVE-2022-26134-Critical-severity-unauthenticated-remote-code/td-p/20456533; classtype:trojan-activity; sid:59933; rev:2;)"
    },
    {
        "description": "SERVER-WEBAPP Atlassian Confluence OGNL expression injection attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-WEBAPP Atlassian Confluence OGNL expression injection attempt\"; flow:to_server,established; content:\"${\"; fast_pattern; http_uri; content:\"java\"; distance:0; http_uri; content:\"|28|\"; distance:0; http_uri; content:\"}\"; distance:0; http_uri; pcre:\"/\\x24\\x7b[^\\x7d]*?javax?\\x2e[^\\x7d]*?\\x28/Ui\"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2022-26134; classtype:attempted-user; sid:59934; rev:2;)"
    },
    {
        "description": "SERVER-WEBAPP Atlassian Confluence OGNL expression injection attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-WEBAPP Atlassian Confluence OGNL expression injection attempt\"; flow:to_server,established; content:\"${\"; fast_pattern; http_uri; content:\"atlassian.\"; distance:0; http_uri; content:\"|28|\"; distance:0; http_uri; content:\"}\"; distance:0; http_uri; pcre:\"/\\x24\\x7b[^\\x7d]*?atlassian\\x2e[^\\x7d]*?\\x28/Ui\"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2022-26134; classtype:attempted-user; sid:59941; rev:2;)"
    },
    {
        "description": "SERVER-WEBAPP Atlassian Confluence OGNL expression injection attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-WEBAPP Atlassian Confluence OGNL expression injection attempt\"; flow:to_server,established; content:\"${\"; http_uri; content:\"sun.misc.Unsafe\"; distance:0; fast_pattern; http_uri; content:\"|28|\"; distance:0; http_uri; content:\"}\"; distance:0; http_uri; pcre:\"/\\x24\\x7b[^\\x7d]*?sun\\x2emisc\\x2eUnsafe[^\\x7d]*?\\x28/Ui\"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2022-26134; classtype:attempted-user; sid:59947; rev:1;)"
    },
    {
        "description": "SERVER-WEBAPP Atlassian Confluence OGNL expression injection attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-WEBAPP Atlassian Confluence OGNL expression injection attempt\"; flow:to_server,established; content:\"${\"; http_uri; content:\"com.opensymphony.\"; distance:0; fast_pattern; http_uri; content:\"|28|\"; distance:0; http_uri; content:\"}\"; distance:0; http_uri; pcre:\"/\\x24\\x7b[^\\x7d]*?com\\x2eopensymphony\\x2e(xwork2|webwork)\\x2e(Servlet)?ActionContext[^\\x7d]*?\\x28/Ui\"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2022-26134; classtype:attempted-user; sid:59948; rev:1;)"
    },
    {
        "description": "SERVER-WEBAPP Microsoft Exchange Server remote code execution attempt",
        "rule": "alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:\"SERVER-WEBAPP Microsoft Exchange Server remote code execution attempt\"; flow:to_server,established; content:\"autodiscover.json\"; fast_pattern; nocase; http_uri; content:\"Powershell\"; distance:0; nocase; http_uri; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2022-41040; reference:cve,2022-41082; reference:url,msrc-blog.microsoft.com/2022/09/29/customer-guidance-for-reported-zero-day-vulnerabilities-in-microsoft-exchange-server/; classtype:attempted-user; sid:60642; rev:3;)"
    },
    {
        "description": "SERVER-OTHER OpenSSL x509 crafted email address buffer overflow attempt",
        "rule": "alert tcp any any -> any any (msg:\"SERVER-OTHER OpenSSL x509 crafted email address buffer overflow attempt\"; flow:established; content:\"|06 03 55 1D 1E|\"; content:\"|04 82|\"; within:5; content:\"|30 82|\"; within:2; distance:2; content:\"|82|\"; within:1; distance:3; content:\"|30 82|\"; within:2; distance:2; content:\"|81 82|\"; within:2; distance:2; byte_test:2,>,500,0,relative; content:\"xn--\"; within:4; distance:2; fast_pattern; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssl; reference:cve,2022-3602; reference:cve,2022-3786; reference:url,blog.talosintelligence.com/openssl-vulnerability/; classtype:attempted-user; sid:60790; rev:3;)"
    },
    {
        "description": "SERVER-WEBAPP Atlassian Confluence remote code execution attempt",
        "rule": "alert tcp any any -> any $HTTP_PORTS (msg:\"SERVER-WEBAPP Atlassian Confluence remote code execution attempt\"; flow:to_server,established; content:\"bootstrapStatusProvider\"; fast_pattern; nocase; http_client_body; content:\"applicationConfig\"; within:22; nocase; http_client_body; content:\"setupComplete\"; within:18; nocase; http_client_body; content:\"false\"; distance:0; nocase; http_client_body; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2023-22515; reference:url,confluence.atlassian.com/kb/faq-for-cve-2023-22515-1295682188.html; classtype:attempted-user; sid:62506; rev:1;)"
    },
    {
        "description": "SERVER-WEBAPP Atlassian Confluence remote code execution attempt",
        "rule": "alert tcp any any -> any $HTTP_PORTS (msg:\"SERVER-WEBAPP Atlassian Confluence remote code execution attempt\"; flow:to_server,established; content:\"bootstrapStatusProvider.applicationConfig.setupComplete=\"; fast_pattern; nocase; http_uri; content:\"false\"; distance:0; nocase; http_uri; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2023-22515; reference:url,confluence.atlassian.com/kb/faq-for-cve-2023-22515-1295682188.html; classtype:attempted-user; sid:62507; rev:1;)"
    }
]
